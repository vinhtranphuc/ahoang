Type.registerNamespace("FastBusiness.AjaxControlExtender");FastBusiness.AjaxControlExtender.MenuExtender=function(n){FastBusiness.AjaxControlExtender.MenuExtender.initializeBase(this,[n]);this._a$$=null;this._b$$=null;this._c$$="v";this._d$$=null;this._e$$="";this._f$$=null;this._g$$=[];this._h$$=!1;this._i$$=null;this._j$$=null;this._k$$=null;this._l$$=null;this._m$$=0;this._n$$=[];this._o$$=[];this._p$$=[];this._q$$=null;this._r$$="";this._s$$="MenuExtenderDivider";this._t$$="";this._u$$=0;this._v$$=-1;this._z$$=null;this._A$$="";this._B$$="";this._C$$="";this._D$$="";this._y$$="";this._H$$=0;this._I$$=-1;this._J$$="";this._w$$=10;this._x$$=15;this._r=FastBusiness.AjaxControlExtender.MenuExtender.Resources.Message};FastBusiness.AjaxControlExtender.MenuExtender.prototype={initialize:function(){FastBusiness.AjaxControlExtender.MenuExtender.callBaseMethod(this,"initialize");Sys.UI.DomElement.addCssClass(document.body,"MenuBody");this._menuBarGroupOnShowingHandler=Function.createDelegate(this,this.K$);this._resizeHandler=Function.createDelegate(this,this.x$);this._focusHandler=Function.createDelegate(this,this.C$);$addHandler(window,"resize",this._resizeHandler);$addHandler(window,"focus",this._focusHandler);this._keydownHandler=Function.createDelegate(this,this.D$);$addHandler(document,"keydown",this._keydownHandler);this._onDocumentClickHandler=Function.createDelegate(this,this.E$);$addHandler(document,"click",this._onDocumentClickHandler)},dispose:function(){this.P$();Sys.Application._disposing||this.J$();try{$removeHandler(window,"keydown",this._keydownHandler)}catch(n){}try{$removeHandler(window,"focus",this._focusHandler)}catch(n){}try{$removeHandler(window,"resize",this._resizeHandler)}catch(n){}this._onDocumentClickHandler&&($removeHandler(document,"click",this._onDocumentClickHandler),this._onDocumentClickHandler=null);this._keydownHandler=null;this._resizeHandler=null;this._focusHandler=null;this._menuBarGroupOnShowingHandler=null;try{this._z$$.dispose()}catch(n){}this._z$$=null;Sys.UI.DomElement.removeCssClass(document.body,"MenuBody");FastBusiness.AjaxControlExtender.MenuExtender.callBaseMethod(this,"dispose")},get_url:function(){return this._a$$},set_url:function(n){this._a$$!=n&&(this._a$$=n)},get_informationUrl:function(){return this._b$$},set_informationUrl:function(n){this._b$$!=n&&(this._b$$=n)},get_language:function(){return this._c$$},set_language:function(n){this._c$$!=n&&(this._c$$=n)},get_userID:function(){return this._d$$},set_userID:function(n){this._d$$!=n&&(this._d$$=n)},get_userName:function(){return this._e$$},set_userName:function(n){this._e$$!=n&&(this._e$$=n)},get_unit:function(){return this._f$$},set_unit:function(n){this._f$$!=n&&(this._f$$=n)},get_servicePath:function(){return this._j$$},set_servicePath:function(n){this._j$$=n},get_cookie:function(){return this._k$$},set_cookie:function(n){this._k$$=n},get_salt:function(){return this._l$$},set_salt:function(n){this._l$$=n},get_initScript:function(){return this._i$$},set_initScript:function(n){this._i$$=n},get_notify:function(){return this._m$$},set_notify:function(n){this._m$$!=n&&(this._m$$=n)},get_notifyServicePath:function(){return this._A$$},set_notifyServicePath:function(n){this._A$$!=n&&(this._A$$=n)},get_notifyMethod:function(){return this._B$$},set_notifyMethod:function(n){this._B$$!=n&&(this._B$$=n)},get_notifyMessageMethod:function(){return this._C$$},set_notifyMessageMethod:function(n){this._C$$!=n&&(this._C$$=n)},get_notifyCommandMethod:function(){return this._D$$},set_notifyCommandMethod:function(n){this._D$$!=n&&(this._D$$=n)},get_localStorageKey:function(){return this._y$$},set_localStorageKey:function(n){this._y$$!=n&&(this._y$$=n)},updated:function(){var n;FastBusiness.AjaxControlExtender.MenuExtender.callBaseMethod(this,"updated");var t="",i=this._l$$.split(String.fromCharCode(9)),r=i[1];try{r.length!=1&&(t=localStorage.getItem(r))}catch(u){t=""}if(this.hash(t+this._k$$)==i[0]){this._container==null&&(this.get_element().innerHTML="",this._container=document.createElement("div"),this.get_element().appendChild(this._container));n=sessionStorage.getItem("menuPageSelectedIndex");(n==undefined||n<0)&&(n=localStorage.getItem("menuPageSelectedIndex"));n&&n!=-1&&(this._u$$=n,localStorage.setItem("menuPageSelectedIndex",-1));this._J$$=sessionStorage.getItem("menuLastSearchValue");this._J$$==undefined&&(this._J$$="");try{this._w$$=parseInt(localStorage.getItem("menuItemPerPage"))}catch(f){}try{this._subItemInPage=parseInt(localStorage.getItem("menuSubItemPerPage"))}catch(f){}this._w$$===parseInt(this._w$$,10)||(this._w$$=10);this._subItemInPage===parseInt(this._subItemInPage,10)||(this._subItemInPage=15);this._w$$==0&&(this._w$$=1e3);this._subItemInPage==0&&(this._subItemInPage=1e3);this._r$$=this._id+"_MenuBarGroup";this._t$$=this._id+"_MenuBar";this._render();this._i$$&&(eval(this._i$$),this._i$$=null);this.n$();this.m$();this.j$();this.a$();this._F$$.value=this._J$$}},a$:function(){var n=null;try{n=localStorage.getItem("menuItems")}catch(t){}if(n&&n.length>0){this._h$$=!0;this._g$$=Sys.Serialization.JavaScriptSerializer.deserialize(n);this.j$();this.H$();this.p$();this.o$();return}this.d$(!0);Sys.Net.WebServiceProxy.invoke(this._j$$,"GetMenuItems",!1,{userID:this._d$$,language:this._c$$,cookie:this.get_cookie()},Function.createDelegate(this,this.b$),Function.createDelegate(this,this.c$),null)},b$:function(n){var t=this,i,r;if(t.d$(!1),n.length!=1||n[0]||(t._deny=!0),t._h$$=!0,t._deny){i=new Sys.StringBuilder;i.append('<table style="width:100%;height:25px;" cellpadding="0" cellspacing="0"><tr><td style="width:100%;"><div style="color:white;font-style:italic;">');i.append("&nbsp;");i.append(String.format(t._c$$=="v"?t._r.ExpirePassword.v:t._r.ExpirePassword.e,'<span style="color:#444444;">',t._c$$=="v"?t._r.Home.v:t._r.Home.e,"<\/span>"));i.append("<\/div><\/td><\/tr><\/table>");r=$get(t.get_id()+"_MenuBar");r.style.backgroundColor="#ff8484";r.innerHTML=i.toString();return}if(n&&n.length>0&&!t._deny){t._g$$=n;try{localStorage.setItem("menuItems",Sys.Serialization.JavaScriptSerializer.serialize(n))}catch(u){}}t.j$();t.H$();t.p$();setTimeout(function(){t.o$()},2e3)},c$:function(){this.d$(!1);this._h$$=!0;this.j$()},d$:function(n){this._isBusy=n;this.e$(!n)},e$:function(n){for(var t,r=document.getElementsByTagName("button"),i=0;i<r.length;i++)t=r[i],t&&(n?t.WasDisabled&&(t.WasDisabled=!1,t.disabled=!1):(t.WasDisabled=!0,t.disabled=!0))},_render:function(){var n=new Sys.StringBuilder;this.f$(n);this.g$(n);n.append("<\/table>");this.i$(n);this._container.innerHTML=n.toString();this.h$()},f$:function(n){n.append(String.format('<table id = "{0}_Table" cellpadding="0" cellspacing="0" class="MenuExtender">',this.get_id()))},g$:function(n){n.append(String.format('<tr class="MenuExtenderHeaderTextRow"><td colspan="2"><div class="Business"><\/div><div id="{0}_HeaderBar" class="HeaderBar">',this.get_id()));this.k$(n);n.append(String.format('<div id="{0}_MenuSelector" class="MenuSelector"><\/div><div id="{0}_SearchBox" class="MenuSearchBox"><\/div><\/div><\/td><\/tr>',this.get_id()))},h$:function(){this._E$$=$get(this.get_id()+"_SearchBox");this._E$$&&(this._E$$.innerHTML=String.format('<input id="{0}_SearchInput" autocomplete="off" spellcheck="false" tabindex="-1" tabstop="false" maxlength="256" type="text" class="MenuSearchInput" onkeydown="$find(\'{0}\').y$(event, this, 1);" onkeyup="$find(\'{0}\').z$(event, this, 1);"/><span class="MenuSearchButton" onclick="$find(\'{0}\').executeCommand({{commandName:\'Search\',commandArgument:\'0\'}});return false;"><\/span><div id="{0}_SearchContent" class="MenuSearchContent MenuSearchExtenderContextPanel"><\/div>',this.get_id()));this._F$$=$get(this.get_id()+"_SearchInput");this._F$$.placeholder=this.get_language()=="v"?this._r.SearchPlaceHolder.v:this._r.SearchPlaceHolder.e;this._G$$=$get(this.get_id()+"_SearchContent")},get_menuActives:function(){for(var t=[],n=0;n<this._g$$.length;n++)this._g$$[n].Scope==""&&Array.add(t,this._g$$[n]);return t},i$:function(n){n.append(String.format('<div class="MenuExtenderBar" id = "{0}_MenuBar">',this.get_id()));n.append("<\/div>")},j$:function(n){var n=new Sys.StringBuilder,i,t,r;if(n.append('<table style="width:100%; height:25px;" cellpadding="0" cellspacing="0"><tr><td style="width:100%">'),i=this._menuActives=this.get_menuActives(),i.length==0)n.append("&nbsp;");else{for(n.append('<table cellpadding="0" cellspacing="0" class="MenuExtenderGroups"><tr>'),t=0;t<i.length;t++)t>0&&n.append(String.format('<td class="MenuExtenderDivider"><div id="MenuExtenderDivider{0}"><\/div><\/td>',t-1)),r=i[t],n.append(String.format('<td nowrap class="{3}"><a href="#" id="{0}_MenuBarGroup{1}" onclick="return false"><div class="ExtensionLayout">{2}<span>&nbsp;<\/span><\/div><\/a><\/td>',this.get_id(),t,r.HeaderText,"MenuExtenderGroup"));n.append("<\/tr><\/table>")}n.append('<\/td><td align="right">');this._h$$||n.append('<div class = "MenuExtenderWait"><\/div>');n.append("<\/td><\/tr><\/table>");$get(this.get_id()+"_MenuBar").innerHTML=n.toString()},k$:function(n){var t=this._c$$=="v",i='<td nowrap align="right" ',r=i+'style="padding:0px"><',u="a href=\"#\" onclick=\"$find('{0}').executeCommand({{commandName:'",f="',commandArgument:'0'}});return false\" class=\"MenuExtenderHeaderLink\">{1}<\/a><\/",e='class="MenuExtenderHeaderText">';n.append('<table style="width:100%" cellpadding="0" cellspacing="0"><tr><td style="padding:0px;width:100%;"><\/td>');n.append(String.format(i+e+"{0}<span>{1}<\/span>",t?this._r.User.v:this._r.User.e,this._e$$));n.append(String.format('<span id="{0}_NotifyPanel"><\/div><\/td>',this.get_id()));this.l$(n);n.append(String.format(i+e+'<span title = "{0}">{1}<\/span><\/td>',t?this._r.Unit.v:this._r.Unit.e,this._f$$));this.l$(n);n.append(String.format(r+u+"Home"+f+"td>",this.get_id(),t?this._r.Home.v:this._r.Home.e));this.l$(n);n.append(String.format(r+u+"ChangePassword"+f+"td>",this.get_id(),t?this._r.ChangePassword.v:this._r.ChangePassword.e));this.l$(n);n.append(String.format(r+'div id = "{0}_Logout"><'+u+"Logout"+f+"div><\/td>",this.get_id(),t?this._r.Logout.v:this._r.Logout.e));n.append("<\/tr><\/table>")},l$:function(n){n.append('<td nowrap class="MenuExtenderSeparate"><\/td>')},m$:function(){var t=$get("mpFooter"),n;t&&(n=new Sys.StringBuilder,n.append('<div class="ExtensionVertical" style="background-color:white;border-top:1px solid Gray;padding-top:4px;padding-bottom:4px;height:19px;"><table><tbody><tr>'),n.append('<td style="text-align: left;width:100%; padding-left:4px;"><span>'),n.append(String.format('<span id="CopyrightText" style="color:Gray">{0}<\/span>',String.format(this._c$$=="v"?this._r.Copyright.v:this._r.Copyright.e,(new Date).getFullYear()))),n.append("<\/span><\/td>"),n.append("<\/tr><\/tbody><\/table><\/div>"),t.innerHTML=n.toString())},n$:function(){var n=$get("mpMainBody");if(n){var i=$common.getClientBounds().height,r=$common.getBounds(n),t=i-128;Sys.Browser.agent==Sys.Browser.InternetExplorer&&(t+=4);t>r.height&&(n.style.height=t+"px")}},o$:function(){var n=this,t;if(n._m$$!=0){if(n._z$$)try{n._z$$.dispose();n._z$$=null}catch(i){}t=$get(n._id+"_NotifyPanel");n._z$$=$create(FastBusiness.AjaxControlExtender.NotifyExtender,{notifyContainerID:t.id,language:n._c$$,servicePath:n._A$$,serviceMethod:n._B$$,serviceMessageMethod:n._C$$,serviceCommandMethod:n._D$$},null,null,t)}},p$:function(){var n=this,u=[],f=6,e,i,t,r,o;for(this._q$$=$get(n._id+"_MenuSelector"),t=0;t<n._g$$.length;t++)n._n$$.push(n._g$$[t].HeaderText);for(n._currentWidth=$common.getClientBounds().width,t=0;t<n._n$$.length;t++)e=$get(String.format(n._r$$+"{0}",t)).childNodes[0].offsetWidth,n._o$$.push(e+f),n._menuWidth+=e+f;if(!(n._currentWidth>=n._menuWidth-f)){for(i=document.createElement("div"),i.setAttribute("id",n._id+"_SelectorContainer"),i.setAttribute("class","SelectorContainer"),u=n.s$(),t=0;t<u.length;t++)r=n.q$(String.format(n._id+"_MenuSelector{0}",t)),r._beginPoint=u[t][0],r._endPoint=u[t][1],r._pageOrder=t,n._p$$.push(r),i.appendChild(r);i.style.display=u.length==1?"none":"block";n._q$$.innerHTML!=""&&(n._q$$.innerHTML="");n._q$$.appendChild(i);n._u$$||(n._u$$=0);o=n._u$$>=n._p$$.length?n._p$$.length-1:n._u$$;n.t$(n._p$$[o])}},q$:function(n){var i=this,t=document.createElement("div");return t.setAttribute("id",n),$addHandler(t,"click",Function.createDelegate(i,i.r$)),t},r$:function(n){var t=this,i=n.target||n.srcElement;t._v$$!=i._pageOrder&&t.t$(i)},s$:function(){for(var f,t=this,i=0,r=1,u=[],n=0;n<t._o$$.length;n++)i+=t._o$$[n],i>=t._currentWidth+3&&(f=[r,n],u.push(f),i=t._o$$[n],r=n+1);return u.push([r,t._o$$.length]),u},t$:function(n){if(n!=undefined){var t=this,i=n._beginPoint,r=n._endPoint;t._v$$=n._pageOrder;$get(t._id+"_MenuBar").style.marginLeft=-t.u$(i)+"px";t.v$(n);t.w$(n,i,r);sessionStorage.setItem("menuPageSelectedIndex",t._v$$);localStorage.setItem("menuPageSelectedIndex",t._v$$)}},u$:function(n){var r,i,t;if(n==1)return 0;for(r=this,i=0,t=0;t<n-1;t++)i+=r._o$$[t];return i},v$:function(n){for(var t=0;t<this._p$$.length;t++)this._p$$[t].style.backgroundColor=this._p$$[t]==n?"#ffffff":"#809dbd"},w$:function(n){for(var i=this,u=i._n$$.length,t=0;t<u;t++){var r=t<n._endPoint,f=$get(String.format(i._r$$+"{0}",t)),e=$get(String.format(i._s$$+"{0}",r?t:t-1));Sys.UI.DomElement.setVisible(f,r);Sys.UI.DomElement.setVisible(e,r)}},x$:function(){this.n$()},y$:function(n){var t=n.keyCode||n.which;switch(t){case 13:if(this._I$$>=0&&this._H$$>0&&this._G$$.style.display=="block"){this.executeCommand({commandName:"Open",commandArgument:"0"});break}this.executeCommand({commandName:"Search",commandArgument:"0"});break;case 38:this.B$(!1);break;case 40:this.B$(!0);break;case 33:this.B$(!1,!0);break;case 34:this.B$(!0,!0)}},z$:function(n,t){this._searchValue!=t.value&&this.zi()},A$:function(n,t){var i=document.getElementsByClassName("MenuCompletionHighlighted");for(let n=0;n<i.length;n++)Sys.UI.DomElement.removeCssClass(i[n],"MenuCompletionHighlighted");Sys.UI.DomElement.addCssClass(t,"MenuCompletionHighlighted");this._I$$=parseInt(t.id.replace(String.format("{0}_Item",this._id),""));this._menuSearchItemActived=t},B$:function(n,t){if(t)this._I$$=n?this._H$$-1:0;else{if(this._H$$==0||n&&this._I$$==this._H$$-1||!n&&this._I$$==0)return;this._I$$=n?this._I$$+1:this._I$$-1}var i=document.getElementsByClassName("MenuCompletionHighlighted");for(let n=0;n<i.length;n++)Sys.UI.DomElement.removeCssClass(i[n],"MenuCompletionHighlighted");(this._menuSearchItemActived=$get(this._id+"_Item"+this._I$$),this._menuSearchItemActived.focus(),this._F$$.focus(),Sys.UI.DomElement.addCssClass(this._menuSearchItemActived,"MenuCompletionHighlighted"),this._I$$<5&&n)||this._I$$>this._H$$-5&&!n},C$:function(){try{localStorage.setItem("menuPageSelectedIndex",sessionStorage.getItem("menuPageSelectedIndex"))}catch(n){}},D$:function(n){var u=n.keyCode||n.which,i,t,r;if(u==27){if(this._G$$&&this._G$$.style.display=="block"&&(this._G$$.style.display="none"),this._subItemShowing){this._subItemShowing=!1;this.P$();return}for(i=this._menuActives,t=0;t<i.length;t++)r=i[t],r._popupBehavior&&r._popupBehavior.hidePopup()}u==113&&this._F$$.focus()},E$:function(n){n||(n=window.event);this.F$(n,$get(this._id+"_SearchBox"))||this.F$(n,$get(this._id+"_SearchContent"))||this._G$$&&(this._G$$.style.display="none")},F$:function(n,t){var i=this.G$(n);if(!i)return!0;var r=$common.getLocation(t),u=r.x,f=r.y,e=r.x+t.clientWidth,o=r.y+t.clientHeight;if(i.x>=u&&i.x<=e&&i.y>=f&&i.y<=o)return!0},G$:function(n){var t=document.documentElement;return(n||(n=window.event),n.pageX||n.pageY)?{x:n.pageX,y:n.pageY}:n.clientX||n.clientY?{x:n.clientX+document.body.scrollLeft+t.scrollLeft,y:n.clientY+document.body.scrollTop+t.scrollTop}:void 0},H$:function(){this.J$();this._deny||this.I$()},I$:function(){for(var i,a,u,t,o,s,e,n,y,l,w=this._c$$=="v",f=0,p=this._menuActives,r=0;r<p.length;r++)if(i=p[r],f=Math.ceil(i.MenuItems.length/this._w$$),a=$get(this.get_id()+"_MenuBarGroup"+r.toString()),a){for(u=i._panel=document.createElement("div"),u.id=this.get_id()+"_MenuBarGroupPanel"+r.toString(),Sys.UI.DomElement.setVisible(u,!1),this.get_element().appendChild(u),u.className=String.format("MenuExtenderContextPanel {0}",f==1?"MenuExtenderContextBarPanel":"MenuExtenderContextPanelPage"),t=new Sys.StringBuilder,i.MenuItems.length>this._w$$&&t.append('<table cellpadding="0" cellspacing="0"><tbody><tr><td style="vertical-align:top;">'),o=0,s=!0,e=0;e<i.MenuItems.length;e++)if(o==this._w$$&&(o=0,t.append('<\/td><td style="width:32px"><\/td><td style="vertical-align:top;border-left: 0px solid #ccc;">'),s=!0),n=i.MenuItems[e],n.CommandName==null||n.CommandName.length==0||n.HeaderText=="-")s||t.append('<div class="ContextMenuExtenderBreak"><\/div>');else{o+=1;s=!1;var h=n.CssClass&&n.CssClass.length>0?n.CssClass:"",v=n.UrlImage?String.format("style=\"background-image:url('{0}');\"",n.UrlImage):"",c=n.HeaderText;n.Disabled?t.append(String.format('<a {2} class="MenuExtenderContextItemDisabled {1}"><div class="Title ExtensionHeight" title="{0}">{0}<\/div><\/a>',c,h+(f==1?"":" MenuExtenderContextItemDisabledPage"),v)):n.MenuItems?t.append(String.format('<a href="#" onclick="$find(\'{0}\').N$(\'{5}\',{1},null,{2});return false;" class="MenuExtenderGroupItem {4}"><div id="{0}_ItemGroup{1}.{2}" onclick="$find(\'{0}\').M$(\'{5}\',{1},null,{2});return false;" class="Title ExtensionHeight">{3}<\/div><\/a>',this.get_id(),e,r,c,h+(f==1?"":" MenuExtenderGroupItemPage"),i.Scope)):(y=String.format("{0}?id={1}",n.CommandName,n.CommandIndex),n.Target==""?t.append(String.format('<a href="{0}" {1} class="MenuExtenderContextItem {2}"><div class="Title ExtensionHeight" title="{3}">{3}<\/div><\/a>',y,v,h+(f==1?"":" MenuExtenderContextItemPage"),c)):t.append(String.format('<a onclick="$find(\'{0}\').L$();" target="{1}" href="{2}" {3} class="MenuExtenderContextItem {4}"><div class="Title ExtensionHeight" title="{5}">{5}<\/div><\/a>',this.get_id(),n.Target,y,v,h+(f==1?"":" MenuExtenderContextItemPage"),c)))}i.MenuItems.length>this._w$$&&t.append("<\/td><\/tr><\/tbody><\/table>");u.innerHTML=t.toString();l=i._popupBehavior=$create(AjaxControlToolkit.PopupControlBehavior,{id:this.get_id()+"_MenuBarGroupPopup"+r.toString(),PopupControlID:u.id,Position:AjaxControlToolkit.PopupControlPopupPosition.Bottom,OffsetY:-17,OffsetX:0},null,null,a.parentNode);l.hidePopup();l._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.BottomLeft);l._popupBehavior.add_showing(this._menuBarGroupOnShowingHandler)}},J$:function(){var i,t,n;for(this._G$$&&(this._G$$.style.display="none"),i=this._menuActives,t=0;t<i.length;t++)n=i[t],n._popupBehavior&&(n._popupBehavior._popupBehavior.remove_showing(this._menuBarGroupOnShowingHandler),n._popupBehavior.dispose(),n._popupBehavior=null,n._panel.parentNode.removeChild(n._panel),n._panel=null)},K$:function(){this.L$()},L$:function(){var i,t,n;for(this._G$$&&(this._G$$.style.display="none"),this.P$(),i=Sys.Application.getComponents(),t=0;t<i.length;t++)n=i[t],AjaxControlToolkit.DropDownBehavior.isInstanceOfType(n)&&(n.hide(),n.unhover()),AjaxControlToolkit.PopupControlBehavior.isInstanceOfType(n)&&n.hidePopup()},M$:function(n,t,i,r){var f=String.format("{0}_ItemGroupPanel{1}.{2}",this.get_id(),t,r),u=$get(f);if(u&&u._popupVisible==!0)return u._popupVisible=!1,this.O$(n,t,i,r),this._removeActivateItem=!0,!1},N$:function(n,t,i,r){var c=0,y=0,p=!0,ut=String.format("{0}_ItemGroupPanel{1}.{2}",this.get_id(),t,r),w=$get(ut),f,s,o,u,rt,l,h,b,v,e,k;if(w&&w._popupVisible==!0)return w._popupVisible=!1,this.O$(n,t,i,r),!1;if(this._removeActivateItem==!0){this._removeActivateItem=!1;return}this.O$(n,t,i,r);var a=this._menuActives[r].MenuItems[t].MenuItems,d=$get(String.format("{0}_ItemGroup{1}.{2}",this.get_id(),t,r)),g=0;for(o=0;o<a.length;o++)u=a[o],u.CommandName==null||u.CommandName.length==0||u.HeaderText=="-"||(g+=1);if(this._subItemShowing=!0,c=Math.ceil(g/this._subItemInPage),d){for(f=document.createElement("div"),f.id=String.format("{0}_ItemGroupPanel{1}.{2}",this.get_id(),t,r),f._popupVisible=!0,Sys.UI.DomElement.setVisible(f,!0),this.get_element().appendChild(f),f.className=String.format("MenuExtenderContextPanel {0}",c==1?"MenuExtenderContextBarPanel":"MenuExtenderContextPanelPage"),s=new Sys.StringBuilder,c>1&&s.append('<table cellpadding="0" cellspacing="0"><tbody><tr><td style="vertical-align:top;">'),o=0;o<a.length;o++)if(u=a[o],y==this._subItemInPage&&(y=0,s.append('<\/td><td style="width:32px"><\/td><td style="vertical-align:top;border-left: 0px solid #ccc;">'),p=!0),u.CommandName==null||u.CommandName.length==0||u.HeaderText=="-")p||s.append('<div class="ContextMenuExtenderBreak"><\/div>');else{y+=1;p=!1;var nt=u.CssClass&&u.CssClass.length>0?u.CssClass:"",tt=u.UrlImage?String.format("style=\"background-image:url('{0}');\"",u.UrlImage):"",it=u.HeaderText;u.Disabled?s.append(String.format('<a {2} class="MenuExtenderContextItemDisabled {1}"><div class="Title ExtensionHeight" title="{0}">{0}<\/div><\/a>',it,nt+(c==1?"":" MenuExtenderContextItemDisabledPage"),tt)):(rt=String.format("{0}?id={1}",u.CommandName,u.CommandIndex),s.append(String.format('<a href="{0}" {1} class="MenuExtenderContextItem {2}"><div class="Title ExtensionHeight" title="{3}">{3}<\/div><\/a>',rt,tt,nt+(c==1?"":" MenuExtenderContextItemPage"),it)))}c>1&&s.append("<\/td><\/tr><\/tbody><\/table>");f.innerHTML=s.toString();l=this._instance=$create(AjaxControlToolkit.PopupControlBehavior,{id:String.format("{0}_ItemGroupPopup{1}.{2}",this.get_id(),t,r),PopupControlID:f.id,Position:AjaxControlToolkit.PopupControlPopupPosition.Right,OffsetY:-4,OffsetX:16},null,null,d);this._instance._panel=f;AjaxControlToolkit.PopupControlBehavior.callBaseMethod(l,"populate");h=l._popupBehavior;b=l._getTopOffset();h.set_x(l._getLeftOffset());h.set_y(b);h.show();v=$common.getClientBounds();e=h.getBounds();v.width<e.x+e.width&&h.set_x(-e.width-32);k=v.height-e.y-e.height;k<30&&(v.height>e.height+e.x+150?h.set_y(-e.height+11):h.set_y(b+k-25));l._popupVisible=!0}},O$:function(){this._subItemShowing=!1;this.P$()},P$:function(){this._instance&&(this._instance._panel.parentNode.removeChild(this._instance._panel),this._instance._panel=null,this._instance.dispose(),this._instance=null)},Q$:function(n,t,i,r){var u,f;(this.L$(),this._isBusy)||(u=i!=null?this._menuActives[r].MenuItems[t].MenuItems[i]:this._menuActives[r].MenuItems[t],this._lastCommand=u.CommandName,this._lastCommand&&this._lastCommand.length>0&&(f=String.format("{0}?id={1}",u.CommandName,u.CommandIndex),window.location=f))},executeCommand:function(n){var t=this,u,r,i,f;if(t.L$(),!t._isBusy)switch(n.commandName){case"Home":window.location=t._a$$;break;case"ChangePassword":window.location=t._b$$;break;case"Logout":try{sessionStorage.clear();localStorage.removeItem("menuItems")}catch(e){}try{localStorage.removeItem("menuPageSelectedIndex")}catch(e){}try{if(t._y$$&&t._y$$!="")for(u=t._y$$.split(","),r=0;r<u.length;r++)try{localStorage.removeItem(u[r].trim())}catch(o){}}catch(e){}t.YD($get(t.get_id()+"_Logout"));Sys.Net.WebServiceProxy.invoke(t._j$$,"Logout",!1,{cookie:t.get_cookie()},Function.createDelegate(t,t.r9),Function.createDelegate(t,t.TF),null);break;case"Open":this._menuSearchItemActived&&window.open(this._menuSearchItemActived.href,"_self");break;case"Search":if(i=t._F$$.value,f=i.trim().replace(/[~`!@#$%^&*()+={}\[\];:\'\"<>.,\/\\\?\-_]/g,""),f.trim()=="")return;this._H$$=0;this._I$$=-1;t._listItems=[];t._subSystemText="";t.S$(t._g$$);t._searchValue=i;t.R$(t._listItems,i);i&&sessionStorage.setItem("menuLastSearchValue",i);t._F$$.focus()}},R$:function(n,t){for(var p,o,r=this,l=new Sys.StringBuilder,f=0,a=[],v=[],e="",s,h="",c=[],u=[],w=t.toLowerCase(),y=r.sM(w),b=r.U$(y),i=0;i<n.length;i++)if(e=n[i][0].HeaderText,h="",s=[e,n[i][0].CommandName],r.T$(n[i][0].HeaderText,y)==1){if(r.Y$(s,a))continue;u.push([e,String.format("{0}_Item{1}",r._id,f),n[i][1],n[i][2]]);r.Z$(e,v)?(c.push([e,String.format("{0}_Item{1}",r._id,f)]),h=String.format('<div class="MenuSearchDescription">{0}<\/div>',n[i][1]===n[i][2]?n[i][2]:n[i][2]+" &gt; "+n[i][1])):v.push(e);a.push(s);l.append(String.format('<a id="{4}_Item{5}" href="{0}?id={1}" onkeydown="$find(\'{4}\').y$(event, this, 2);" onmousemove="$find(\'{4}\').A$(event, this);" style="padding: 4px;border:1px solid #fff;" class="MenuSearchExtenderContextItem MenuSearchExtenderContextItemPage"><div class="MenuSearchHeader Title {3}" title="{7}">{2}<\/div>{6}<\/a>',n[i][0].CommandName,n[i][0].CommandIndex,r.V$(b,n[i][0].HeaderText),n[i][0].CssClass,r._id,f,h,n[i][0].HeaderText));f=f+1}for(i=u.length-1;i>=0;i--)p=u[i],r.Y$(p,c)&&u.splice(i,1);for(this._H$$=f,f>0?(r._G$$.style.maxHeight="240px",r._G$$.style.height="auto",r._G$$.innerHTML=l.toString()):(r._G$$.innerHTML=String.format('<div style="font-style:italic;color:#039;padding:4px;">{0}<\/div>',r._c$$=="v"?r._r.NotFound.v:r._r.NotFound.e),r._G$$.style.height="22px"),i=0;i<u.length;i++)r.Le(u[i][0],c)&&(o=document.createElement("div"),o.className="MenuSearchDescription",o.innerHTML=u[i][3]===u[i][2]?u[i][2]:u[i][3]+" &gt; "+u[i][2],$get(u[i][1]).appendChild(o));r._G$$.style.display="block";r._G$$.scrollTop=0},S$:function(n,t,i){this._subSystemText=i;for(var r=0;r<n.length;r++)n[r].Scope==""&&(this._subSystemText=n[r].HeaderText),n[r].MenuItems?this.S$(n[r].MenuItems,n[r].HeaderText,this._subSystemText):n[r].CommandName=="."||n[r].CommandName==""||n[r].Disabled||this._listItems.push([n[r],t,i])},T$:function(n,t){var h=this,i;n=n.toLowerCase();var e=t[1],o=t[0],s=t[2],c=n.split(/[;,.\s]/),r=0,u=0,f=0;for(i=0;i<e.length;i++)if(h.X$(c,e[i])==1)r=1;else{r=0;break}for(i=0;i<o.length;i++)if(n.indexOf(o[i])>=0)u=1;else{u=0;break}for(i=0;i<s.length;i++)if(h.X$(c,s[i])==1)f=1;else{f=0;break}return(e.length==0&&(r=1),o.length==0&&(u=1),s.length==0&&(f=1),r==1&&u==1&&f==1)?1:0},U$:function(n){for(var r=n[1],u=n[0],f=n[2],i=[],t=0;t<u.length;t++)u[t].trim()!=""&&i.push(u[t]);for(t=0;t<r.length;t++)r[t].trim()!=""&&i.push(r[t]);for(t=0;t<f.length;t++)f[t].trim()!=""&&i.push(f[t]);return i},V$:function(n,t){for(var e,u,o,f,s=this,r=[],i=0;i<n.length;i++)for(f=new RegExp(s.W$(n[i]),"ig"),e=t.match(f),u=0;u<e.length;u++)r.indexOf(e[u])==-1&&r.push(e[u]);for(i=0;i<r.length;i++)t=t.replace(new RegExp(r[i],"g"),"@@"+i+"@@"),o=String.format('<span class="MenuSearchTextHighligh">{0}<\/span>',r[i]),f=new RegExp(r[i],"g"),r[i]=r[i].replace(f,o);for(i=0;i<r.length;i++)t=t.replace(new RegExp("@@"+i+"@@","g"),r[i]);return t},W$:function(n){return n.replace(/([.*+?^$|(){}\[\]])/ig,"\\$1")},X$:function(n,t){for(var r,u=0,i=0;i<n.length;i++)if(r=t.trim().replace(/[~`!@#$%^&*()+={}\[\];:\'\"<>.,\/\\\?\-_]/g,""),r==""||n[i].trim()==r){u=1;break}return u},Y$:function(n,t){for(var i=0;i<t.length;i++)if(t[i][0]===n[0]&&t[i][1]===n[1])return!0;return!1},Z$:function(n,t){for(var i=0;i<t.length;i++)if(t[i]===n)return!0;return!1},Le:function(n,t){for(var i=0;i<t.length;i++)if(t[i][0]===n)return!0;return!1},sM:function(n){var u=[],f=[],e=[],o=[],s=-1,r=-1,y=0,p,w=-1,t=0,h=[],d=0,nt=String.fromCharCode(251),c=String.fromCharCode(255),l=String.fromCharCode(254),a=String.fromCharCode(246),v=String.fromCharCode(252),g,b,k,i;for(n=n.replace(/\+\+/g,c),n=n.replace(/\-\-/g,l),n=n.replace(/\/\//g,a),n=n.replace(/\"\"/g,v),n=n.replace(/\"\+/g,'" +'),n=n.replace(/\"\-/g,'" -'),s=-1,r=-1,y=0,w=n.indexOf('"',0),g=(n.match(/"/g)||[]).length,g%2!=0&&(n=n+'"');w!=-1;){for(t=0;t<n.length;t++)n[t]=='"'&&y==0&&(s=t,y=1),t>=100&&r==-1&&(r=n.length-1),n[t]=='"'&&t!=s&&(r=t),s<r&&(d+=1,p=n.substring(s,r+1),b=p.replace(/\"/g,""),h.indexOf(b)==-1&&h.push(b),s=-1,r=-1,y=0,t=0,n=n.replace(p,nt+d.toString()));w=n.indexOf('"',0)}for(n=n.replace(/&/g,"+").replace(/\""/g,""),n=n.replace(/\++/g,"+"),n=n.replace(/\+/g," +"),n=n.replace(/\-/g," -"),n=n.replace(/\//g," /"),n=n.replace(/  /g," "),n=n.replace(/\--/g,"-"),n=n.replace(/\+ /g,"+"),n=n.replace(/\- /g,"-"),n=n.replace(/\/ /g,"/"),n=n.replace(/\/\//g,"/"),k=n.split(" "),t=0;t<k.length;t++)i=k[t],i.indexOf("+")>=0?f.indexOf(i)==-1&&f.push(i):i.indexOf("-")>=0?e.indexOf(i)==-1&&e.push(i):i.indexOf("/")>=0?o.indexOf(i)==-1&&o.push(i):u.indexOf(i)==-1&&u.push(i);for(t=0;t<h.length;t++)h[t]=h[t].replace(new RegExp(c,"g"),"+").replace(new RegExp(l,"g"),"-").replace(new RegExp(a,"g"),"/").replace(new RegExp(v,"g"),'"');for(t=0;t<u.length;t++)u[t]=u[t].replace(new RegExp(c,"g"),"+").replace(new RegExp(l,"g"),"-").replace(new RegExp(a,"g"),"/").replace(new RegExp(v,"g"),'"');for(t=0;t<f.length;t++)f[t]=f[t].replace(new RegExp(c,"g"),"+").replace(new RegExp(l,"g"),"-").replace(new RegExp(a,"g"),"/").replace(new RegExp(v,"g"),'"');for(t=0;t<e.length;t++)e[t]=e[t].replace(new RegExp(c,"g"),"+").replace(new RegExp(l,"g"),"-").replace(new RegExp(a,"g"),"/").replace(new RegExp(v,"g"),'"');for(t=0;t<o.length;t++)o[t]=o[t].replace(new RegExp(c,"g"),"+").replace(new RegExp(l,"g"),"-").replace(new RegExp(a,"g"),"/").replace(new RegExp(v,"g"),'"');return this.rK([h,u,f,e,o])},rK:function(n){for(var i,e,r,u,h=n[0],l=n[1],a=n[2],v=n[3],y=n[4],o=[],s=[],c=[],f=String.fromCharCode(251),t=0;t<l.length;t++)i=l[t],i.indexOf(f)==-1?i!=""&&c.indexOf(i)==-1&&c.push(i):(i=h[parseInt(i.replace(f,""))-1],i!=""&&o.indexOf(i)==-1&&o.push(i));for(t=0;t<y.length;t++)e=y[t].replace("/",""),e.indexOf(f)>=0&&(e=h[parseInt(e.replace(f,""))-1]),e!=""&&s.indexOf(e)==-1&&s.push(e);for(t=0;t<a.length;t++)r=a[t],r!="+"&&(r=r.replace("+","")),r.indexOf(f)>=0&&(r=h[parseInt(r.replace(f,""))-1]),r!=""&&o.indexOf(r)==-1&&o.push(r);for(t=0;t<v.length;t++)u=v[t],u!="-"&&(u=u.replace("-","")),u.indexOf(f)>=0&&(u=h[parseInt(u.replace(f,""))-1]),u!=""&&s.indexOf(u)==-1&&s.push(u);return[o,c,s]},zi:function(){var n=this;n._G$$.style.display="none";n._G$$.innerHTML="";n._G$$.style.height="22px"},r9:function(){this.d$(!1);this.u4($get(this.get_id()+"_Logout"));window.location=this._a$$},TF:function(){this.d$(!1);this.u4($get(this.get_id()+"_Logout"))},YD:function(n){n&&(this._oldWaitHTML=n.innerHTML,n.innerHTML=String.format(FastBusiness.AjaxControlExtender.MenuExtender.Resources.WaitHtml,this._c$$=="v"?"40":"53"))},u4:function(n){this._oldWaitHTML&&n&&(n.innerHTML=this._oldWaitHTML)},hash:function(n){return MD5(n)}};FastBusiness.AjaxControlExtender.MenuExtender.registerClass("FastBusiness.AjaxControlExtender.MenuExtender",Sys.UI.Behavior);FastBusiness.AjaxControlExtender.MenuExtender.Resources={Message:{User:{v:"Người sử dụng: ",e:"User: "},Unit:{v:"Đơn vị",e:"Unit"},Home:{v:"Trang chính",e:"Home"},ChangePassword:{v:"Đổi mật khẩu",e:"Change Password"},Logout:{v:"Thoát",e:"Sign Out"},ExpirePassword:{v:"Mật khẩu đã quá hạn, thay đổi mật khẩu sau đó chọn {0}{1}{2} để tiếp tục chương trình.",e:"Your password has expired. Please change your password, then click on the {0}{1}{2} link to continue."},Copyright:{v:"&copy; {0} Bản quyền thuộc công ty phần mềm QLDN Fast.",e:"Copyright &copy; {0} Fast Software Company. All rights reserved."},NotFound:{v:"Không tìm thấy kết quả!",e:"No Results Found!"},SearchPlaceHolder:{v:"Tìm kiếm...",e:"Search..."}},WaitHtml:'<div style="width:{0}px" class="MenuExtenderLoad"><\/div>'};typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded()
Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.AutoCompleteExtender=function(n){var i=null,t=this;FastBusiness.AjaxControlExtender.AutoCompleteExtender.initializeBase(t,[n]),t._allowMultiColumns=!0,t._completionTableCssClass=i,t._completionItemElementCssClass=i,t._completionValueField=i,t._completionTextField=i,t._completionDataTable=i,t._completionKeyFilter=i,t._completionCheckFilter=i,t._completionCheck=!1,t._completionOrderField=i,t._completionValueFieldWidth=i,t._completionTextFieldWidth=i,t._completionValueAlign=i,t._completionTextAlign=i,t._width=i,t._language="v",t._pageIndex=-1,t._pageCount=-1,t._pageItemEnd="",t._pageCache=i,t._labelID=i,t._label=i,t._saveTextValue=i,t._lastPageIndex=-1,t._firstPageItem="",t._lastPageItem="",t._lastRowCount=0,t._memvars=[],t.isIE6=t._ie6=Sys.Browser.agent==Sys.Browser.InternetExplorer&&Sys.Browser.version<7,t.isOpr=Sys.Browser.agent==Sys.Browser.Opera,t._fields=i,t._lookupModalBehavior=i,t._panel=i,t._lookupID=i,t._buttonID=i,t._button=i,t._button$delegates={click:Function.createDelegate(t,t._button_onclick)},t._headerText=i,t._controller=i,t._lookupFirstPageButtonIndex=0,t._lookupPageCount=0,t._lookupPageIndex=-1,t._lookupTotalRowCount=0,t._resources=FastBusiness.AjaxControlExtender.AutoCompleteExtender.Resources,t._lookupPageSize=t._resources.Pager.PageSizes[0],t._lookupResult=i,t._lookupField=i,t._lookupValueFieldID=i,t._lookupTextFieldID=i,t._lookupRefresh=!1,t._sortExpression=i,t._filter=[],t._externalFilter=[],t._filterSource=i,t._activeRow=-1,t._elementFocus=i,t._idle=i,t._initText = "",t._requireScript=i,t._requireCss=i},FastBusiness.AjaxControlExtender.AutoCompleteExtender.prototype={initialize:function(){var n=this;FastBusiness.AjaxControlExtender.AutoCompleteExtender.callBaseMethod(n,"initialize"),n._headerDropDownOnShowingHandler=Function.createDelegate(n,n._headerDropDownOnShowing),n._bodyKeydownHandler=Function.createDelegate(n,n._bodyKeydown),n._setLabelText()},dispose:function(){var t=null,n=this;Sys.Application._disposing||n._detachBehaviors(),n._lookupField=t,n._lookupModalBehavior=t,n._headerDropDownOnShowingHandler=t,n._bodyKeydownHandler=t,n._idle?AjaxControlToolkit.AutoCompleteBehavior.callBaseMethod(n,"dispose"):FastBusiness.AjaxControlExtender.AutoCompleteExtender.callBaseMethod(n,"dispose")},showPopup:function(){this._initText=this.get_element().value,this._popupBehavior.show(),this.raiseShown(Sys.EventArgs.Empty)},_highlightItem:function(n){var t=this,u=null,i,r;if(t._allowMultiColumns){for(u=t._completionListElement.firstChild.firstChild.childNodes,i=0;i<u.length;i++)r=u[i],r._highlighted&&(Sys.UI.DomElement.removeCssClass(r,t._highlightedItemCssClass),Sys.UI.DomElement.addCssClass(r,t._completionListItemCssClass));Sys.UI.DomElement.removeCssClass(n,t._completionListItemCssClass),Sys.UI.DomElement.addCssClass(n,t._highlightedItemCssClass),n._highlighted=!0}else FastBusiness.AjaxControlExtender.AutoCompleteExtender.callBaseMethod(t,"_highlightItem",[n])},_onListMouseOver:function(n){var i=this,t=n.target,u,r;if(t!==i._completionListElement&&(u=null,i._allowMultiColumns?(u=i._completionListElement.firstChild.firstChild.childNodes,t=t.tagName=="SPAN"?t.parentNode.parentNode.parentNode:t.tagName=="TD"?t.parentNode:t.parentNode.parentNode):u=i._completionListElement.childNodes,t))for(r=0;r<u.length;++r)if(t===u[r]){i._highlightItem(t),i._selectIndex=r;break}},_onListMouseDown:function(n){var t=this,i=n.target,f,r,u;i!==t._completionListElement?(f=null,t._allowMultiColumns?(r=t._completionListElement.childNodes[1],i!==r&&i!==r.firstChild&&i!==r.firstChild.firstChild&&i!==r.firstChild.firstChild.firstChild&&i!==r.firstChild.firstChild.firstChild.firstChild&&(t._setText(i),t._flyoutHasFocus=!1)):(t._setText(i),t._flyoutHasFocus=!1)):t._flyoutHasFocus=!0,u=t.get_element(),setTimeout(function(){try{u.focus()}catch(n){}},1)},_onGotFocus:function(n){FastBusiness.AjaxControlExtender.AutoCompleteExtender.callBaseMethod(this,"_onGotFocus",[n]),this._saveTextValue=this.get_element().value},_onLostFocus:function(){return},_setLabelText:function(){return},_onLostFocusComplete:function(n){return},_onLostFocusFailed:function(){return},_onKeyDown:function(n){var t=this,r,i,u,e,f;if(t._textBoxHasFocus=!0,t._timer.set_enabled(!1),r=n.keyCode?n.keyCode:n.rawEvent.keyCode,i=null,t._allowMultiColumns)try{i=t._completionListElement.firstChild.firstChild}catch(o){}else i=t._completionListElement;if(r===Sys.UI.Key.esc)t._hideCompletionList(),n.preventDefault();else if(r===Sys.UI.Key.up&&i)t._selectIndex>0&&(t._selectIndex--,t._handleScroll(i.childNodes[t._selectIndex],t._selectIndex),t._highlightItem(i.childNodes[t._selectIndex]),n.stopPropagation(),n.preventDefault());else if(r===Sys.UI.Key.down&&i)t._selectIndex<i.childNodes.length-1&&(t._selectIndex++,t._handleScroll(i.childNodes[t._selectIndex],t._selectIndex),t._highlightItem(i.childNodes[t._selectIndex]),n.stopPropagation(),n.preventDefault());else if(r===Sys.UI.Key.enter&&i)t._selectIndex!==-1&&t.get_element().value==t._initText?(t._setText(i.childNodes[t._selectIndex]),n.preventDefault()):t.hidePopup();else if(r===Sys.UI.Key.tab&&i)t._selectIndex!==-1&&t._setText(i.childNodes[t._selectIndex]);else if(r===Sys.UI.Key.pageUp)t._pageIndex>0&&(t._pageIndex-=1,t._onPageIndexChange(),t._cancelEvent(n));else if(r===Sys.UI.Key.pageDown){if(u=t.get_element(),e=!1,u.parentForm&&(e=u.parentForm._action=="View"),u.readOnly||u._viewMode||e||u._idle)return;if(u.show)(t._pageItemEnd!=""||t._pageIndex<t._pageCount)&&(t._pageIndex==t._pageCount&&(t._pageCount+=1),t._pageIndex+=1,t._onPageIndexChange(),t._cancelEvent(n));else{if(f=new Sys.CancelEventArgs,t.raisePopulating(f),f.get_cancel())return;t._cancelEvent(n),t._showEvent()}}else t._timer.set_enabled(!0)},_showEvent:function(n){var t=this,i;t._timer.set_enabled(!1),t.isOpr&&(t._textBoxHasFocus=!0),i=t._currentCompletionWord(),t._currentPrefix=n?"":i,t._pageIndex=0,t._pageCount=0,t._pageItemEnd="",t._pageCache={},t._invoke(0,t._completionSetCount,Function.createDelegate(t,t._onMethodComplete),Function.createDelegate(t,t._onMethodFailed))},_checkEvent:function(n){var t=this;t._timer.set_enabled(!1),t.isOpr&&(t._textBoxHasFocus=!0),n&&(t._lastKey=n),t._invoke(-9,-9,Function.createDelegate(t,t._onCheckComplete),Function.createDelegate(t,t._onMethodFailed))},_onCheckComplete:function(n){var u=null,t=this,f,e,i,r;t._busy(!1),t._webRequest=u,t._setResult(n),t._setFields(n.LookupFields),t._textBoxHasFocus&&(f=n.Rows,e=f.length,e==0?t._showEvent(!0):f[0]==1?t._showEvent():(i=t.get_element(),i.grid?(r=i.grid,$func&&($func.moveForeward(r.get_id(),r._fields,r._readOnly,t._lastKey,r._servicePath,r._getHandleComplete,r._getHandleFailed,i,u,i.row,r._activeColumn,!0),t._lastKey=u)):i.parentForm&&i.parentForm._processKeyEvents(u,i,!0)))},_cancelEvent:function(n){var t="undefined";typeof n.returnValue!==t&&(n.returnValue=!1),typeof n.cancelBubble!==t&&(n.cancelBubble=!0),typeof n.preventDefault!==t&&n.preventDefault(),typeof n.stopPropagation!==t&&n.stopPropagation()},_handleScroll:function(n,t){var f=this,i=f._completionListElement,u=$common.getBounds(n),e=null,r=0;f._allowMultiColumns?(e=f._completionListElement.firstChild.firstChild.childNodes.length,r=1):e=f._completionListElement.childNodes.length,(u.height+r)*t-(i.clientHeight+i.scrollTop)>=0&&(i.scrollTop+=(u.height+r)*t-(i.clientHeight+i.scrollTop)+u.height+r),(u.height+r)*(e-(t+1))-(i.scrollHeight-i.scrollTop)>=0&&(i.scrollTop-=(u.height+r)*(e-(t+1))-(i.scrollHeight-i.scrollTop)+u.height+r),i.scrollTop%(u.height+r)!=0&&((u.height+r)*(t+1)-(i.clientHeight+i.scrollTop)>=0?i.scrollTop-=i.scrollTop%(u.height+r):i.scrollTop+=u.height+r-i.scrollTop%(u.height+r))},_onMethodComplete:function(n,t){var i=this;i._busy(!1),i._webRequest=null,i._pageCache={},i._pageCache[i._pageIndex]=n.Rows,i._setResult(n),i._setFields(n.LookupFields),i._update(t,n.Rows,!0)},_onMethodFailed:function(){this._busy(!1),this._webRequest=null},_sessionKey:function(){return String.format("Lookup_{0}_{1}",this._controller,this._language)},_sessionType:function(n){return this._sessionStorage||this._sessionItem()?n+100:n},_sessionItem:function(){return sessionStorage.getItem(this._sessionKey())},_setResult:function(n){if(n&&n.Script&&n.LookupFields){var t=n.LookupFields,i=n.Script,r=t.Script;t.Script=r?i+r:i}},_setFields:function(n){var t=this,r,i,u;if(n){if(t._setCompletion)return;if(t._setCompletion=!0,t._completionDataTable||(t._completionDataTable=n.Table),t._completionValueField||(t._completionValueField=n.Code),t._completionTextField||(t._completionTextField=n.Name,r=t._completionTextField.split(","),r.length>1&&(t._completionTextField=Web.Command.Trim(r[0]))),t._completionKeyFilter||(t._completionKeyFilter=n.Filter),t._completionCheckFilter||(t._completionCheckFilter=n.Valid),t._completionCheck==null&&(t._completionCheck=n.Check),t._completionOrderField||(t._completionOrderField=n.Order),t._findIndex=n.FindIndex,t._headerText||(t._headerText=n.HeaderText),t._requireScript==null&&(t._requireScript=n.RequireScript),t._requireCss==null&&(t._requireCss=n.RequireCss),t._fields||(t._fields=n.Fields),t._fields)for(i=0;i<t._fields.length;i++)if(u=t._fields[i],u.Name.toLowerCase()==t._completionValueField.toLowerCase()?t._lookupValueFieldID=i:u.Name.toLowerCase()==t._completionTextField.toLowerCase()&&(t._lookupTextFieldID=i),t._lookupValueFieldID&&t._lookupTextFieldID)break;n.Script&&eval(n.Script);t._sessionStorage||sessionStorage.setItem(t._sessionKey(),Sys.Serialization.JavaScriptSerializer.serialize(n))}},_onTimerTick:function(n,t){var i=this,r;if(i._timer.set_enabled(!1),i._servicePath&&i._serviceMethod){if(r=i._currentCompletionWord(),r.trim().length<i._minimumPrefixLength){i._currentPrefix=null,i._update("",null,!1),i._pageIndex=-1,i._pageCount=-1,i._pageItemEnd="",i._pageCache=null;return}if(i._currentPrefix!==r||r==""&&i._minimumPrefixLength==0){if(i._pageIndex=0,i._pageCount=0,i._pageItemEnd="",i._currentPrefix=r,r!=""&&i._cache&&i._cache[r]){i._pageIndex=0,i._pageCount=0,i._pageItemEnd="",i._pageCache={},i._pageCache[i._pageIndex]=i._cache[r],i._update(r,i._cache[r],!1);return}if(t=new Sys.CancelEventArgs,i.raisePopulating(t),t.get_cancel())return;i._invoke(0,i._completionSetCount,Function.createDelegate(i,i._onMethodComplete),Function.createDelegate(i,i._onMethodFailed))}}},_onPageIndexChange:function(){var n=this,t;if(n._timer.set_enabled(!1),n._pageCache&&n._pageCache[n._pageIndex]){t=n._currentCompletionWord(),n._update(t,n._pageCache[n._pageIndex],!1);return}n._invoke(1,n._completionSetCount,Function.createDelegate(n,n._onPageMethodComplete),Function.createDelegate(n,n._onMethodFailed))},_invoke:function(n,t,i,r){var u=this,f=null,e;if(u._servicePath&&u._serviceMethod){var h=u._currentCompletionWord(),c=u.get_element().value,o=f,s=u._memvars.length>0;(s||u._lookupPageValue)&&(o={Type:s?0:1,LastPageIndex:u._lastPageIndex,FirstPageItem:u._firstPageItem,LastPageItem:u._lastPageItem,LastRowCount:u._lastRowCount,LastPageValue:u._lookupPageValue?u._lookupPageValue:f,Memvars:u._memvars}),e={type:u._sessionType(n),prefixText:n==-1?c:u._currentPrefix,count:n==-1?-1:t,language:u._language,controller:u._controller,cookie:u.get_cookie(),pageItemEnd:u._pageItemEnd,variable:o,valueField:u._completionValueField,textField:u._completionTextField,dataTable:u._completionDataTable,keyFilter:u._completionKeyFilter,keyValid:u._completionCheckFilter,check:u._completionCheck,keyFilter:u._completionKeyFilter,orderField:u._completionOrderField,lookupPageIndex:u._lookupPageIndex,lookupRefresh:u._lookupRefresh,filter:n<2?[]:u._filter,sortExpression:n<2?f:u._sortExpression,element:$func._grant(u.get_element())},u._useContextKey&&(e.contextKey=u._contextKey),u._webRequest&&(u._webRequest.get_executor().abort(),u._webRequest=f),u._busy(!0),u._webRequest=Sys.Net.WebServiceProxy.invoke(u.get_servicePath(),u.get_serviceMethod(),!1,e,i,r,h),$common.updateFormToRefreshATDeviceBuffer()}},_grant:function(n){var e=this,u,s,h,r,f;if(n&&n._grant&&(u=e.get_element(),!u._resolved)){var t=n._grant,o="",i=",",c="{0}({1}){0}",l="|";t.Reference&&(o=i+t.Reference+i),o&&o.indexOf(i+e._controller+i)>=0&&(s=null,h=null,(t.Request||t.Handle)&&(r=u.field.Name,f=u.grid,f&&(r=String.format("{0}:{1}",f._controller,r)),r=i+r+i,t.Request&&new RegExp(String.format(c,i,$func.replace(t.Request,i,l))).test(r)&&(s=!0),f&&t.Handle&&new RegExp(String.format(c,i,$func.replace(t.Handle,i,l))).test(r)&&(h=!0)),u._grant={id:t.ID,field:t.Field,script:t.Script,form:n,request:s,handle:h,controller:e._controller}),u._resolved=!0}},_onPageMethodComplete:function(n,t){var i=this;i._busy(!1),i._webRequest=null,i._pageCache[i._pageIndex]=n.Rows,i._update(t,n.Rows,!0)},_setText:function(n){return},_setTextValue:function(n,t){return},_update:function(n,t,i){return},highlighText:function(n,t){var u;if(t=="")return n;for(var r=0,i="",e=n.toLowerCase(),f=t.toLowerCase();e.indexOf(f,r)!=-1;)u=e.indexOf(f,r),i+=n.substring(r,u),i+='<span style="color:#003399">',i+=n.substr(u,t.length),i+="</span>",r=u+t.length;return i+=n.substring(r,n.length)},get_language:function(){return this._language},set_language:function(n){this._language!=n&&(this._language=n)},get_controller:function(){return this._controller},set_controller:function(n){this._controller=n},get_labelID:function(){return this._labelID},set_labelID:function(n){var t=this;t._labelID!=n&&(t._labelID=n,t._label=$get(t._labelID))},get_completionTableCssClass:function(){return this._completionTableCssClass},set_completionTableCssClass:function(n){this._completionTableCssClass!=n&&(this._completionTableCssClass=n,this.raisePropertyChanged("completionTableCssClass"))},get_completionItemElementCssClass:function(){return this._completionItemElementCssClass},set_completionItemElementCssClass:function(n){this._completionItemElementCssClass!=n&&(this._completionItemElementCssClass=n,this.raisePropertyChanged("completionItemElementCssClass"))},get_completionValueField:function(){return this._completionValueField},set_completionValueField:function(n){this._completionValueField!=n&&(this._completionValueField=n,this.raisePropertyChanged("completionValueField"))},get_completionTextField:function(){return this._completionTextField},set_completionTextField:function(n){this._completionTextField!=n&&(this._completionTextField=n,this.raisePropertyChanged("completionTextField"))},get_completionDataTable:function(){return this._completionDataTable},set_completionDataTable:function(n){this._completionDataTable!=n&&(this._completionDataTable=n,this.raisePropertyChanged("completionDataTable"))},get_completionKeyFilter:function(){return this._completionKeyFilter},set_completionKeyFilter:function(n){this._completionKeyFilter!=n&&(this._completionKeyFilter=n,this.raisePropertyChanged("completionKeyFilter"))},get_completionCheckFilter:function(){return this._completionCheckFilter},set_completionCheckFilter:function(n){this._completionCheckFilter!=n&&(this._completionCheckFilter=n,this.raisePropertyChanged("completionCheckFilter"))},get_completionCheck:function(){return this._completionCheck},set_completionCheck:function(n){this._completionCheck!=n&&(this._completionCheck=n,this.raisePropertyChanged("completionCheck"))},get_completionOrderField:function(){return this._completionOrderField},set_completionOrderField:function(n){this._completionOrderField!=n&&(this._completionOrderField=n,this.raisePropertyChanged("completionOrderField"))},get_allowMultiColumns:function(){return this.__allowMultiColumns},set_allowMultiColumns:function(n){this._allowMultiColumns!=n&&(this._allowMultiColumns=n,this.raisePropertyChanged("allowMultiColumns"))},get_completionValueFieldWidth:function(){return this._completionValueFieldWidth},set_completionValueFieldWidth:function(n){this._completionValueFieldWidth!=n&&(this._completionValueFieldWidth=n,this.raisePropertyChanged("completionValueFieldWidth"))},get_completionTextFieldWidth:function(){return this._completionTextFieldWidth},set_completionTextFieldWidth:function(n){this._completionTextFieldWidth!=n&&(this._completionTextFieldWidth=n,this.raisePropertyChanged("completionTextFieldWidth"))},get_completionValueAlign:function(){return this._completionValueAlign},set_completionValueAlign:function(n){this._completionValueAlign!=n&&(this._completionValueAlign=n,this.raisePropertyChanged("completionValueAlign"))},get_completionTextAlign:function(){return this._completionTextAlign},set_completionTextAlign:function(n){this._completionTextAlign!=n&&(this._completionTextAlign=n,this.raisePropertyChanged("completionTextAlign"))},get_buttonID:function(){return this._buttonID},set_buttonID:function(n){this._buttonID!=n&&(this._buttonID=n,this.set_button($get(n)))},get_lookupID:function(){return this._lookupID},set_lookupID:function(n){this._lookupID!=n&&(this._lookupID=n)},get_button:function(){return this._button},set_button:function(n){var t=this;t._button!=n&&(t._button&&$common.removeHandlers(t._button,t._button$delegates),t._button=n,t._button&&$addHandlers(t._button,t._button$delegates),t.raisePropertyChanged("button"))},get_cookie:function(){return this._cookie},set_cookie:function(n){this._cookie=n},get_lookupPageIndex:function(){return this._lookupPageIndex},set_lookupPageIndex:function(n){var t=this,i;(t._lookupPageIndex=n,n>=0)&&(i=t._resources.Pager.PageButtonCount,n>=t._lookupFirstPageButtonIndex+i?t._lookupFirstPageButtonIndex=n:n<t._lookupFirstPageButtonIndex&&(t._lookupFirstPageButtonIndex-=i,n<t._lookupFirstPageButtonIndex&&(t._lookupFirstPageButtonIndex=n)),t._lookupFirstPageButtonIndex<0&&(t._lookupFirstPageButtonIndex=0),t._lookupPageCount-t._lookupFirstPageButtonIndex<i&&(t._lookupFirstPageButtonIndex=t._lookupPageCount-i),t._lookupFirstPageButtonIndex<0&&(t._lookupFirstPageButtonIndex=0))},get_lookupPageSize:function(){return this._lookupPageSize},set_lookupPageSize:function(n){var t=this;t._lookupPageSize=n,t._fields!=null&&(t.set_lookupPageIndex(-2),t._loadPage())},get_sortExpression:function(){return this._sortExpression},set_sortExpression:function(n){var r=" asc",t=this,i;n&&n.length!=0?(i=n.match(/^(\w+)\s*((asc|desc)|$)/),t._sortExpression=i[2].length==0?t._sortExpression==null||t._sortExpression.match(/^(\w+)\s/)[1]!=i[1]?n+r:t._sortExpression.endsWith(r)?n+" desc":n+r:n):t._sortExpression=null},get_filterSource:function(){return this._filterSource},set_filterSource:function(n){this._filterSource=n},get_filter:function(){var n=this,t,i;if(n._lookupField==null&&(n._lookupPageIndex==-1&&!n._fields||n._externalFilter.length>0&&n._filter.length==0)){if(t=document.location.href.match(/\?([\s\S]+)/),t&&(n.get_filterSource()!="None"||n.get_filterSource()==null))for(n._externalFilter=[],i=/(\w+)=([\S\s]+?)(&|$)/g;match=i.exec(t[1]);)Array.add(n._externalFilter,{Name:match[1],Value:match[2]});n.applyExternalFilter()}return n._filter},set_filter:function(n){this._filter=n},get_memvars:function(){return this._memvars},set_memvars:function(n){this._memvars=n},_busy:function(n){this._isBusy=n,this._enableButtons(!n)},_enableButtons:function(){return},_valueToString:function(n,t){var i=n.DataFormatString;return n.Type=="DateTime"&&i&&i.length>0?t==null?"null":t.format(i):t},_valueToFormatString:function(n,t){return t.length>0&&t.indexOf("#")>0?Web.Command.NumberFormat(n,t.replace(/{0:/g,"").replace(/}/g,"")):String.localeFormat(t,n)},_button_onclick:function(n){n.preventDefault(),n.stopPropagation(),this.showLookup()},_initLookupBehavior:function(){var n=this;n._lookupModalBehavior||(n._lookupID=n._buttonID+"_Lookup",n._panel=document.createElement("div"),n._panel.id=n._lookupID+"_Panel",n._panel.style.padding="4px",n._panel.style.backgroundColor="white",n._panel.style.border="solid 1px silver",n._container==null&&(n._container=document.createElement("div"),n._container.className="DataViewContainer"),document.body.appendChild(n._panel),n.get_element().parentNode.appendChild(n._panel),n._panel.appendChild(n._container),n._lookupModalBehavior=$create(FastBusiness.AjaxControlExtender.ModalPopupExtender,{id:n._lookupID,PopupControlID:n._panel.id,DropShadow:!0,BackgroundCssClass:"ModalBackground"},null,null,n._button))},_disposeLookupBehavior:function(){var n=this,t=null;n._lookupModalBehavior!=t&&(n._lookupModalBehavior.dispose(),n._lookupModalBehavior=t,n._container.parentNode.removeChild(n._container),n._container=t,n._panel.parentNode.removeChild(n._panel),n._panel=t)},_onLookupMethodComplete:function(n,t){var r=this,u,f;for(r._busy(!1),r._webRequest=null,r._setResult(n),r._setFields(n.LookupFields),r._lookupResult=n.Rows,u=r._lookupResult.length,r._lookupPageIndex<0&&u>0?(r._lookupPageIndex=0,r._lookupFirstPageButtonIndex=0,r._lookupTotalRowCount=n.TotalRowCount,r._lookupPageCount=Math.floor(r._lookupTotalRowCount/r._lookupPageSize),r._lookupTotalRowCount%r._lookupPageSize!=0&&r._lookupPageCount++):(r._lookupRefresh||u==0)&&(r._lookupTotalRowCount=n.TotalRowCount,r._lookupPageCount=Math.floor(r._lookupTotalRowCount/r._lookupPageSize),r._lookupTotalRowCount%r._lookupPageSize!=0&&r._lookupPageCount++),r._lookupRefresh=!1,i=0;i<r._fields.length;i++)f=r._fields[i],f.AllowFilter&&(f._listOfValues=null);u>0&&(r._lastPageIndex=r._lookupPageIndex,r._firstPageItem=r._getOrderString(0),r._lastPageItem=r._getOrderString(u-1),r._firstPageValue=r._getOrderValue(0),r._lastPageValue=r._getOrderValue(u-1)),r._lastRowCount=r._lookupTotalRowCount,r._render(r._lookupResult,t)},_onLookupMethodFailed:function(){this._busy(!1),this._webRequest=null,this.hideLookup()},_get_colSpan:function(){return this._fields.length},_showWait:function(){var n=$get(this._lookupID+"_Wait");n&&(this._oldWaitHTML=n.innerHTML,n.innerHTML=this._resources.WaitHtml)},_hideWait:function(){if(this._oldWaitHTML){var n=$get(this._lookupID+"_Wait");n&&(n.innerHTML=this._oldWaitHTML)}},_render:function(n){var t=this,i=new Sys.StringBuilder;t._renderTable(i),t._renderViewDescription(i),t._renderViewHeaderBar(i),t._renderInfoBar(i),t._renderHeaderText(i),t._renderRows(i,n),t._renderViewPager(i),t._renderNoRecords(i),t._container.innerHTML=i.toString(),t._attachBehaviors(),t._adjustLookupSize()},_renderTable:function(n){n.append(String.format('<table id = "{0}" class="DataView" cellpadding="0" cellspacing="0">',this._lookupID+"_Table"))},_renderViewDescription:function(n){var t=this,i=t._lookupID;n.append(String.format('<tr id="{0}_HeaderText" class="HeaderTextRow"><td colspan="{1}" class="HeaderText">',i,t._get_colSpan())),n.append('<table style="width:100%" cellpadding="0" cellspacing="0"><tr><td style="padding:0px">'),n.append(t._headerText),n.append(String.format('</td><td align="right" style="padding:0px"><a href="#" id="{0}_CloseButton" class="Close" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').hideLookup();return false">{1}</a></td></tr></table>',i,t.getResources("Close"))),n.append("</td></tr>")},_renderViewHeaderBar:function(n){return},_renderInfoBar:function(n){var t=this;t.get_filter().length>0&&!t.filterIsExternal()&&(n.append(String.format('<tr class="InfoRow"><td colspan="{0}" id="{2}_InfoBar">',t._get_colSpan())),t._renderFilterDetails(n),n.append("</td></tr>"))},_renderFilterDetails:function(n){var t=this,f,e,u,r,o,i,s,c;for(n.append(String.format('<span class="Information">&nbsp;</span>{0}',t.getResources("InfoBar.FilterApplied"))),f=0;f<t.get_filter().length;f++)if(e=t.get_filter()[f].match(/(\w+):([\s\S]*)/),u=t.findField(e[1]),u&&!t._fieldIsInExternalFilter(u)){n.append(String.format(t._resources.InfoBar.ValueIs,u.HeaderText));for(var l=/(\*|\!={0,1}|\>={0,1}|\<[=,>]{0,1}|=)([\s\S]*?)(\0|$)/g,h=!0,a=t.getResources("InfoBar."+(e[2].match(">|<")?"And":"Or"));(info=l.exec(e[2]))!=null;){h?h=!1:n.append(a),r=info[2],o=r.startsWith("%")||r.startsWith("*");switch(info[1]){case"=":i=r=="null"?"Empty":"EqualTo";break;case"!=":case"<>":i="NotEqualTo";break;case"<":i="LessThan";break;case"<=":i="LessThanOrEqualTo";break;case">":i="GreaterThan";break;case">=":i="GreaterThanOrEqual";break;case"*":i=o?"Like":"StartsWith";break;case"!":i=o?"NotLike":"DoesNotStartWith"}n.append(t.getResources("InfoBar."+i)),s=t._findItemByValue(u,r),c=s==null?r:s[1],r!="null"&&n.append(String.format("<b>{0}</b>",t.htmlEncode(c)))}n.append(".")}},_renderHeaderText:function(n){var r=this,t,i;for(n.append('<tr class="HeaderRow">'),t=0;t<r._fields.length;t++)i=r._fields[t],n.append(String.format('<th class="{2}"><div id="{0}_Header{1}" style="text-align:{3};padding:3px;cursor:pointer;{4}" class="HeaderSelector">',r._lookupID,t,i.Name,i.Align,i.Hidden?"visibility:hidden;display:none;":"")),r._renderFieldHeaderText(n,i),n.append("</div></th>");n.append("</tr>")},_renderFieldHeaderText:function(n,t){var i=this;t.AllowSorting?(n.append(String.format('<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').sort(\'{1}\');return false" title="{3}">{2}</a>',i._lookupID,t.Name,t.HeaderText,String.format(i.getResources("HeaderFilter.SortBy"),t.HeaderText))),i.get_sortExpression()!=null&&i.get_sortExpression().startsWith(t.Name+" ")&&n.append(i.get_sortExpression().endsWith(" asc")?'<span class="SortUp">&nbsp;</span>':'<span class="SortDown">&nbsp;</span>'),i._renderFieldHeaderFilter(n,t)):(n.append(t.HeaderText),i._renderFieldHeaderFilter(n,t))},_renderFieldHeaderFilter:function(n,t){var i=this;if(t.AllowFilter){var u='<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').',f=');return false" title="{2}" class="',s='"/>',e=t.Index,r=i.filterOf(t)!=null,o="margin-right:16px";c=r?String.format(u+"applyFilterByIndex({1},-1"+f+'HeaderClear" style="{3}"/>',i._lookupID,e,String.format(i.getResources("HeaderFilter.ClearFilter"),t.HeaderText),o):"",n.append(String.format(u+"showCustomFilter({1},1"+f+'{3}Filter" id="{0}_CustomFilterHeader{1}" style="cursor:default;{4}"/>{5}',i._lookupID,e,i.getResources("HeaderFilter.CustomFilterOption"),r?"":"Header",r?"":o,c))}},_rowIsSelected:function(n){var t=n[this._lookupValueFieldID],i=this._currentCompletionWord();return t?t||i?(t=Web.Command.Trim(t.toString()).toUpperCase(),i=Web.Command.Trim(i.toString()).toUpperCase(),t!=i)?!1:!0:!1:!1},_renderRows:function(n,t){for(var i=this,o=i._lookupID,f,e,u,a,r=0;r<t.length;r++){for(f=t[r],e=!1,e=i._activeRow>0?i._activeRow==r+1:i._rowIsSelected(f),n.append(String.format('<tr id="{0}_Row{1}" class="{2}Row{3}" onmouseover="{4}addCssClass{5}" onmouseout="{4}removeCssClass{5}">',o,r,r%2==0?"":"Alternating",e?" Selected":"","Sys.UI.DomElement.","(this,'Highlight');")),u=0;u<i._fields.length;u++){field=i._fields[u];var v=i.htmlEncode(i._valueToString(field,f[u])),c=field.Name,s=field.Align,l=field.Hidden,h=s?String.format("text-align:{0};",s):"",y=h?String.format(' style="{0}"',h):"";n.append(String.format('<td{0} class="Cell {1}">',y,c)),u==0&&(n.append(String.format('<div id="{0}_RowSelector{1}" style="padding:2px;cursor:pointer;">',o,r)),n.append(String.format('<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').changeLookupValue({1});return false">',o,r))),a=field.ClientScript?" "+i.templateEngine(field.ClientScript,{instance:i,data:t,row:f,field:field,index:r,column:u}):String.format('{0}class="Column_{1}"',s||l?String.format('style="{0}{1}" ',h,l?"visibility:hidden;display:none;":""):"",c),n.append(String.format("<div {0}>{1}</div>",a,v)),u==0&&(n.append("</a>"),n.append("</div>")),n.append("</td>")}n.append("</tr>")}},_renderViewPager:function(n){var t=this,v,c,l;n.append(String.format('<tr class="FooterRow"><td colspan="{0}" class="Footer"><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td align="left" class="Pager">',t._get_colSpan()));var r=t._lookupID,a='<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{',f=t._lookupPageIndex,s=t._lookupPageSize,e=t._lookupPageCount,h=t._lookupTotalRowCount;if(e>1){var o=a+'1}\').goToPage({0});return false" class="PaddedLink">',u=t._lookupFirstPageButtonIndex,y=t._resources.Pager.PageButtonCount;for(f>0?n.append(String.format(o+"{2}</a>",f-1,r,t.getResources("Pager.Previous"))):n.append(String.format('<span class="Disabled">{0}</span>',t.getResources("Pager.Previous"))),n.append(String.format(" | {0}: ",t.getResources("Pager.Page"))),u>0&&(u>1&&n.append(String.format(o+"1</a>",0,r)),n.append(String.format(o+"...</a>",u-1,r)));y>0&&u<e;)u==f?n.append(String.format('<span class="Selected">{0}</span>',u+1)):n.append(String.format(o+"{2}</a>",u,r,u+1)),u++,y--;u<e&&(v=t._lookupFirstPageButtonIndex+t._resources.Pager.PageButtonCount,n.append(String.format(o+"...</a>",v,r)),v!=e-1&&n.append(String.format(o+"{2}</a>",e-1,r,e))),n.append(" | "),f<e-1?n.append(String.format(o+"{2}</a>",f+1,r,t.getResources("Pager.Next"))):n.append(String.format('<span class="Disabled">{0}</span>',t.getResources("Pager.Next")))}if(n.append('</td><td align="right" class="Pager">&nbsp;'),c=t._resources.Pager.PageSizes,h>s){for(n.append(t.getResources("Pager.ItemsPerPage")),i=0;i<c.length;i++)i>0&&n.append(", "),s==c[i]?n.append(String.format("<b>{0}</b>",s)):n.append(String.format(a+"0}').set_lookupPageSize({1});return false\">{1}</a>",r,c[i]));n.append(" | ")}h>0&&(l=(f+1)*s,l>h&&(l=h),n.append(String.format(t.getResources("Pager.ShowingItems"),f*s+1,l,h)),n.append(" | ")),n.append(String.format('</td><td align="center" class="Pager" id="{0}_Wait" style="width:55px">',r)),n.append(String.format(a+'0}\').goToPage(-1);return false" class="PaddedLink">{1}</a>',r,t.getResources("Pager.Refresh"))),n.append("</td></tr></table>"),n.append("</td></tr>")},_renderNoRecords:function(n){var t=this;t._lookupTotalRowCount==0&&n.append(String.format('<tr class="Row NoRecords"><td colspan="{0}" class="Cell">{1}</td></tr>',t._get_colSpan(),t.getResources("NoRecords")))},_getStyle:function(n,t){return n.currentStyle?n.currentStyle[t]:window.getComputedStyle?document.defaultView.getComputedStyle(n,null).getPropertyValue(t.replace(/([A-Z])/,"-$1").toLowerCase()):""},_attachBehaviors:function(){var u="white",n=this,i,t,f,r;for(n._detachBehaviors(),i=0;i<n._fields.length;i++)t=n._fields[i],f=$get(n._lookupID+"_Header"+i.toString()),t.AllowSorting||t.AllowFilter?(t._dropDownPanel||(r=t._dropDownPanel=document.createElement("div"),Sys.UI.DomElement.setVisible(r,!1),r.id=n._lookupID+"_DropDownPanel"+i.toString(),r.className="ContextMenuPanel"),dropDown=t._headerDropDownBehavior=$create(AjaxControlToolkit.DropDownBehavior,{dropDownControl:t._dropDownPanel,id:n._lookupID+"_HeaderDropDown"+i.toString()},null,null,f),n._panel.appendChild(r),dropDown.set_highlightBorderColor(u),dropDown.set_highlightBackgroundColor(u),dropDown.set_dropArrowBackgroundColor(u),dropDown.add_showing(n._headerDropDownOnShowingHandler)):f.style.cursor=""},_detachBehaviors:function(){var t=null,r=this,n;if(r._fields!=t)for(i=0;i<r._fields.length;i++)n=r._fields[i],n._headerDropDownBehavior!=t&&(n._headerDropDownBehavior.remove_showing(r._headerDropDownOnShowingHandler),n._headerDropDownBehavior.dispose(),n._headerDropDownBehavior=t),n._dropDownPanel!=t&&(r._panel.removeChild(n._dropDownPanel),n._dropDownPanel=t)},_headerDropDownOnShowing:function(n){var i=this,r=n.get_id().match(/_HeaderDropDown(\d+)/),t=i._fields[Number.parseInvariant(r[1])];i._renderFieldHeaderOptions(t),!t._listOfValues&&t.AllowFilter?i._loadListOfValues(t):i._adjustFieldHeaderOptions(t)},_bodyKeydown:function(n){var t=this,i;t._inactive||(t._customFilterField?n.keyCode==Sys.UI.Key.enter?t.applyCustomFilter(t._customFilterMode):n.keyCode==Sys.UI.Key.esc&&t.closeCustomFilter():t._lookupField&&n.keyCode==Sys.UI.Key.esc&&(i=$get(String.format("{0}_CloseButton",t._lookupID)),i.tabIndex!=-1&&t.hideLookup()))},_renderFieldHeaderOptions:function(n,t){var i=this,r,s,a;n._adjustmentNeeded=!0;var c=n.Type,h=c=="String",o="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find('{0}').",v=i.getResources("HeaderFilter."+(h?"StringSortAscending":c=="DateTime"?"DateSortAscending":"GenericSortAscending")),y=i.getResources("HeaderFilter."+(h?"StringSortDescending":c=="DateTime"?"DateSortDescending":"GenericSortDescending")),e=new Sys.StringBuilder;if(n.AllowSorting&&e.append(String.format('<a href="#" onclick="'+o+'sort(\'{1} asc\');return false" class="ContextMenuItem SortAscending">{2}</a><a href="#" onclick="'+o+'sort(\'{1} desc\');return false" class="ContextMenuItem SortDescending">{3}</a>',i._lookupID,n.Name,v,y)),t||(t=n._listOfValues),n.AllowFilter)if(t){for(r=i.filterOf(n),r=r&&r.startsWith("=")?r.substr(1):r?"\x00":null,n.AllowSorting&&e.append('<div class="ContextMenuBreak"></div>'),e.append(String.format('<div id="Options"><a href="#" id="{0}_CustomFilterOption{1}" onclick="{3}if(!this.disabled)'+o+'applyFilterByIndex({1},-1);return false" class="ContextMenuItem FilterOff{2} {2}" {3}>{4}&nbsp;</a><a href="#" onclick="'+o+'showCustomFilter({1});return false" class="ContextMenuItem {6}">{5}</a>',i._lookupID,n.Index,r?"":"Disabled",r?"":"return false;",String.format(i.getResources("HeaderFilter.ClearFilter"),n.HeaderText),i.getResources("HeaderFilter.CustomFilterOption"),r&&r.indexOf("\x00")>=0?"Checked":"CustomFilter")),t.length>0&&e.append('<div class="ContextMenuBreak"></div>'),s=0;s<t.length;s++){var l=!1,u=t[s],f=u;u==null?f=i.getResources("HeaderFilter.EmptyValue"):n.Items.length>0?(a=i._findItemByValue(n,u),f=a[1]):h&&u.length==0?f=i.getResources("HeaderFilter.BlankValue"):n.DataFormatString!=null&&n.DataFormatString.length>0&&(f=i._valueToString(n,u)),u=u==null?"null":i._valueToString(n,u),l=u==r,f.length>i._resources.HeaderFilter.MaxTextLength&&(f=f.substring(0,i._resources.HeaderFilter.MaxTextLength)+"..."),e.append(String.format('<a href="#" onclick="'+o+'applyFilterByIndex({1},{2});return false" class="ContextMenuItem {4}">{3}</a>',i._lookupID,n.Index,s,h&&u!="null"?i.htmlEncode(f):f==""?"0":f,l?"Checked":""))}e.append("</div>")}else e.append(String.format('<div class="Wait">{0}</div>',i.getResources("HeaderFilter.Loading")));n._dropDownPanel.innerHTML=e.toString()},_loadListOfValues:function(n){var t=this,i,u,f,r;if(t._busy(!0),result=[],t._lookupResult&&t._lookupResult.length>0)for(i=0;i<t._lookupResult.length;i++){for(u=t._lookupResult[i][n.Index],f=!0,r=0;r<result.length;r++)if($func.compareFieldValue(n,result[r],u)){f=!1;break}f&&Array.add(result,u)}t._busy(!1),n._listOfValues=result,result[result.length-1]==null&&(Array.insert(result,0,result[result.length-1]),Array.removeAt(result,result.length-1)),t._renderFieldHeaderOptions(n,result),t._adjustFieldHeaderOptions(n)},_adjustFieldHeaderOptions:function(n){var t=n._dropDownPanel,l,u;if(n._listOfValues&&n._adjustmentNeeded&&n.AllowFilter){l=t.style.display,t.style.display="block",t.style.width="115px",n._adjustmentNeeded=!1;var i=$get("Options",t),c=i.offsetHeight>250,h=c?20:0;i.style.overflow="auto",u=i.scrollWidth,i.style.overflow="",t.offsetWidth<u&&(i.style.width=u+h+"px",t.style.width=u+h+"px");var a=$common.getBounds(n._headerDropDownBehavior.get_element()),v=$common.getBounds(t),f={x:a.x+a.width-v.width,y:t.offsetTop},y=$common.getBounds(this.get_element());if(f.x<0&&(f.x=0),Sys.UI.DomElement.setLocation(t,f.x,t.offsetTop),c){var o=$common.getClientBounds(),r=250,e=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,s=$common.getBounds(i);s.y+r-e>o.height-2&&(r=o.height-(s.y-e)-2),r<50&&(r=50),i.style.height=r+"px",i.style.overflow="auto"}t.style.display=l}},filterIsExternal:function(){var n=this,i,u,r,t;if(n._externalFilter.length==0)return!1;for(i=0;i<n._filter.length;i++){for(u=n._filter[i].match(/(\w+):/)[1],r=!1,t=0;t<n._externalFilter.length;t++)if(n._externalFilter[t].Name==u){r=!0;break}if(!r)return!1}return!0},showCustomFilter:function(n,t){for(var i=this,r=i._lookupID,v=t?"Header":"Option",l=String.format("FastBusiness.AjaxControlExtender.AutoCompleteExtender.find('{0}').",r),o=i._fields[n],f=null,h,e,a,u,c,s=0;s<i._filter.length;s++)if(h=i._filter[s].match(/(\w+):([\s\S]*)/),h[1]==o.Name){f=h[2];break}t&&o.Type!="String"&&(t=null),f&&f.indexOf("\x00")==-1&&(f+="\x00"),e=i._customFilterPanel=document.createElement("div"),a=$get(r+"_CustomFilter"+v+n),i._panel.appendChild(e),e.className="CustomFilterDialog",e.id=r+"_CustomFilterPanel",u=new Sys.StringBuilder,u.append(String.format("<div>{0}</div>",String.format(i.getResources("HeaderFilter.CustomFilterPrompt"),i._headerText,o.HeaderText))),u.append('<table cellpadding="0" cellspacing="0">'),u.append(String.format('<tr><td colspan="2"><input type="text" style="width:390px" id="{0}_Query" value="{1}"></input></td></tr>',r,f?i.htmlAttributeEncode(f.replace(/\0/g,", ").replace(/\*|[^!<>]=|^=|, $/g,"")):"")),u.append(String.format('<tr><td></td><td align="right"><button id="{0}Ok">'+i.getResources("ModalPopup.Ok")+'</button> <button id="{0}Cancel">'+i.getResources("ModalPopup.Cancel")+"</button></td></tr>",r)),u.append("</table>"),e.innerHTML=u.toString(),i._customFilterField=o,i._customFilterMode=t,i._customFilterModalPopupBehavior=$create(AjaxControlToolkit.ModalPopupBehavior,{OkControlID:r+"Ok",CancelControlID:r+"Cancel",OnOkScript:l+"applyCustomFilter("+(t?"1":"")+")",OnCancelScript:l+"closeCustomFilter()",PopupControlID:e.id,DropShadow:!0,BackgroundCssClass:"ModalBackground"},null,null,a),i._customFilterModalPopupBehavior._backgroundElement.style.zIndex=$common.getCurrentStyle(i._lookupModalBehavior._backgroundElement,"zIndex",i._lookupModalBehavior._backgroundElement.style.zIndex)+1,i._customFilterModalPopupBehavior._foregroundElement.style.zIndex=$common.getCurrentStyle(i._customFilterModalPopupBehavior._backgroundElement,"zIndex",i._customFilterModalPopupBehavior._backgroundElement.style.zIndex)+1,i._customFilterModalPopupBehavior.show(),c=$get(r+"_Query"),c&&Web.Command.focus(c)},applyCustomFilter:function(n){var t=this;t.removeFromFilter(t._customFilterField);var f=/\s*(=|!={0,1}|<={0,1}|<>{0,1}|>={0,1}|)\s*([\S\s]+?)\s*(,|$)/g,i=null,u=t._customFilterField.Name+":",r=$get(t._lookupID+"_Query").value;for(n&&r&&(r="*"+r);i=f.exec(r);)u+=(i[1]?i[1]:t._customFilterField.Type=="String"?"*":"=")+i[2]+"\x00";u.indexOf("\x00")>0&&Array.add(t._filter,u),t.set_lookupPageIndex(-2),t._loadPage(),t.closeCustomFilter()},closeCustomFilter:function(){var n=this;n._customFilterModalPopupBehavior&&(n._customFilterModalPopupBehavior.dispose(),n._customFilterModalPopupBehavior=null,n._customFilterField=null,n._customFilterMode=null),n._customFilterPanel&&(n._customFilterPanel.parentNode.removeChild(n._customFilterPanel),n._customFilterPanel=null)},removeFromFilter:function(n){for(var t=0;t<this._filter.length;t++)if(this._filter[t].match(/^(\w+):/)[1]==n.Name){Array.removeAt(this._filter,t);break}},applyFilterByIndex:function(n,t){var i=this._fields[n];this.applyFilter(i,t>=0?"=":null,t>=0?i._listOfValues[t]:null)},applyFilter:function(n,t,i){var r=this;r.removeFromFilter(n),t&&Array.add(r._filter,n.Name+":"+t+(i=="0"?i:r._valueToString(n,i))),r.set_lookupPageIndex(-2),r._loadPage()},applyExternalFilter:function(){var t=this,n,i;for(t._filter=[],n=0;n<t._externalFilter.length;n++)i=t._externalFilter[n],Array.add(t._filter,i.Name+":="+i.Value)},filterOf:function(n){for(var i=n.Name+":",t=0;t<this._filter.length;t++)if(this._filter[t].startsWith(i))return this._filter[t].substr(i.length);return null},findField:function(n){for(var i,t=0;t<this._fields.length;t++)if(i=this._fields[t],i.Name==n)return i;return null},_fieldIsInExternalFilter:function(n){return this._findExternalFilterItem(n)!=null},_findExternalFilterItem:function(n){for(var i,t=0;t<this._externalFilter.length;t++)if(i=this._externalFilter[t],n.Name==i.Name)return i;return null},_findItemByValue:function(n,t){var r,i,u;if(n.Items.length==0)return null;for(t=t==null?"":t.toString(),r=0;r<n.Items.length;r++)if(i=n.Items[r],u=i[0]==null?"":i[0].toString(),u==t)return i;return[t,t]},_adjustLookupSize:function(){var n=this;try{n._lookupModalBehavior._layout()}catch(u){}if(n.get_lookupPageSize()>3){var r=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,i=$common.getClientBounds(),t=Sys.UI.DomElement.getBounds(n._panel);t.height+t.y>i.height+r&&n.set_lookupPageSize(Math.ceil(n.get_lookupPageSize()*.66))}},_loadPage:function(){var n=this;n._activeRow=-1,n._showWait(),n._invoke(2,n._lookupPageSize,Function.createDelegate(n,n._onLookupMethodComplete),Function.createDelegate(n,n._onLookupMethodFailed))},showLookup:function(){var n=this;n._initLookupBehavior(),n._container.innerHTML=n._resources.WaitHtml,n._lookupField=!0,n._lookupModalBehavior.show(),n._lookupModalBehavior._dropShadowBehavior.set_Width(3),n._lookupModalBehavior._dropShadowBehavior._shadowDiv.style.backgroundColor="#3171C6",$addHandler(document.body,"keydown",n._bodyKeydownHandler),n._loadPage()},hideLookup:function(){var n=this;n._activeRow=-1,n.set_lookupPageIndex(-1),n._lookupField=!1,$removeHandler(document.body,"keydown",n._bodyKeydownHandler),n._lookupModalBehavior.hide()},_getOrderString:function(n){for(var i=this,u=i._lookupResult[n],f="",e=i._completionOrderField.replace(/desc/gi,"").replace(/asc/gi,"").replace(/ /gi,"").split(","),t,r=0;r<e.length;r++)t=i.findField(e[r]),t&&u[t.Index]!=null&&(f+=t.Type=="DateTime"?i._formatDateOrder(u[t.Index]):u[t.Index].toString());return f},_getOrderValue:function(n){var t=this,f=t._lookupResult[n],r=[],u="",o,s,e=t._completionOrderField.replace(/desc/gi,"").replace(/asc/gi,"").replace(/ /gi,"").split(","),i;for(t._sortExpression&&(u=t._sortExpression.replace(/ (asc|desc)/,""),t._addOrderValue(r,f,u,"")),i=0;i<e.length;i++)t._addOrderValue(r,f,e[i],u);return r},_addOrderValue:function(n,t,i,r){var u=$func.findField(i,this._fields);u&&u.Name!=r&&(o=t[u.Index],u.Type=="DateTime"&&(o=new Date(o.getTime()),o.setMinutes(o.getMinutes()-o.getTimezoneOffset())),Array.add(n,o))},_formatDateOrder:function(n){var r=n.getFullYear(),t=n.getMonth()+1,i=n.getDate();return""+r+(t>9?"":"0")+t+(i>9?"":"0")+i},changeLookupValue:function(n){var t=this,i;t._isBusy||(t._setTextValue(Web.Command.RTrim(t._lookupResult[n][t._lookupTextFieldID]),Web.Command.RTrim(t._lookupResult[n][t._lookupValueFieldID])),t.hideLookup(),t._elementFocus)||(i=t.get_element(),Web.Command.focus(i),Web.Command.SetSelectionStart(i,0))},sort:function(n){this.set_sortExpression(n),this.set_lookupPageIndex(0),this._loadPage()},goToPage:function(n){var t=this;t._isBusy||(n>=0?(t.set_lookupPageIndex(n),t._lookupRefresh=!1):t._lookupRefresh=!0,t._lastPageValue&&(t._lookupPageValue=t._lookupPageIndex>t._lastPageIndex?t._lastPageValue:t._firstPageValue),t._loadPage(),t._lookupPageValue=null)},filterOf:function(n){for(var i=n.Name+":",t=0;t<this._filter.length;t++)if(this._filter[t].startsWith(i))return this._filter[t].substr(i.length);return null},getResources:function(r){var e=String.format("'{0}' == 'v' ? FastBusiness.AjaxControlExtender.AutoCompleteExtender.Resources.{1}.v : FastBusiness.AjaxControlExtender.AutoCompleteExtender.Resources.{1}.e",this._language,r);return eval(e)},templateEngine:function(n,t){for(var e=/<%([^%>]+)?%>/g,o=/(^( )?(var|if|for|else|switch|case|break|{|}))(.*)?/g,r="var r=[];\n",u=0,i,f=function(n,t){return r+=t?n.match(o)?n+"\n":"r.push("+n+");\n":n!=""?'r.push("'+n.replace(/"/g,'\\"')+'");\n':"",f};i=e.exec(n);)f(n.slice(u,i.index))(i[1],!0),u=i.index+i[0].length;return f(n.substr(u,n.length-u)),r+='return r.join("");',new Function(r.replace(/[\r\t\n]/g,"")).apply(t)},htmlEncode:function(n){return n?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n},htmlAttributeEncode:function(n){return n?n.replace(/\x27/g,"&#39;").replace(/\x22/g,"&quot;"):n}},FastBusiness.AjaxControlExtender.AutoCompleteExtender.inheritsFrom(AjaxControlToolkit.AutoCompleteBehavior),FastBusiness.AjaxControlExtender.AutoCompleteExtender.registerClass("FastBusiness.AjaxControlExtender.AutoCompleteExtender",AjaxControlToolkit.AutoCompleteBehavior),FastBusiness.AjaxControlExtender.AutoCompleteExtender.find=function(n){for(var r=Sys.Application.getComponents(),t,i=0;i<r.length;i++)if(t=r[i],FastBusiness.AjaxControlExtender.AutoCompleteExtender.isInstanceOfType(t)&&t.get_lookupID()&&t.get_lookupID()==n)return t;return null},FastBusiness.AjaxControlExtender.AutoCompleteExtender.Resources={PgUpMessage:{v:"PgUp: Trang trước",e:"PgUp: Prev Page"},PgDownMessage:{v:"PgDown: Trang sau",e:"PgDown: Next Page"},NoneMessage:{v:"",e:""},Message:{v:"PgUp: Trang trước, PgDown: Trang sau",e:"PgUp: Prev Page, PgDown: Next Page"},Close:{v:"Đóng",e:"Close"},SelectField:{v:"Chọn",e:"Select"},NoRecords:{v:"Không có bản ghi nào.",e:"No Records Found."},WaitHtml:'<div class="Wait"></div>',WaitText:'<span class="Wait">.....</span>',InfoBar:{FilterApplied:{v:"Các bản ghi đang được lọc.",e:"A filter has been applied."},ValueIs:' <span class="Highlight">{0}</span> ',Or:{v:" hoặc ",e:" or "},And:{v:" và ",e:" and "},EqualTo:{v:"bằng ",e:"is equal to "},NotEqualTo:{v:"khác ",e:"is not equal to "},LessThan:{v:"nhỏ hơn ",e:"is less than "},LessThanOrEqualTo:{v:"nhỏ hơn hoặc bằng ",e:"is less than or equal to "},GreaterThan:{v:"lớn hơn ",e:"is greater than "},GreaterThanOrEqual:{v:"lớn hơn hoặc bằng ",e:"is greater than or equal to "},Like:{v:"thuộc ",e:"is like "},NotLike:{v:"không thuộc ",e:"is not like "},StartsWith:{v:"bắt đầu bằng ",e:"starts with "},DoesNotStartWith:{v:"không bắt đầu bằng ",e:"does not start with "},Empty:{v:"không có",e:"empty"}},Pager:{ItemsPerPage:{v:"Số bản ghi một trang: ",e:"Items per page: "},PageSizes:[10,15,20,25],ShowingItems:{v:"Xem <b>{0}</b>-<b>{1}</b>/<b>{2}</b> bản ghi",e:" Showing <b>{0}</b>-<b>{1}</b>/<b>{2}</b> item(s)"},Refresh:{v:"Làm tươi",e:"Refresh"},Next:{v:"Tiếp »",e:"Next »"},Previous:{v:"« Trước",e:"« Previous"},Page:{v:"Trang",e:"Page"},PageButtonCount:10},HeaderFilter:{GenericSortAscending:{v:"Nhỏ nhất lên trước",e:"Smallest on Top"},GenericSortDescending:{v:"Lớn nhất lên trước",e:"Largest on Top"},StringSortAscending:{v:"Tăng dần",e:"Ascending"},StringSortDescending:{v:"Giảm dần",e:"Descending"},DateSortAscending:{v:"Gần nhất lên trước",e:"Earliest on Top"},DateSortDescending:{v:"Xa nhất lên trước",e:"Latest on Top"},EmptyValue:{v:"(Không có)",e:"(Empty)"},BlankValue:{v:"(Trắng)",e:"(Blank)"},Loading:{v:"Đang thực hiện...",e:"Loading..."},ClearFilter:{v:"Bỏ lọc trường {0}",e:"Clear Filter from {0}"},SortBy:{v:"Sắp xếp theo {0}",e:"Sort by {0}"},MaxTextLength:80,CustomFilterOption:{v:"Lọc...",e:"Custom Filter..."},CustomFilterPrompt:{v:'Xem tất cả các dòng trong <span class="Highlight">{0}</span> khi <span class="Highlight">{1}</span> thỏa mãn các điều kiện sau. Có thể chọn nhiều điều kiện cách nhau bằng dấu , và dùng &gt;, &lt;, &gt;=, &lt;=, &lt;&gt; hoặc != đặt trước các giá trị. Có thể dùng dấu * và % của các trường ký tự để lọc.',e:'Show all rows in <span class="Highlight">{0}</span> where column <span class="Highlight">{1}</span> matches the following value(s). You may separate multiple values with comma and use &gt;, &lt;, &gt;=, &lt;=, &lt;&gt; or != operators placed before the value. Use *, % operators placed before or after the value.'},CustomFilterLimit:5,FormFilterPrompt:{v:'<span class="Highlight">Điều kiện lọc</span>',e:"Filter"}},ModalPopup:{Close:{v:"Đóng",e:"Close"},MaxWidth:700,MaxHeight:500,Ok:{v:"Nhận",e:"Ok"},Cancel:{v:"Hủy",e:"Cancel"}}},typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.CalendarExtender=function(n){var i=null,t=this;FastBusiness.AjaxControlExtender.CalendarExtender.initializeBase(t,[n]),t._format="dd/MM/yyyy",t._language="v",t._empty=Web.Command.DateBlankFormat(t._format),t.cultureInfo=FastBusiness.AjaxControlExtender.CalendarExtenderResources.cultureInfo,t._keypressdown=i,t._keypressHandler=i,t._focusHandler=i,t._blurHandler=i,t._contextHandler=i;var r=t.get_element();r.value==""&&(r.value=t._empty)},FastBusiness.AjaxControlExtender.CalendarExtender.prototype={initialize:function(){var n=this;FastBusiness.AjaxControlExtender.CalendarExtender.callBaseMethod(n,"initialize");var t=n.get_element();t.readOnly||(n._keypressdown=Function.createDelegate(n,n._onKeyPressdown),n._keypressHandler=Function.createDelegate(n,n._onKeyPress),n._focusHandler=Function.createDelegate(n,n._onFocus),n._blurHandler=Function.createDelegate(n,n._onBlur),n._contextHandler=Function.createDelegate(n,n._onContextMenu),$addHandler(t,"keydown",n._keypressdown),$addHandler(t,"keypress",n._keypressHandler),$addHandler(t,"focus",n._focusHandler),$addHandler(t,"blur",n._blurHandler),$addHandler(t,"contextmenu",n._contextHandler))},dispose:function(){var t=null,n=this,i=n.get_element();n._contextHandler&&($removeHandler(i,"contextmenu",n._contextHandler),n._contextHandler=t),n._blurHandler&&($removeHandler(i,"blur",n._blurHandler),n._blurHandler=t),n._focusHandler&&($removeHandler(i,"focus",n._focusHandler),n._focusHandler=t),n._keypressHandler&&($removeHandler(i,"keypress",n._keypressHandler),n._keypressHandler=t),n._keypressdown&&($removeHandler(i,"keydown",n._keypressdown),n._keypressdown=t),FastBusiness.AjaxControlExtender.CalendarExtender.callBaseMethod(n,"dispose")},get_language:function(){return this._language},set_language:function(n){this._language!=n&&(this._language=n)},get_buttonID:function(){return this._buttonID},set_buttonID:function(n){var t=this;t._buttonID!=n&&(t._buttonID=n,t._button&&t.get_isInitialized()&&$common.removeHandlers(t._button,t._button$delegates),t._button=$get(n),t._button&&t.get_isInitialized()&&$addHandlers(t._button,t._button$delegates),t.raisePropertyChanged("button"))},_onKeyPressdown:function(n){var i=this.get_element(),t=this._format;Web.Command.onDateKeyDown(i,t,n)},_onKeyPress:function(n){var i=this.get_element(),t=this._format;Web.Command.onDateKeyPress(i,t,n)},_onFocus:function(){var t=this.get_element();Web.Command.onDateFocus(t)},_onBlur:function(){var t=this,i=t.get_element(),f=t._format,u,r;Web.Command.onDateBlur(i,f);if(!(i.value==t._empty||i.value=="")){u=Date.parseLocale(i.value,t._format),r=!1,t._isOpen||(r=!0,t._isOpen=!0);try{t.set_selectedDate(u)}catch(e){}r&&(t._isOpen=!1)}},_onContextMenu:function(){return Web.Command.Nothing()},_buildDays:function(){var n=this,o=Sys.CultureInfo.CurrentCulture.dateTimeFormat,r=n.get_id(),t,f,i,u,e;for(n._days=$common.createElementFromTemplate({nodeName:"div",properties:{id:r+"_days"},cssClasses:["ajax__calendar_days"]},n._body),n._modes.days=n._days,n._daysTable=$common.createElementFromTemplate({nodeName:"table",properties:{id:r+"_daysTable",cellPadding:0,cellSpacing:0,border:0,style:{margin:"auto"}}},n._days),n._daysTableHeader=$common.createElementFromTemplate({nodeName:"thead",properties:{id:r+"_daysTableHeader"}},n._daysTable),n._daysTableHeaderRow=$common.createElementFromTemplate({nodeName:"tr",properties:{id:r+"_daysTableHeaderRow"}},n._daysTableHeader),t=0;t<7;t++)u=$common.createElementFromTemplate({nodeName:"td"},n._daysTableHeaderRow),e=$common.createElementFromTemplate({nodeName:"div",cssClasses:["ajax__calendar_dayname"]},u);for(n._daysBody=$common.createElementFromTemplate({nodeName:"tbody",properties:{id:r+"_daysBody"}},n._daysTable),t=0;t<6;t++)for(f=$common.createElementFromTemplate({nodeName:"tr"},n._daysBody),i=0;i<7;i++)u=$common.createElementFromTemplate({nodeName:"td"},f),e=$common.createElementFromTemplate({nodeName:"div",properties:{mode:"day",id:r+"_day_"+t+"_"+i,innerHTML:"&nbsp;"},events:n._cell$delegates,cssClasses:i==5?["ajax__calendar_sat"]:i==6?["ajax__calendar_sun"]:["ajax__calendar_day"]},u)},_buildMonths:function(){var n=this,u,r,t,f,i,e,o;for(u=n._language.toLowerCase()=="v"?n.cultureInfo.dateTimeFormat:Sys.CultureInfo.CurrentCulture.dateTimeFormat,r=n.get_id(),n._months=$common.createElementFromTemplate({nodeName:"div",properties:{id:r+"_months"},cssClasses:["ajax__calendar_months"],visible:!1},n._body),n._modes.months=n._months,n._monthsTable=$common.createElementFromTemplate({nodeName:"table",properties:{id:r+"_monthsTable",cellPadding:0,cellSpacing:0,border:0,style:{margin:"auto"}}},n._months),n._monthsBody=$common.createElementFromTemplate({nodeName:"tbody",properties:{id:r+"_monthsBody"}},n._monthsTable),t=0;t<3;t++)for(f=$common.createElementFromTemplate({nodeName:"tr"},n._monthsBody),i=0;i<4;i++)e=$common.createElementFromTemplate({nodeName:"td"},f),o=$common.createElementFromTemplate({nodeName:"div",properties:{id:r+"_month_"+t+"_"+i,mode:"month",month:t*4+i,innerHTML:"<br />"+u.AbbreviatedMonthNames[t*4+i]},events:n._cell$delegates,cssClasses:["ajax__calendar_month"]},e)},_performLayout:function(){var p="ajax__calendar_active",v="ajax__calendar_other",b="dd/MM/yyyy",n=this,g=n.get_element(),l,w,a,k,f,h,d,c,r,o,u,s,e,t;if(g&&n.get_isInitialized()&&n._isOpen){l=n._language.toLowerCase()=="v"?n.cultureInfo.dateTimeFormat:Sys.CultureInfo.CurrentCulture.dateTimeFormat;var nt=n.get_selectedDate(),i=n._getEffectiveVisibleDate(),y=n.get_todaysDate();switch(n._mode){case"days":for(w=1,a=i.getDay()-w,a<=0&&(a+=7),k=new Date(i.getFullYear(),i.getMonth(),i.getDate()-a,n._hourOffsetForDst),f=k,u=0;u<7;u++)r=n._daysTableHeaderRow.cells[u].firstChild,r.firstChild&&r.removeChild(r.firstChild),r.appendChild(document.createTextNode(l.ShortestDayNames[(u+w)%7]));for(h=0;h<6;h++)for(d=n._daysBody.rows[h],c=0;c<7;c++)r=d.cells[c].firstChild,r.firstChild&&r.removeChild(r.firstChild),r.appendChild(document.createTextNode(f.getDate())),r.title=f.localeFormat(b),r.date=f,$common.removeCssClasses(r.parentNode,[v,p]),Sys.UI.DomElement.addCssClass(r.parentNode,n._getCssClass(r.date,"d")),f=new Date(f.getFullYear(),f.getMonth(),f.getDate()+1,n._hourOffsetForDst);n._prevArrow.date=new Date(i.getFullYear(),i.getMonth()-1,1,n._hourOffsetForDst),n._nextArrow.date=new Date(i.getFullYear(),i.getMonth()+1,1,n._hourOffsetForDst),n._title.firstChild&&n._title.removeChild(n._title.firstChild),n._title.appendChild(document.createTextNode(l.MonthNames[i.getMonth()]+i.localeFormat(", yyyy"))),n._title.date=i;break;case"months":for(u=0;u<n._monthsBody.rows.length;u++)for(s=n._monthsBody.rows[u],e=0;e<s.cells.length;e++)t=s.cells[e].firstChild,t.date=new Date(i.getFullYear(),t.month,1,n._hourOffsetForDst),t.title=t.date.localeFormat("MM/yyyy"),$common.removeCssClasses(t.parentNode,[v,p]),Sys.UI.DomElement.addCssClass(t.parentNode,n._getCssClass(t.date,"M"));n._title.firstChild&&n._title.removeChild(n._title.firstChild),n._title.appendChild(document.createTextNode(i.localeFormat("yyyy"))),n._title.date=i,n._prevArrow.date=new Date(i.getFullYear()-1,0,1,n._hourOffsetForDst),n._nextArrow.date=new Date(i.getFullYear()+1,0,1,n._hourOffsetForDst);break;case"years":for(o=Math.floor(i.getFullYear()/10)*10,u=0;u<n._yearsBody.rows.length;u++)for(s=n._yearsBody.rows[u],e=0;e<s.cells.length;e++)t=s.cells[e].firstChild,t.date=new Date(o+t.year,0,1,n._hourOffsetForDst),t.firstChild?t.removeChild(t.lastChild):t.appendChild(document.createElement("br")),t.appendChild(document.createTextNode(o+t.year)),$common.removeCssClasses(t.parentNode,[v,p]),Sys.UI.DomElement.addCssClass(t.parentNode,n._getCssClass(t.date,"y"));n._title.firstChild&&n._title.removeChild(n._title.firstChild),n._title.appendChild(document.createTextNode(o.toString()+"-"+(o+9).toString())),n._title.date=i,n._prevArrow.date=new Date(o-10,0,1,n._hourOffsetForDst),n._nextArrow.date=new Date(o+10,0,1,n._hourOffsetForDst)}n._today.firstChild&&n._today.removeChild(n._today.firstChild),n._language.toLowerCase()=="v"?n._today.appendChild(document.createTextNode(String.format(n.cultureInfo.dateTimeFormat.Today,y.localeFormat(b)))):n._today.appendChild(document.createTextNode(String.format(AjaxControlToolkit.Resources.Calendar_Today,y.localeFormat(n.get_todaysDateFormat())))),n._today.date=y}}},FastBusiness.AjaxControlExtender.CalendarExtender.inheritsFrom(AjaxControlToolkit.CalendarBehavior),FastBusiness.AjaxControlExtender.CalendarExtender.registerClass("FastBusiness.AjaxControlExtender.CalendarExtender",AjaxControlToolkit.CalendarBehavior),FastBusiness.AjaxControlExtender.CalendarExtenderResources={},FastBusiness.AjaxControlExtender.CalendarExtenderResources.cultureInfo={dateTimeFormat:{ShortDatePattern:"dd/MM/yyyy",ShortestDayNames:["C","H","B","T","N","S","B"],AbbreviatedMonthNames:["T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11","T12",""],MonthNames:["Tháng giêng","Tháng hai","Tháng ba","Tháng tư","Tháng năm","Tháng sáu","Tháng bảy","Tháng tám","Tháng chín","Tháng mười","Tháng mười một","Tháng mười hai",""],Today:"Ngày hiện tại: {0}"}},typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.ReportExtender=function(n){var t=this,i=null,u=!1,r=!0;FastBusiness.AjaxControlExtender.ReportExtender.initializeBase(t,[n]),t._type=i,t._mode=i,t._language=i,t._cookie=i,t._salt=i,t._hashIndex=-1,t._hashValue=i,t._initScript=i,t._adjustTimeZone=i,t._offsetTime=i,t._readOnly=u,t._clone=i,t._allowNew=r,t._allowEdit=r,t._allowDelete=r,t._confirmDelete=r,t._childObject=u,t._controller=i,t._viewId=i,t._serviceMethod=i,t._servicePath=i,t._serviceLookup=i,t._baseUrl=i,t._query=i,t._filterMode=u,t._title=i,t._subTitle=i,t._gridTitle=i,t._alterTitle=i,t._activeCell=i,t._activeRow=-1,t._activeColumn=-1,t._anchor=r,t._offsetHeight=i,t._fixedHeight=i,t._fixedColumns=0,t._fixedLength=0,t._footerAdjustment=r,t._gridPageCount=0,t._gridFirstPageButtonIndex=0,t._gridPageIndex=-1,t._gridTotalRowCount=0,t._gridRefresh=u,t._sortExpression=i,t._filter=[],t._memvars=[],t._externalFilter=[],t._filterSource=i,t._filterMemvars=[],t._externalKey=[],t._fields=[],t._externalHiddenFields=i,t._externalHeaderFields=i,t._rows=[],t._allFields=[],t._keyFields=[],t._lastPageIndex=-1,t._firstPageItem="",t._lastPageItem="",t._lastRowCount=0,t._initFirstRow=i,t._dirInfor=i,t._dirAccess=i,t._dirScript=i,t._denyNew=i,t._denyEdit=i,t._denyDelete=i,t._denyMessage=i,t._denySessionStorage=i,t._ground=i,t._searchInfor=i,t._searchScript=i,t._formScript=i,t._autoExpansion=i,t._resources=FastBusiness.AjaxControlExtender.GridFunction.Resources,t._gridPageSize=t._resources.Pager.PageSizes[1],t._resizeDelegate=Function.createDelegate(t,t._whenResize),t._scrollDelegate=Function.createDelegate(t,t._onScroll),t._scrollHeader=Function.createDelegate(t,t._headerScroll),t._resizeFooter=Function.createDelegate(t,t._footerResize),t._scrollFooter=Function.createDelegate(t,t._footerScroll),t._mouseUpDelegate=Function.createDelegate(t,t._mouseUp),t._mouseMoveDelegate=Function.createDelegate(t,t._mouseMove),t._parentGrid=i,t.f$p=i,t._siftColumnIndex=i,t._forms=[],t._toolbar=[["New","Toolbar.New"],["Edit","Toolbar.Edit"],["Delete","Toolbar.Delete"],["View","Toolbar.View"],["Export","Toolbar.Export"],["Freeze","Toolbar.Freeze"]]},FastBusiness.AjaxControlExtender.ReportExtender.prototype={initialize:function(){FastBusiness.AjaxControlExtender.ReportExtender.callBaseMethod(this,"initialize"),this._keypressdown=Function.createDelegate(this,this._onKeyPressdown),this._keypressHandler=Function.createDelegate(this,this._onKeyPress),this._keypressup=Function.createDelegate(this,this._onKeyPressup),this._resizeHandler=Function.createDelegate(this,this._onResize),this._bodyKeydownHandler=Function.createDelegate(this,this._bodyKeydown),this._formKeydownHandler=Function.createDelegate(this,this._formKeydown);try{$message.id}catch(n){this.$message=$message=new FastBusiness.AjaxControlExtender.Msg(this.get_id(),this.get_language())}$addHandler(window,"resize",this._resizeHandler),$addHandler(document,"mouseup",this._mouseUpDelegate),$addHandler(document,"mousemove",this._mouseMoveDelegate),$addHandler(document.body,"keydown",this._bodyKeydownHandler),document.activeElement||(this._activeElementHandle=Function.createDelegate(this,this._activeElement),$addHandler(document,"focus",this._activeElementHandle)),this._getHandleComplete=Function.createDelegate(this,this._onGetHandleComplete),this._getHandleFailed=Function.createDelegate(this,this._onGetHandleFailed),this._headerDropDownOnShowingHandler=Function.createDelegate(this,this._headerDropDownOnShowing),this._groupOnShowingHandler=Function.createDelegate(this,this._groupOnShowing)},dispose:function(){var n=this,t=null,i,r;for(n.disposeToolbarInstance(),n._groupOnShowingHandler=t,n._type!="Report"||n._transmitted||(n._loadPage(-2),n._transmitted=!0),n._closeScript&&(n.excuteScript(n._closeScript),n._closeScript=t),Sys.Application._disposing||n._detachBehaviors(),n._script&&(n._script.parentNode&&n._script.parentNode.removeChild(n._script),n._script=t),n._css&&(n._css.parentNode&&n._css.parentNode.removeChild(n._css),n._css=t),n._scatterScript&&(n._scatterScript=t),n._renderScript&&(n._renderScript=t),n._checkScript&&(n._checkScript=t),n._dirExtender&&(n._dirExtender.dispose(),n._dirExtender=t),n._searchExtender&&(n._searchExtender.dispose(),n._searchExtender=t),i=0;i<n._forms.length;i++)r=n._forms[i],r&&(r.dispose(),r=t);n._forms=[];n.$message&&$message&&($message.dispose(),$message=t);n._container&&n._formKeydownHandler&&($removeHandler(n._container,"keydown",n._formKeydownHandler),n._formKeydownHandler=t);n._bodyKeydownHandler&&($removeHandler(document.body,"keydown",n._bodyKeydownHandler),n._bodyKeydownHandler=t);n._resizeHandler&&($removeHandler(window,"resize",n._resizeHandler),n._resizeHandler=t);n._mouseUpDelegate&&($removeHandler(document,"mouseup",n._mouseUpDelegate),n._mouseUpDelegate=t);n._mouseMoveDelegate&&($removeHandler(document,"mousemove",n._mouseMoveDelegate),n._mouseMoveDelegate=t);n._activeElementHandle&&($removeHandler(document,"focus",n._activeElementHandle),n._activeElementHandle=t);n._keypressup=t;n._keypressHandler=t;n._keypressdown=t;n._scrollDelegate=t;n._resizeDelegate=t;n._scrollHeader=t;n._resizeFooter=t;n._scrollFooter=t;n._getHandleComplete=t;n._getHandleFailed=t;n._headerDropDownOnShowingHandler=t;FastBusiness.AjaxControlExtender.ReportExtender.callBaseMethod(n,"dispose")},get_language:function(){return this._language},set_language:function(n){this._language!=n&&(this._language=n)},get_toolbar:function(){return this._toolbar},set_toolbar:function(n){this._toolbar=n},get_toolbarButton:function(n){return $get(String.format("{0}_ToolbarButton_{1}",this.get_id(),n))},get_executeButton:function(n){var t=this.get_toolbarButton(n);return t&&$common.getVisible(t)?!0:!1},get_gridTitle:function(){return this._gridTitle},set_gridTitle:function(n){this._gridTitle=n},get_anchor:function(){return this._anchor},set_anchor:function(n){this._anchor!=n&&(this._anchor=n)},get_fixedHeight:function(){return this._fixedHeight},set_fixedHeight:function(n){this._fixedHeight!=n&&(this._fixedHeight=n)},get_offsetHeight:function(){return this._offsetHeight},set_offsetHeight:function(n){this._offsetHeight!=n&&(this._offsetHeight=n)},get_footerAdjustment:function(){return this._footerAdjustment},set_footerAdjustment:function(n){this._footerAdjustment!=n&&(this._footerAdjustment=n)},get_initScript:function(){return this._initScript},set_initScript:function(n){this._initScript!=n&&(this._initScript=n)},get_parentGrid:function(){return this._parentGrid},set_parentGrid:function(n){this._parentGrid!=n&&(this._parentGrid=n)},get_offsetTime:function(){return this._offsetTime},set_offsetTime:function(n){if(this._offsetTime!=n){if(window._offsetTime===undefined){var t=(new Date).getFullYear(),i=new Date(t,0,1),r=new Date(t,6,1);window._offsetTime=(n*60+Math.max(i.getTimezoneOffset(),r.getTimezoneOffset()))*6e4}this._offsetTime=n}},get_readOnly:function(){return this._readOnly},set_readOnly:function(n){this._readOnly!=n&&(this._readOnly=n)},get_allowNew:function(){return this._readOnly?!1:this._allowNew},set_allowNew:function(n){this._allowNew!=n&&(this._allowNew=n)},get_allowEdit:function(){return this._readOnly?!1:this._allowEdit},set_allowEdit:function(n){this._allowEdit!=n&&(this._allowEdit=n)},get_allowDelete:function(){return this._readOnly?!1:this._allowDelete},set_allowDelete:function(n){this._allowDelete!=n&&(this._allowDelete=n)},get_confirmDelete:function(){return this._confirmDelete},set_confirmDelete:function(n){this._confirmDelete=n},get_childObject:function(){return this._childObject},set_childObject:function(n){this._childObject=n},get_autoExpansion:function(){return this._autoExpansion},set_autoExpansion:function(n){this._autoExpansion=n},get_autoAppearance:function(){return this._autoAppearance},set_autoAppearance:function(n){this._autoAppearance=n},get_redundant:function(){return this.g$t},set_redundant:function(n){this.g$t=n},get_confirmEscape:function(){return this._confirmEscape},set_confirmEscape:function(n){this._confirmEscape=n},get_controller:function(){return this._controller},set_controller:function(n){this._controller=n},get_viewId:function(){return this._viewId},set_viewId:function(n){this._viewId=n},get_serviceMethod:function(){return this._serviceMethod},set_serviceMethod:function(n){this._serviceMethod=n},get_servicePath:function(){return this._servicePath},set_servicePath:function(n){this._servicePath=n},get_serviceLookup:function(){return this._serviceLookup},set_serviceLookup:function(n){this._serviceLookup=n},get_baseUrl:function(){return this._baseUrl},set_baseUrl:function(n){this._baseUrl=n},get_query:function(){return this._query},set_query:function(n){this._query=n},get_filterMode:function(){return this._filterMode},set_filterMode:function(n){this._filterMode=n},get_filterMemvars:function(){return this._filterMemvars},set_filterMemvars:function(n){this._filterMemvars=n},get_dirInfor:function(){return this._dirInfor},set_dirInfor:function(n){this._dirInfor=n},get_dirAccess:function(){return this._dirAccess},set_dirAccess:function(n){this._dirAccess=n},get_dirScript:function(){return this._dirScript},set_dirScript:function(n){this._dirScript=n},get_ground:function(){return this._ground},set_ground:function(n){this._ground=n},get_searchInfor:function(){return this._searchInfor},set_searchInfor:function(n){this._searchInfor=n},get_searchScript:function(){return this._searchScript},set_searchScript:function(n){this._searchScript=n},get_memvars:function(){return this._memvars},set_memvars:function(n){this._memvars=n},get_variable:function(){return this._variable},set_variable:function(n){this._variable=n},get_initFirstRow:function(){return this._initFirstRow},set_initFirstRow:function(n){this._initFirstRow=n},get_clone:function(){return this._clone},set_clone:function(n){this._clone!=n&&(this._clone=n)},get_denySessionStorage:function(){return this._denySessionStorage},set_denySessionStorage:function(n){this._denySessionStorage!=n&&(this._denySessionStorage=n)},get_cookie:function(){return this._cookie},set_cookie:function(n){this._cookie=n},get_salt:function(){return this._salt},set_salt:function(n){this._salt=n},get_hashValue:function(){return this._hashValue},set_hashValue:function(n){this._hashValue=n},get_gridPageIndex:function(){return this._gridPageIndex},set_gridPageIndex:function(n){if(this._gridPageIndex=n,n>=0){var t=this._resources.Pager.PageButtonCount;n>=this._gridFirstPageButtonIndex+t?this._gridFirstPageButtonIndex=n:n<this._gridFirstPageButtonIndex&&(this._gridFirstPageButtonIndex-=t,n<this._gridFirstPageButtonIndex&&(this._gridFirstPageButtonIndex=n)),this._gridFirstPageButtonIndex<0&&(this._gridFirstPageButtonIndex=0),this._gridPageCount-this._gridFirstPageButtonIndex<t&&(this._gridFirstPageButtonIndex=this._gridPageCount-t),this._gridFirstPageButtonIndex<0&&(this._gridFirstPageButtonIndex=0)}},get_initPageSize:function(){return this._gridPageSize},set_initPageSize:function(n){this._gridPageSize=n},get_gridPageSize:function(){return this._gridPageSize},set_gridPageSize:function(n){this._gridPageSize=n,this._fields!=null&&(this.set_gridPageIndex(-2),this._loadPage(1))},get_sortExpression:function(){return this._sortExpression},set_sortExpression:function(n){if(n&&n.length!=0){var t=n.replace("$","").match(/^(\w+)\s*((asc|desc)|$)/);this._sortExpression=t[2].length==0?this._sortExpression==null||this._sortExpression.replace("$","").match(/^(\w+)\s/)[1]!=t[1]?n+" asc":this._sortExpression.endsWith(" asc")?n+" desc":n+" asc":n}else this._sortExpression=null},get_filterSource:function(){return this._filterSource},set_filterSource:function(n){this._filterSource=n},get_filter:function(){var n=this,t,i;if(n._gridPageIndex==-1&&!n._fields||n._externalFilter.length>0&&n._filter.length==0){if(t=document.location.href.match(/\?([\s\S]+)/),t&&(n.get_filterSource()!="None"||n.get_filterSource()==null))for(n._externalFilter=[],i=/([\w\$]+)=([\S\s]+?)(&|$)/g;match=i.exec(t[1]);)Array.add(n._externalFilter,{Name:match[1],Value:match[2]});n.applyExternalFilter()}return n._filter},set_filter:function(n){this._filter=n},get_externalKey:function(){return this._externalKey},set_externalKey:function(n){this._externalKey=n},get_fixedColumns:function(){return this._fixedColumns},set_fixedColumns:function(n){var t=this,i;n<0?(i=!1,t._activeCell&&t._activeColumn<=t._fixedColumns&&t._getColumnVisible(t._activeColumn)&&($func.hideImageActiveCell(t._activeCell),i=!0),t._changePosition(-1),t._changePosition(0),i&&$func.showImageActiveCell(t._activeCell)):(t._fixedColumns>0&&(t._changePosition(-1),t.A07(0)),t._fixedColumns=n,t._fixedColumns>0&&(t._changePosition(0),t.A07(t._fixedColumns)))},add_commandEvent:function(n){this.get_events().addHandler("commandEvent",n)},remove_commandEvent:function(n){this.get_events().removeHandler("commandEvent",n)},raisecommandEvent:function(n){var t=this.get_events().getHandler("commandEvent");t&&t(this,n)},raiseGridEvent:function(n,t){var i=null,r;switch(n){case"BeforeRemoveRow":i=this._activeRow;break;case"AfterCloneRow":i=this._rowCount}return t&&(i=t),r=new FastBusiness.AjaxControlExtender.EventArgs(this,{cancelEvent:!1,Value:i,Action:n}),this.raisecommandEvent(r),!r.type.cancelEvent},add_itemValueChanged:function(n){this.get_events().addHandler("itemValueChanged",n)},remove_itemValueChanged:function(n){this.get_events().removeHandler("itemValueChanged",n)},raiseItemValueChanged:function(n){var t=this.get_events().getHandler("itemValueChanged");t&&t(this,n)},add_onRender:function(n){this.get_events().addHandler("onRender",n)},remove_onRender:function(n){this.get_events().removeHandler("onRender",n)},raiseOnRender:function(n){var t=this.get_events().getHandler("onRender");t&&t(this,n)},updated:function(){var t;if(this._initScript&&(this.excuteScript(this._initScript),this._initScript=null),FastBusiness.AjaxControlExtender.ReportExtender.callBaseMethod(this,"updated"),this._salt){var n="",i=this._salt.split(String.fromCharCode(9)),r=i[1];try{r.length!=1&&(n=localStorage.getItem(r))}catch(t){n=""}if(MD5(n+this._cookie)!=i[0])return}if(t=this.get_element(),this._setHeight(),this._setWidth(),this._container==null&&(t.innerHTML="",this._container=document.createElement("div"),this.get_element().appendChild(this._container),$addHandler(this._container,"keydown",this._formKeydownHandler)),this._filterMode){this._loadPage(-5);return}this._container.innerHTML=this._resources.WaitHtml,this._loadPage(0)},_loadPage:function(n){var t=this;t._waiting?t._waiting=null:$func.showWait(t.get_id()),t._invoke(n,t._gridPageSize,Function.createDelegate(t,t._onMethodComplete),Function.createDelegate(t,t._onMethodFailed))},_sift:function(){var n=this,i,t,r;if(n._siftColumnIndex==null)return n._memvars;for(i=[],t=0;t<n._memvars.length;t++)r=n._memvars[t],r[0][n._siftColumnIndex]&&Array.add(i,r);return i},_invoke:function(n,t,i,r){var u=this,e,f,o,s,h;u._servicePath&&u._serviceMethod&&(e=null,f=n,n==-3&&(o=u._aggregateField=u._activeCell.field,e=String.format("{0},{1},{2}",o.Aggregate,o.Name,o.DataFormatString)),!e&&u._hashValue&&(e=u._hashValue),f==0&&(s=String.format("Grid_{0}_{1}",u._controller,u._language),!u._denySessionStorage&&sessionStorage.getItem(s)?f=u._clone?8:9:u._clone&&(f=7)),u._replication&&(f=-11),h={type:f,count:t,language:u._language,controller:u._controller,viewId:u._viewId,childObject:u._childObject,lastPageIndex:u._lastPageIndex,firstPageItem:u._firstPageItem,lastPageItem:u._lastPageItem,lastRowCount:u._lastRowCount,memvars:n<0?[]:u._memvars,externalKey:u._externalKey,gridPageIndex:u._gridPageIndex,gridPageValue:u._gridPageValue?u._gridPageValue:null,gridRefresh:u._gridRefresh,filter:u._filter,sortExpression:u._sortExpression,cookie:u.get_cookie(),query:u._query,parameter:e,variable:u._variable?u._variable:""},n!=-2&&u._busy(!0),Sys.Net.WebServiceProxy.invoke(u.get_servicePath(),u.get_serviceMethod(),!1,h,i,r,n))},_onMethodComplete:function(n,t){var i=this,o=null,h,e,r,c,s,l,u,a,v,f;if(n.ViewPage&&n.ViewPage.Mode&&n.ViewPage.Mode=="Pivot"&&(i._denySessionStorage=!0),i._mode=="Pivot"&&n.ViewPage){if($func.A04(i._fields,i._headerDropDownOnShowingHandler),i._allFields=n.ViewPage.Fields,i._fields&&i._fields.length)for(u=0;u<n.ViewPage.View.length;u++)h=n.ViewPage.View[u],e=$func.findField(h.Name,i._fields),e&&e.AllowFilter&&(e.FilterPanelReference!=o&&(h.FilterPanelReference=e.FilterPanelReference),e.FilterPanelValue!=o&&(h.FilterPanelValue=e.FilterPanelValue));i._fields=n.ViewPage.View;i._columnCount=i._fields.length;t!=0&&$func.attachFields(i._fields,i._allFields)}if(t==0){if(c=String.format("Grid_{0}_{1}",i._controller,i._language),s=sessionStorage.getItem(c),!i._denySessionStorage&&s)r=Sys.Serialization.JavaScriptSerializer.deserialize(s);else if(n&&n.ViewPage){r={};r.Fields=n.ViewPage.Fields;r.View=n.ViewPage.View;r.Toolbar=n.ViewPage.Toolbar;r.Scripts=n.Scripts;r.Css=n.Css;s=Sys.Serialization.JavaScriptSerializer.serialize(r);try{sessionStorage.setItem(c,s)}catch(y){}}n.SuspendFilter&&(i.s$f=!0)}if(t!=-2){if(!n.Authorized){i._container.innerHTML=$df.getResources(i._language,"Message.NotAuthorized");return}if(i._busy(!1),t==-5){i.search();return}if(t==-3){$func.hideWait(i.get_id());$message.show(String.format(i._getResources("Message.Aggregate"),i._aggregateField.HeaderText,n.Rows[0]),String.format("$find('{0}')._activeCell.focus();",i.get_id()));return}if(t==0)try{i._type=n.ViewPage.Type;i._mode=n.ViewPage.Mode}catch(y){}if(t==0&&!n.ViewPage){i._filterMode=!0;i._processMode=!0;i._container.innerHTML="";i.search();return}if(t==0){if(i._title||(i._title=n.ViewPage.TitleText),i._subTitle||(i._subTitle=n.ViewPage.SubTitleText),i._fields=r.View,r.Toolbar&&r.Toolbar.length>0)for(i._toolbar=r.Toolbar,i._allowNew=!1,i._allowDelete=!1,u=0;u<i._toolbar.length;u++)l=i._toolbar[u][0],l=="Insert"&&(i._allowNew=!0),l=="Remove"&&(i._allowDelete=!0);for(n.ViewPage.FixedColumns>0&&(i._fixedColumns=n.ViewPage.FixedColumns),i._freezeColumns=n.ViewPage.FreezeColumns,i._freezeColumns>0&&i._fixedColumns>i._freezeColumns&&(i._fixedColumns=i._freezeColumns),i._allFields=r.Fields,i._columnCount=i._fields.length,$func.attachFields(i._fields,i._allFields),i._orderFields=[],n.ViewPage.Order.length>0&&(i._orderFields=n.ViewPage.Order.replace(/desc/gi,"").replace(/asc/gi,"").replace(/ /gi,"").split(",")),i._keyFields=[],u=0;u<i._allFields.length;u++)f=i._allFields[u],f.IsPrimaryKey&&(Array.add(i._keyFields,f),n.ViewPage.Order.indexOf(f.Name)<=-1&&Array.add(i._orderFields,f.Name));r.Scripts&&i.addExternalScripts($func.resolveClientText(r.Scripts,i._baseUrl));r.Css&&i.addExternalCascadingStyleSheets($func.resolveClientText(r.Css,i._baseUrl));n.Showing&&i.excuteScript(n.Showing);n.LoadScript&&(i._loadScript=n.LoadScript);n.ScatterScript&&(i._scatterScript=n.ScatterScript);n.RenderScript&&(i._renderScript=n.RenderScript);n.CheckScript&&(i._checkScript=n.CheckScript);n.CloseScript&&(i._closeScript=n.CloseScript);i._alterTitle&&(i._saveTitle=i._title,i._saveSubTitle=i._subTitle)}for(i._alterTitle&&(i._saveTitle||i._saveSubTitle)&&(a=i._alterTitle[0],v=i._alterTitle[1],a&&(i._title=$func.alter(i._saveTitle,a)),v&&(i._subTitle=String.format('<div class="InfoFilterText"><span class="Information">&nbsp;<\/span>{0}',$func.alter(i._saveSubTitle,v)),i._showInfoFilter=!0)),i._rows=n.Rows,i._rowCount=i._rows.length,i._gridPageIndex<0?(i._gridPageIndex=0,i._gridFirstPageButtonIndex=0,i._gridTotalRowCount=n.TotalRowCount,n.Repetition&&(i.g$r=n.Repetition),n.Aggregation&&(i.g$a=n.Aggregation),i._gridPageCount=i._gridPageSize==0?0:Math.floor(i._gridTotalRowCount/i._gridPageSize),i._gridTotalRowCount%i._gridPageSize!=0&&i._gridPageCount++):i._gridRefresh&&(i._gridTotalRowCount=n.TotalRowCount,n.Repetition&&(i.g$r=n.Repetition),n.Aggregation&&(i.g$a=n.Aggregation),i._gridPageCount=Math.floor(i._gridTotalRowCount/i._gridPageSize),i._gridTotalRowCount%i._gridPageSize!=0&&i._gridPageCount++),u=0;u<i._fields.length;u++)f=i._fields[u],f.AllowFilter&&(i.f$p||(i.f$p=!0),t!=0||f.Type!="String"||f.FilterPanelReference||(f.FilterPanelReference=8),f._listOfValues=o),f.Name=="Hash"&&(i._hashIndex=u);i._rowCount>0&&(i._lastPageIndex=i._gridPageIndex,i._firstPageItem=i._getOrderString(0),i._lastPageItem=i._getOrderString(i._rowCount-1),i._firstPageValue=i._getOrderValue(0),i._lastPageValue=i._getOrderValue(i._rowCount-1));i._lastRowCount=i._gridTotalRowCount;i._renderScript&&i.excuteScript(i._renderScript);i._render(t);i._scatterScript&&i.excuteScript(i._scatterScript);i._clone&&(i.raiseGridEvent("Copying"),i._clone=o);i._replication&&(i._replication=o);i._gridRefresh=!1;i._autoAppearance&&!i._scrutinize&&$func.getUrlParameter("query")&&!$func.getUrlParameter("d")&&i._type=="Voucher"&&i.get_executeButton("View")&&i._rowCount==1&&(i._enter(i._getItem(1,i._firstColumnFocus())),i.executeCommand({commandName:"View",commandArgument:"0"}),i._scrutinize=!0)}},_onMethodFailed:function(n,t){t!=-2&&(this._busy(!1),$func.hideWait(this.get_id(),this._container),$message.showError(n))},_busy:function(n){this._isBusy=n,$func.enableButtons(!n)},_render:function(n){var t=this,r,i,u;t.s$f&&t._memvars&&t._memvars.length&&(t.s$f=!1);t._activeCell&&$func.detachControlBehavior(t._activeCell);r=null;i=new Sys.StringBuilder;$render.renderTitle(i,t._title,t._getInfoBar(),t._showInfoFilter);$render.renderToolbar(i,t.get_id(),t._toolbar,t._gridTitle,t._gridPageCount,t._gridTotalRowCount,t._gridFirstPageButtonIndex,t._buttonIndex,t._gridPageIndex,t._gridPageSize,t._language,t._resources,"Green");t._getHeight();u=t._childObject?t.get_element().parentForm._id:"";$render.renderGrid(i,t._rows,t._fields,t._readOnly,t.get_id(),t._language,t._height,t._filter,t._resources,t._sortExpression,t._childObject,u,t.f$p,t.s$f,t.g$r,t.g$a,t.g$t);t._container.innerHTML=i.toString();t._attachBehaviors(r);n==0&&t._loadScript&&(t.excuteScript(t._loadScript),t._loadScript=null);t._onRender()},_onRender:function(){var n=new FastBusiness.AjaxControlExtender.RenderEventArgs(this,"Updated");this.raiseOnRender(n)},_getHeight:function(){var n=this,i=30,r,t;n.f$p&&(i=60),n.g$r&&n.g$r.length&&(i+=n.g$r.length*22+1),n.g$a&&(i+=10),r=n.get_element(),n._anchor?(t=n._divHeight+$common.getClientBounds().height-n._clientHeight,(n._title&&n._title.length>0||n._getInfoBar()&&n._getInfoBar().length>0)&&(t-=48),(n._toolbar&&n._toolbar.length>0||n._gridPageSize>0)&&(t-=26),t-=30,t-=i,t>0&&(n._height=t)):n._height=(n._fixedHeight?n._fixedHeight:$common.getBounds(r).height)-i},_setHeight:function(){var n=this.get_element();this._divMaster=$get("mpMainBody"),this._clientHeight=$common.getClientBounds().height,this._divMaster&&(this._mpHeight=$common.getBounds(this._divMaster).height),n.style.height?this._divHeight=$common.getBounds(n).height:this._divMaster?(this._divHeight=this._mpHeight-2,$func.isIE||(this._divHeight-=1)):(this._divHeight=this._clientHeight-126,$func.isIE||$func.isOpr||(this._divHeight-=5)),this._offsetHeight&&(this._divHeight-=this._offsetHeight)},_getWidth:function(){var t=this.get_element(),n;this._setWidth&&this._anchor&&(n=this._divWidth+$common.getClientBounds().width-this._clientWidth,n>0&&(this._width=n))},_setWidth:function(){var n=this.get_element();n.style.width&&(this._divWidth=$common.getBounds(n).width,this._clientWidth=$common.getClientBounds().width,this._setWidth=!0)},_getHeader:function(n){return this._gridHeaderBody.childNodes[0].childNodes[n]},_getHeaderItem:function(n){return $get(String.format("{0}_HeaderText_{1}",this.get_id(),this._fields[n-1].Name))},_getHeaderItemText:function(n){return $func.getInnerText(this._getHeaderItem(n))},_setHeaderItemText:function(n,t){var i=this._getHeaderItem(n);if($func.setInnerText(i,t),i.headerCaption){i.headerCaption=t;try{$func.changeHeaderCaption(i)}catch(r){}}},_getFooter:function(n){return this._gridFooterBody?this._gridFooterBody.childNodes[0].childNodes[n]:null},_getItem:function(n,t){return $func.findBoundControl(this._gridTableBody.childNodes[n-1].childNodes[t].childNodes[0])},_getItemText:function(n,t){return this._getItem(n,t).value},_setItemText:function(n,t,i){this._getItem(n,t).value=i},_getItemValue:function(n,t,i){var u,r;return(t==null&&(u=$func.getLocationCell(n),n=u[0],t=u[1]),r=this._fields[t-1],r.Type=="Boolean")?this._getItem(n,t).checked:r.DataFormatString=="X"?this._getItem(n,t).value.toUpperCase().replace(/\s+$/,""):r.Type=="String"?this._getItem(n,t).value.replace(/\s+$/,""):$func.stringToValue(this._getItem(n,t).value,r,i)},_setItemValue:function(n,t,i,r){var u=this._fields[t-1],f;u.Type=="Boolean"&&(this._getItem(n,t).checked=i),f=this._getItem(n,t),f.value=$func.valueToString(u.Type=="DateTime"&&i&&i.z?i.z:i,u,r?r:!0),$func.handleObject(f,u,this._fields,n,t)},_findItem:function(n,t){var i=this._getColumnOrder(t);return i>-1?this._getItem(n,i):null},_findItemValue:function(n,t){var i=this._getColumnOrder(t);return i>-1?this._getItemValue(n,i):null},_setActiveCell:function(n){this._activeCell&&(this._lastCell=this._activeCell);var t=$func.getLocationCell(n);this._activeCell=n,this._activeRow=t[0],this._activeColumn=t[1],n.field||(n.column=this._activeColumn,n.field=this._fields[this._activeColumn-1]),n.row=this._activeRow,n._lastValue=this._getItemValue(n)},_getItemHandleKey:function(n,t){return this._fields[t-1].HandleKey&&this._fields[t-1].HandleKey.length>0&&!$func.getObjectWhen(this._getItem(n,t))},_saveHeaderWidth:function(n,t){this._obj=n,this._i=parseInt(n.id.replace(String.format("{0}_gridCell_$%r.",this.get_id()),"")),this._x=t,this._w=$common.getBounds(n).width},_getColumnOrder:function(n){n=$func.dataFieldName(n,this._language);var t=$func.findOrder(n,this._fields);return t>=0?t+1:-1},_getColumnWidth:function(n){return this._fields[n-1].Width},_setColumnWidth:function(n,t){var i,r;this._getColumnWidth(n)!=t&&(i=this._getHeader(n),i&&(r=this._fields[n-1],$func.setHeaderWidth(r,this._gridHeader,this._gridTable,this._divFooter,i,n,t),r.Width=t))},_firstColumnFocus:function(){var n=this._fields.length;for(c=1;c<n&&!this._fields[c-1].Visible;)c+=1;return c},_getColumnVisible:function(n){return this._fields[n-1].Visible},_setColumnVisible:function(n,t){var i=this,f,u,r;if(i._getColumnVisible(n)!=t){for(!t&&i._activeCell&&i._activeColumn==n&&$func.hideImageActiveCell(i._activeCell),f=i._getFooter(n),u=i._gridHeaderBody.childNodes,r=0;r<u.length;r++)$func.setVisible(u[r].childNodes[n],t);for(u=i._gridTableBody.childNodes,r=0;r<u.length;r++)$func.setVisible(u[r].childNodes[n],t);f&&$func.setVisible(f,t),i._suspend||$func.layoutGrid(i._divHeader,i._divGrid,!0,i._rowCount,i._divFooter),i._fields[n-1].Visible=t}},_suspendLayout:function(){this._suspend=!0},_resumeLayout:function(){this._suspend=null,$func.layoutGrid(this._divHeader,this._divGrid,!0,this._rowCount,this._divFooter)},_getColumnInactivate:function(n){var t=this._fields[n-1];return t.Type=="Boolean"&&this._getColumnReadOnly(n)?!0:t.Inactivate||!t.Visible},_getColumnEditable:function(n){return!this._getColumnReadOnly(n)&&this._allowEdit},_getColumnReadOnly:function(n){var t=this._fields[n-1];return this._readOnly||t.ReadOnly},_setColumnReadOnly:function(n,t,i){var r;if(this._getColumnReadOnly(n)!=t&&(!i||!this._fields[n-1].ReadOnly||t)){if(this._fields[n-1].Type=="Boolean")for(r=0;r<this._rowCount;r++)this._getItem(r+1,n).disabled=t;else{if($func.isIF)for(r=0;r<this._rowCount;r++)this._getItem(r+1,n).readOnly=t;if(this._activeCell&&this._activeColumn==n&&this._activeCell._controlBehavior)if(this._activeCell._controlBehavior._changeReadOnly(t),t)try{$func.hideImageActiveCell(this._activeCell)}catch(u){}else try{$func.showImageActiveCell(this._activeCell)}catch(u){}}i||(this._fields[n-1].ReadOnly=t)}},_changeReadOnly:function(n){if(this._readOnly!=n){for(var t=0;t<this._columnCount;t++)this._setColumnReadOnly(t+1,n,!0);this._readOnly=n}},_getColumnFormat:function(n){return this._fields[n-1].DataFormatString},_setColumnFormat:function(n,t){var r,i;if(this._getColumnFormat(n)!=t){for(r=$func.scaleLength(t),this._fields[n-1].DataFormatString=t,i=0;i<this._rowCount;i++)this._setItemValue(i+1,n,$func.round(this._getItemValue(i+1,n),r));this._activeCell&&this._activeColumn==n&&this._activeCell._controlBehavior&&this._activeCell._controlBehavior.set_format(t)}},_getOrderString:function(n){for(var r=this._rows[n],u="",t,i=0;i<this._orderFields.length;i++)t=$func.findField(this._orderFields[i],this._fields),t&&(u+=t.Type=="DateTime"?$func.formatDateOrder(r[t.Index]):r[t.Index].toString());return u},_getOrderValue:function(n){var t=this,i;if(t._type&&t._type!="Dir")return null;var f=t._rows[n],r=[],u="",e,o;for(t._sortExpression&&(u=t._sortExpression.replace(/ (asc|desc)/,""),t._addOrderValue(r,f,u,"")),i=0;i<t._orderFields.length;i++)t._addOrderValue(r,f,t._orderFields[i],u);return r},_addOrderValue:function(n,t,i,r){var u=$func.findField(i,this._fields);u&&u.Name!=r&&(o=t[u.Index],o&&u.Type=="DateTime"&&(o=new Date(o.getTime()),o.setMinutes(o.getMinutes()-o.getTimezoneOffset())),Array.add(n,o))},_getRowKey:function(n){for(var u=this._rows[n],t="",r,i=0;i<this._keyFields.length;i++)r=this._keyFields[i],t.length>0&&(t+=","),t+=u[r.Index].toString();return t},_getPrimaryKeyValues:function(n){var r=[],i,t,u;if(this._hashValue=null,this._rowSelected()){for(i=n?n:this._activeRow,t=0;t<this._keyFields.length;t++)u=this._keyFields[t],Array.add(r,this._getItemValue(i,$func.findOrder(u.Name,this._fields)+1));this._hashIndex>=0&&(this._hashValue=String.format("$_{0}",this._getItemValue(i,this._hashIndex+1)))}return r},_currentRow:function(){return this._activeCell?this._getRow(this._activeRow):[]},_getRow:function(n,t){for(var u=[],i,r=0;r<this._fields.length;r++)i=this._fields[r],t&&i.Type=="String"&&i.External&&!i.AllowContain?Array.add(u,""):Array.add(u,this._getItemValue(n,r+1));return u},_setRow:function(n,t){for(var i=0;i<this._fields.length;i++)this._setItemValue(n,i+1,t[i],!0)},get_allowAppend:function(){return this.get_autoExpansion()&&this.get_allowNew()&&this.get_executeButton("Insert")},_insertRow:function(n){return this.get_allowNew()?this.raiseGridEvent("BeforeInsertRow",n)?(this._appendRow(),this.raiseGridEvent("AfterInsertRow",n),!0):!1:!1},_appendRow:function(n,t){var i=this,r,u;i._rowCount==0&&i._divFooter&&(i._divFooter.scrollLeft=0);i._rowCount+=1;r=$render.createRowBlank(i._currentRow(),i._rowCount,i._fields,i.get_id(),i._language,i._readOnly,i._rowCount-1,n,i._childObject,i.g$t);i._rowCount>1&&(u=i._gridTableBody.childNodes[i._rowCount-2],Sys.UI.DomElement.removeCssClass(u,"RowBottom"),$func.highlightItem(u,i._fixedColumns,3));i._fixedColumns>0&&$func.layoutPosition(i._gridTableBody,r,i._rowCount-1,i._fields,i._fixedColumns,!0);i._gridTableBody.appendChild(r);$func.layoutRow(i._gridHeaderBody,i._gridTableBody,i._fixedColumns);t||$func.gridFocus(i.get_id(),i._fields,i._rowCount,i._firstColumnFocus(),0,null,null,i)},_insertFirstRow:function(){this.get_allowNew()&&this._rowCount==0&&this._appendRow(null,!0)},_validRowBehavior:function(n){for(var r,u,t,f,e,i=0;i<this._fields.length;i++)if(r=this._getItem(n,i+1),u=this._fields[i],(r.addControl||r.label)&&u.ItemStyle=="AutoComplete"&&(t=u.ItemReference,t&&t.length>0&&(f=$func.findOrder(t,this._fields),f>-1&&(e=this._getItem(n,f+1),e&&!e.checked))))return!1;return!0},_moveRow:function(n,t){var u,f,i,r;if(!this._validRowBehavior(n)||!this._validRowBehavior(t))return!1;if(this.raiseGridEvent("BeforeMoveRow",[n,t])){for(u=this._getRow(t),f=this._getRow(n),this._setRow(t,f),this._setRow(n,u),i=0;i<this._fields.length;i++)if(r=this._fields[i],r.HandleKey&&r.HandleKey.length>0){var e=this._getItem(n,i+1),o=this._getItem(t,i+1),s=$func.getObjectWhen(e);$func.setObjectWhen(e,$func.getObjectWhen(o)),$func.setObjectWhen(o,s)}return this.raiseGridEvent("AfterMoveRow",[n,t]),!0}},_rowSelected:function(){return this._activeCell&&this._activeRow&&this._activeRow>0},_removeRow:function(){if(this.get_allowDelete()&&this._rowSelected()){if(this._confirmDelete){$message.show(this._getResources("Message.ConfirmDelete"),0,String.format("$find('{0}')._deleteRow();",this.get_id()),String.format("$find('{0}')._activeCell.focus();",this.get_id()));return}this._deleteRow()}},_deleteRow:function(n){if(this._rowSelected()){if(!this.raiseGridEvent("BeforeRemoveRow")){this._activeCell.focus();return}this._removeRowNumber(this._activeRow,n),this.raiseGridEvent("AfterRemoveRow")}},_removeRowNumber:function(n,t){var r,i;n<=0||(r=this._gridTableBody.childNodes[n-1],$func.beforeRemoveRow(this._gridTableBody,this.get_id(),this._activeCell,this._activeRow,n,this._fields,this._fixedColumns,this._childObject),r&&(this._inactivateRow(n),this._gridTableBody.removeChild(r),this._rowCount-=1),this._rowCount==0&&(i=this._divFooter.scrollLeft,this._scrollLeft=i,this._changePosition(1,i),this._divGrid.scrollLeft=i,this._divHeader.scrollLeft=i),this._afterRemoveRow(n,t))},_detachRow:function(n){var i=$get(n),t;i&&(t=$func.getLocationCell(i),this._activeRow==t[0]&&this._activeColumn==t[1]&&this._deleteRow(!0))},_afterRemoveRow:function(n,t){var u=this.get_id(),r=this._firstColumnFocus(),i=this._rowCount,f;if(t&&i>0){f=this._getItem(i,r),this._enter(f);return}n<=i?$func.gridFocus(u,this._fields,n,r):i>0?$func.gridFocus(u,this._fields,1,r):i==0&&this._clear(null,!0)},_inactivateRow:function(n){try{this._gridTableBody.childNodes[n-1].childNodes[0].childNodes[0].focus()}catch(t){}},_attachBehaviors:function(n){var t=this,i;this._detachBehaviors(),i=t.get_id(),t._divGrid=$get(i+"_divGrid"),t._divHeader=$get(i+"_divHeader"),t._gridTable=$get(i+"_gridTable"),t._gridHeader=$get(i+"_gridHeader"),t._divFooter=$get(i+"_divFooter"),t._gridFooter=$get(i+"_gridFooter"),t._gridTableBody=t._gridTable.getElementsByTagName("tbody")[0],t._gridHeaderBody=t._gridHeader.getElementsByTagName("tbody")[0],t._gridFooterBody=t._gridFooter.getElementsByTagName("tbody")[0],$addHandler(t._divGrid,"scroll",t._scrollDelegate),$addHandler(t._divGrid,"resize",t._resizeDelegate),$addHandler(t._divHeader,"scroll",t._scrollHeader),t._divFooter&&($addHandler(t._divFooter,"scroll",t._scrollFooter),$addHandler(t._divFooter,"resize",t._resizeFooter)),$func.A03(t.f$p,t._resources,t._language,t._fields,t._headerDropDownOnShowingHandler,i,t._container,t._fixedColumns,t.s$f),t._childObject&&$func.changeGridCaption(t._gridHeaderBody,t._fields,n),t._initFirstRow&&t._insertFirstRow(),t._changePosition(0),t._fixedColumns>0&&t.A07(t._fixedColumns),t._attachToolbarBehaviors()},_detachBehaviors:function(){var n=this;n._detachToolbarBehaviors(),$func.A04(n._fields,n._headerDropDownOnShowingHandler),n._divGrid&&$removeHandler(n._divGrid,"scroll",n._scrollDelegate),n._divGrid&&$removeHandler(n._divGrid,"resize",n._resizeDelegate),n._divHeader&&$removeHandler(n._divHeader,"scroll",n._scrollHeader),n._divFooter&&($removeHandler(n._divFooter,"scroll",n._scrollFooter),$removeHandler(n._divFooter,"resize",n._resizeFooter)),n._activeCell&&$func.detachControlBehavior(n._activeCell),n._clear(null,!0)},_attachToolbarBehaviors:function(){var b=this,m=null,j=b.get_id(),s=-4,y=4,v=-1;if($func.isOpr||$func.isFF&&Sys.Browser.version>=3||!$func.isIE)s=0;for(var k=0;k<b._toolbar.length;k++){var f=b._toolbar[k];if(f.length>2){var c=f[0],p=f[2],u=$get(j+"_ToolbarButton_"+c);if(u){var g=f._panel=document.createElement("div");g.id=j+"_ToolbarGroupPanel"+c;Sys.UI.DomElement.setVisible(g,false);b.get_element().appendChild(g);g.className="MenuExtenderContextPanel MenuExtenderContextBarPanel";var n=[],o=[],x=c=="Print",i=new Sys.StringBuilder;if(x){if(b._hiddenForms)for(var h=b._hiddenForms,d=0;d<h.length;d++)h[d].Value&&Array.addRange(n,h[d].Form);if(b._disableForms)for(var h=b._disableForms,d=0;d<h.length;d++)h[d].Value&&Array.addRange(o,h[d].Form)}for(var e=0;e<p.length;e++){var a=p[e];a.Hidden=Array.contains(n,e);if(a.Hidden)continue;if(c==m||c.length==0||a.CommandName=="-")i.append('<div class="ContextMenuExtenderBreak"></div>');else if(!a.MenuItems){var r=a.UrlImage?String.format("style=\"background-image:url('{0}');\"",a.UrlImage):"";a.Interrupted=Array.contains(o,e);if(a.Disabled||a.Interrupted)i.append(String.format('<a {3} class="MenuExtenderContextItemDisabled {1}"><div class="Title">{0}</div><div class="Description">{2}</div></a>',a.CommandName,c,"",r));else i.append(String.format('<a href="#" onclick="$find(\'{0}\').executeCommand({{commandName:\'{4}\',commandArgument:\'{8}\',CommandIndex:{1}}});return false;" {7} class="MenuExtenderContextItem {4}"><div class="Title">{3}</div><div class="Description">{5}</div></a>',j,e,k,a.CommandName,c,"",f.Scope,r,a.Target))}else{v+=1;if(!b._toolbar.MenuItems)b._toolbar.MenuItems=[];Array.add(b._toolbar.MenuItems,a.MenuItems);i.append(String.format('<a href="#" onclick="$find(\'{0}\').activateToolbarItem(\'{0}\',{1},\'{2}\');return false;" class="MenuExtenderGroupItem {3}"><div id="{0}_ItemGroup{1}" class="Title">{4}</div></a>',j,v,c,a.CssClass,a.CommandName,c));if(x)for(var l=0;l<a.MenuItems.length;l++){var t=a.MenuItems[l],q=parseFloat(String.format("{0}.{1}",e,l));t.Hidden=Array.contains(n,q);t.Interrupted=Array.contains(o,q)}}}g.innerHTML=i.toString();var w=f._popupBehavior=$create(FastBusiness.AjaxControlExtender.PopupControlBehavior,{id:b.get_id()+"_ToolbarGroupPopup"+c,PopupControlID:g.id,Position:AjaxControlToolkit.PopupControlPopupPosition.Bottom,OffsetY:y,OffsetX:s},m,m,u);w.hidePopup();w._popupBehavior.add_showing(b._groupOnShowingHandler)}}}},_detachToolbarBehaviors:function(){for(var n,t=0;t<this._toolbar.length;t++)n=this._toolbar[t],n._popupBehavior&&(n._popupBehavior._popupBehavior.remove_showing(this._groupOnShowingHandler),n._popupBehavior.dispose(),n._popupBehavior=null,n._panel.parentNode.removeChild(n._panel),n._panel=null)},_groupOnShowing:function(){this.disposeToolbarInstance()},activateToolbarItem:function(t,f,s){var e=this,k=null;e.deactivateToolbarItem(f);var l=e.get_id(),n=e._toolbar.MenuItems[f],p=$get(String.format("{0}_ItemGroup{1}",t,f));if(p){var c=document.createElement("div");c.id=String.format("{0}_ItemGroupPanel{1}",l,f);Sys.UI.DomElement.setVisible(c,true);e.get_element().appendChild(c);c.className="MenuExtenderContextPanel MenuExtenderContextBarPanel";for(var i=new Sys.StringBuilder,j=0;j<n.length;j++){var b=n[j],h=b.CommandName;if(b.Hidden)continue;if(h==k||h.length==0||h=="-")i.append('<div class="ContextMenuExtenderBreak"></div>');else{var o=b.UrlImage?String.format("style=\"background-image:url('{0}');\"",b.UrlImage):"";if(b.Disabled||b.Interrupted)i.append(String.format('<a {2} class="MenuExtenderContextItemDisabled"><div class="Title">{0}</div><div class="Description">{1}</div></a>',h,"",o));else i.append(String.format('<a href="#" onclick="$find(\'{0}\').executeCommand({{commandName:\'{1}\',commandArgument:\'{2}\',CommandIndex:{3}}});return false;" {4} class="MenuExtenderContextItem {1}"><div class="Title">{5}</div><div class="Description">{6}</div></a>',l,s,b.Target,j,o,h,""))}}c.innerHTML=i.toString();var g=e._toolbarInstance=$create(FastBusiness.AjaxControlExtender.PopupControlBehavior,{id:String.format("{0}_ItemGroupPopup{1}",l,f),PopupControlID:c.id,Position:AjaxControlToolkit.PopupControlPopupPosition.Right,OffsetY:-4,OffsetX:16},k,k,p);e._toolbarInstance._panel=c;AjaxControlToolkit.PopupControlBehavior.callBaseMethod(g,"populate");var d=g._popupBehavior,r=g._getTopOffset();d.set_x(g._getLeftOffset());d.set_y(r);d.show();var m=$common.getClientBounds(),a=d.getBounds();m.width<a.x+a.width&&d.set_x(-a.width-32);var q=m.height-a.y-a.height;if(q<30)if(m.height>a.height+a.x+150)d.set_y(-a.height+11);else d.set_y(r+q-25);g._popupVisible=true}},deactivateToolbarItem:function(){this.disposeToolbarInstance()},disposeToolbarInstance:function(){this._toolbarInstance&&(this._toolbarInstance._panel.parentNode.removeChild(this._toolbarInstance._panel),this._toolbarInstance._panel=null,this._toolbarInstance.dispose(),this._toolbarInstance=null)},_mouseMove:function(n){var r,t,i;this._obj&&(r=n.clientX,t=r-this._x+this._w,t>=30&&(i=this._fields[this._i-1],$func.setHeaderWidth(i,this._gridHeader,this._gridTable,this._divFooter,this._obj,this._i,t),i.Width=t),$func.clearEvent(n))},_mouseUp:function(){this._obj&&(this._activeCell&&this._activeColumn==this._i&&$func.showImageActiveCell(this._activeCell),this._obj=null)},_adjustPosition:function(){$func.isIF||($func.layoutGrid(this._divHeader,this._divGrid,!0,this._rowCount,this._divFooter),this._changePosition(1))},_changePosition:function(n,t){var i=this;if(i._fixedColumns>0)if(n==-1)i._fixedLength=$func.changePosition(i.f$p,i.g$r,i._gridHeaderBody,i._gridTableBody,i._fields,i._fixedColumns,0,0,!1),i._divGrid.style.paddingLeft=i._fixedLength+"px",i._divHeader.style.paddingLeft=i._fixedLength+"px",i._scrollLeft=null;else if(n==0)i._fixedLength=$func.changePosition(i.f$p,i.g$r,i._gridHeaderBody,i._gridTableBody,i._fields,i._fixedColumns,0,0,!0),i._divGrid.style.paddingLeft=i._fixedLength+"px",i._divHeader.style.paddingLeft=i._fixedLength+"px";else if(n==1){if(i._scrollLeft&&i._scrollLeft==i._divGrid.scrollLeft)return;i._scrollLeft=i._divGrid.scrollLeft,$func.changeLocation(i.f$p,i.g$r,i.get_id(),i._gridHeaderBody,i._gridTableBody,i._fields,i._fixedColumns,i._fixedLength,t)}},A07:function(n){var f=this._divFooter.firstChild.firstChild.firstChild,h=f.childElementCount,e="AggregationParentCell",o="AggregationIndexCell",s="AggregationDefaultCell",r;for(n>0&&(f._lastFixedColumns=n),r=0;r<h;r++)if((!(n>0)||!(r>n))&&(!f._lastFixedColumns||n!=0||!(r>f._lastFixedColumns))){var t=f.childNodes[r],i=t.childNodes[0],u=t.style;r?n?(u.minWidth=$func.measurementToNumber(u.width)+8+"px",i.style.position="fixed",Sys.UI.DomElement.addCssClass(i,s),i.style.marginTop=$func.isCr&&!/Edge/.test(navigator.userAgent)?"-11px":"-12px"):(u.minWidth=i.style.position=i.style.marginTop=null,Sys.UI.DomElement.removeCssClass(i,s)):n?(Sys.UI.DomElement.addCssClass(t,e),Sys.UI.DomElement.addCssClass(i,o),t._styleWidth=u.width,u.width=$func.measurementToNumber(t._styleWidth)-1+"px"):(Sys.UI.DomElement.removeCssClass(i,o),Sys.UI.DomElement.removeCssClass(t,e),t._styleWidth&&(u.width=t._styleWidth))}},_highlightItem:function(n,t){$func.highlightItem(n,this._fixedColumns,t)},_focusWhenTabChanged:function(){if(this._changePosition(1),this._activeCell&&this._getColumnVisible(this._activeColumn)){try{this._activeCell.focus()}catch(n){}return}this._rowCount>0&&$func.gridFocus(this.get_id(),this._fields,1,this._firstColumnFocus(),0)},_onScroll:function(){this._gridHeader._onResize||($func.layoutGrid(this._divHeader,this._divGrid,!0,this._rowCount,this._divFooter),this._changePosition(1),this._divFooter&&(this._divFooter.scrollLeft=this._divGrid.scrollLeft))},_whenResize:function(){this._gridHeader._onResize||($func.layoutGrid(this._divHeader,this._divGrid,!0,this._rowCount,this._divFooter),this._rowCount==0&&this._fixedColumns>0&&this._divFooter&&(this._divFooter.scrollLeft=0),this._changePosition(1))},_headerScroll:function(){var n=this,t;n._divHeader&&n._divGrid&&n._divFooter&&(t=n._divHeader.scrollLeft,n._whenScroll(t,1),n._divFooter.scrollLeft=t)},_footerScroll:function(){var n=this,t;if(!n._gridHeader._onResize&&n._divGrid&&n._divFooter){if(t=n._divFooter.scrollLeft,n._rowCount==0){n._whenScroll(t,1),n._divHeader.scrollLeft=t;return}n._whenScroll(t)}},_whenScroll:function(n,t){var i=this;i._scrollLeft=n,i._changePosition(1,n),i._divGrid.scrollLeft=n,t||$func.layoutGrid(i._divHeader,i._divGrid,!0,i._rowCount,i._divFooter)},_footerResize:function(){},_onResize:function(){if($func.layoutGrid(this._divHeader,this._divGrid,!0,this._rowCount,this._divFooter),this._divGrid){if(this._anchor&&(this._getHeight(),this._setWidth&&this._getWidth(),this._height>0&&(this._divGrid.style.height=this._height+"px"),this._width>0&&this._setWidth&&(this.get_element().style.width=this._width+"px")),this._footerAdjustment&&this._divMaster)try{this._divMaster.style.height=this._mpHeight+$common.getClientBounds().height-this._clientHeight+"px"}catch(n){}$func.isOpr&&this._changePosition(1)}this._adjustResize()},_resizeVertical:function(){this._getHeight(),this._height>0&&(this._divGrid.style.height=this._height+"px")},_adjustResize:function(){$func.isFF&&this._rowCount==0&&this._fixedColumns>0&&(this._divFooter.scrollLeft=0)},_activeElement:function(n){n&&n.target&&(document.activeElement=n.target==document?null:n.target)},_click:function(n){$func.itemClick(n,this._fields)},_focus:function(n){this._enter(n)},_blur:function(n){var t,i;if(n.live=null,n.shift&&(window.setTimeout(String.format("try {0}$find('{1}')._sendStream('{2}');{3} catch (ex) {0}{3}","{",this.get_id(),n.id,"}"),250),n.shift=null),(!$func.isOpr||n.disabled)&&($func.isOpr||n._handleBlur)||this._leave(n),n._handleBlur=!0,document.activeElement!=n){t=null;try{n._currentValue=this._getItemValue(n)}catch(r){t=!0}if(t)return;n._currentValue!=n._lastValue&&(n.field&&n.field.ItemStyle=="Numeric"&&$func.fireChanged(n),i=new FastBusiness.AjaxControlExtender.ColumnEventArgs(n),this.raiseItemValueChanged(i),$func.isOpr?window.setTimeout(String.format("try {0}var o=$get('{1}');o._lastValue=o._currentValue;{2} catch (ex) {0}{2}","{",n.id,"}"),1):n._lastValue=n._currentValue)}},_sendStream:function(n){var i=$get(n),t;i&&(t=this.get_element().parentForm,t._preparing&&(t._streamMessage=String.format("$find('{0}')._detachRow('{1}');",this.get_id(),i.id)))},_enter:function(n){var t,i;if(n.live=!0,n._handleBlur=null,n.stopKeypress=null,n.grid||(n.grid=this),this._lastKey=null,$func.focusOnHold(n,this._handleFocusOnHold,this._handleFocus,this._activeCell)){this._handleFocusOnHold=null,this._handleFocus=null;return}this._activeCell&&n==this._activeCell||(n._varied=null,$func.selectCell(n,this._activeCell,this._divHeader,this._divGrid),$func.isIO&&$func.addKeyHandler(n,this._keypressdown,this._keypressHandler,this._keypressup),t={Row:this._activeRow,Column:this._activeColumn},this._setActiveCell(n),i={Row:this._activeRow,Column:this._activeColumn},this.raiseGridEvent("RowColChange",{Active:i,Previous:t}),this._getColumnEditable(this._activeColumn)&&$func.addControlBehavior(n,this.get_id(),this._fields,this._divHeader,this._divGrid,this._cookie,this._language,this._serviceLookup,this._baseUrl,this.get_dirService(),this.get_dirMethod()),$func.isIO||$func.addKeyHandler(n,this._keypressdown,this._keypressHandler,this._keypressup),this._lastCell&&this._clear(this._lastCell),this._fixedColumns>0&&$func.changeScrollLeft(n,this.get_id(),this._activeColumn,this._divGrid,this._fields,this._fixedColumns,this._fixedLength))},_clear:function(n,t){n&&($func.isIO||$func.removeKeyHandler(n,this._keypressdown,this._keypressHandler,this._keypressup),$func.detachControlBehavior(n)),t&&(this._activeCell=null,this._activeRow=-1,this._activeColumn=-1)},_imgFocus:function(n){if($func.focusOnHold(n,this._handleFocusOnHold,this._handleFocus,this._activeCell)){this._handleFocusOnHold=null,this._handleFocus=null;return}},_leave:function(n){(this._handleFocus=null,this._activeCell)&&$func.handleLeftRight(n,this._servicePath,this._getHandleComplete,this._getHandleFailed,this._lastKey,this.get_id(),this._activeCell,this._readOnly,this._fields)&&(this._handleFocusOnHold=!0)},_onGetHandleComplete:function(n,t){$func.handleComplete(n,t,this.get_id(),this._activeCell,this._activeRow,this._activeColumn,this._readOnly,this._fields)},_onGetHandleFailed:function(n,t,i){$func.handleLeave(i,this.get_id(),this._activeCell,this._activeRow,this._activeColumn,this._readOnly,this._fields)},_onKeyPress:function(n){var t=new FastBusiness.AjaxControlExtender.Key(n.ctrlKey,n.altKey,n.shiftKey,n.keyCode);$func.itemKeyPress(n,this._activeCell,this._activeRow,this._activeColumn,this._readOnly,this._fields,this.get_id(),t,this._servicePath,this._getHandleComplete,this._getHandleFailed)},_onKeyPressup:function(){},_onKeyPressdown:function(n){var t=this,i,e,u,f,r;if(t._activeCell){if(i=t._activeCell,i.HandleOnHold){$func.cancelEvent(n);return}if(t._lastKey=new FastBusiness.AjaxControlExtender.Key(n.ctrlKey,n.altKey,n.shiftKey,n.keyCode),i.shift&&(n.keyCode==9&&!n.shiftKey||n.ctrlKey&&n.keyCode==83)){e=n.keyCode==9,i.shift=null,$func.cancelEvent(n),t._deleteRow(!0),u=t.get_element(),f=u.parentForm,e?f._processKeyEvents(n,u,!0):f._onSave();return}n.ctrlKey||n.altKey||n.keyCode==16||(i.shift=null),r=$func.navigation(t.get_id(),t._fields,t._readOnly,t._lastKey,t._servicePath,t._getHandleComplete,t._getHandleFailed,i,n,t._activeRow,t._activeColumn),r==-1?(i._handleBlur=!0,t._leave(i)):r==1?t.executeCommand({commandName:t.get_executeButton("Insert")?"Insert":"New",commandArgument:"0"}):r==2?t.executeCommand({commandName:t.get_executeButton("Remove")?"Remove":"Delete",commandArgument:"0"}):r==3&&t.executeCommand({commandName:"Edit",commandArgument:"0"})}},_headerDropDownOnShowing:function(n){var i=this,u=n.get_id().match(/_HeaderDropDown(\d+)/),r=i._fields[Number.parseInvariant(u[1])];$render.A06(r,null,i.get_id(),i._fields,i._filter,i._language,i._resources,i.s$f),r._listOfValues||!r.AllowFilter||i.s$f?$func.A05(r,i.get_element(),i.s$f):i.A01(r)},_getInfoBar:function(){if(this.get_filter().length>0&&!$func.filterIsExternal(this._filter,this._externalFilter)){this._showInfoFilter=!0;var n=new Sys.StringBuilder;return n.append('<div class="InfoFilterText">'),$render.A02(n,this._fields,this._filter,this._externalFilter,this._language,this._resources),n.append("</div>"),n.toString()}return this._alterTitle||(this._showInfoFilter=!1),this._subTitle},A01:function(n){var t=this,u,i,f,e,r;if(result=[],(n.Type!="DateTime"||n.DataFormatString.indexOf("H")<0)&&(u=t._rows.length,u>0))for(i=0;i<u;i++){for(f=t._rows[i][n.Index],e=!0,r=0;r<result.length;r++)if($func.compareFieldValue(n,result[r],f)){e=!1;break}e&&Array.add(result,f)}n._listOfValues=result,result[result.length-1]==null&&(Array.insert(result,0,result[result.length-1]),Array.removeAt(result,result.length-1)),$render.A06(n,result,t.get_id(),t._fields,t._filter,t._language,t._resources,t.s$f),$func.A05(n,t.get_element(),t.s$f)},_bodyKeydown:function(n){this._customFilterField&&(n.keyCode==Sys.UI.Key.enter?this.applyCustomFilter(this._customFilterMode):n.keyCode==Sys.UI.Key.esc&&this.closeCustomFilter())},_formKeydown:function(){},_getResources:function(r){var _v=String.format("this._language == 'v' ? this._resources.{0}.v : this._resources.{0}.e",r);return eval(_v)},goToPage:function(n){var t=this;t._isBusy||(n>=0?(t.set_gridPageIndex(n),t._gridRefresh=!1):t._gridRefresh=!0,t._lastPageValue&&(t._gridPageValue=t._gridPageIndex>t._lastPageIndex?t._lastPageValue:t._firstPageValue),t._loadPage(1),t._gridPageValue=null)},showCustomFilter:function(n,t){for(var c,e,a,u,l,s,i=this,r=i.get_id(),o=i._fields[n],v=t?"Header":"Option",f=null,h=0;h<i._filter.length;h++)if(c=i._filter[h].match(/([\w\$]+):([\s\S]*)/),c[1]==o.Name){f=c[2];break}t&&o.Type!="String"&&(t=null);f&&f.indexOf('\0')==-1&&(f+='\0');e=i._customFilterPanel=document.createElement("div");a=$get(r+"_CustomFilter"+v+n);i._container.appendChild(e);e.className="CustomFilterDialog";e.id=r+"_CustomFilterPanel";u=new Sys.StringBuilder;u.append(String.format("<div>{0}<\/div>",String.format(i._getResources("HeaderFilter.CustomFilterPrompt"),i._title,o.HeaderText)));u.append('<table cellpadding="0" cellspacing="0">');u.append(String.format('<tr><td colspan="2"><input type="text" style="width:390px" id="{0}_Query" value="{1}"><\/input><\/td><\/tr>',r,f?$func.htmlAttributeEncode(f.replace(/\0/g,", ").replace(/\*|[^!<>]=|^=|, $/g,"")):""));u.append(String.format('<tr><td><\/td><td align="right"><button id="{0}Ok">'+i._getResources("ModalPopup.Ok")+'<\/button> <button id="{0}Cancel">'+i._getResources("ModalPopup.Cancel")+"<\/button><\/td><\/tr>",r));u.append("<\/table>");e.innerHTML=u.toString();i._customFilterField=o;i._customFilterMode=t;i._customFilterModalPopupBehavior=$create(AjaxControlToolkit.ModalPopupBehavior,{OkControlID:r+"Ok",CancelControlID:r+"Cancel",OnOkScript:String.format("$find('{0}').applyCustomFilter({1})",r,t?"1":""),OnCancelScript:String.format("$find('{0}').closeCustomFilter()",r),PopupControlID:e.id,DropShadow:!0,BackgroundCssClass:"ModalBackground"},null,null,a);l=$func.getLastIndex();i._customFilterModalPopupBehavior._backgroundElement.style.zIndex=l+1;i._customFilterModalPopupBehavior._foregroundElement.style.zIndex=l+2;i._customFilterModalPopupBehavior.show();s=$get(r+"_Query");s&&($func.attachContextMenu(s,i._language,!0),Web.Command.focus(s))},closeCustomFilter:function(){var n=this,t=$get(n.get_id()+"_Query");t&&$func.detachContextMenu(t,!0),n._customFilterModalPopupBehavior&&(n._customFilterModalPopupBehavior.dispose(),n._customFilterModalPopupBehavior=null,n._customFilterField=null,n._customFilterMode=null),n._customFilterPanel&&(n._customFilterPanel.parentNode.removeChild(n._customFilterPanel),n._customFilterPanel=null),n._activeCell&&n._activeCell.focus()},removeFromFilter:function(n){for(var t=0;t<this._filter.length;t++)if(this._filter[t].match(/^([\w\$]+):/)[1]==n.Name){Array.removeAt(this._filter,t);break}},applyCustomFilter:function(n,t,i){var r=this,f=r._customFilterField;r.removeFromFilter(f);var s=/\s*(=|!={0,1}|<={0,1}|<>{0,1}|>={0,1}|)\s*([\S\s]+?)\s*(,|$)/g,e=null,o=f.Name+":",u=i?t:$get(r.get_id()+"_Query").value,h=u;for(n&&u&&(u="*"+u);e=s.exec(u);)o+=(e[1]?e[1]:f.Type=="String"?"*":"=")+e[2]+"\x00";o.indexOf("\x00")>0&&Array.add(r._filter,o),i||(u&&(f.FilterPanelReference=n?8:10),f.FilterPanelValue=h),r.set_gridPageIndex(-2),r._loadPage(1),i||r.closeCustomFilter()},applyFilterByIndex:function(n,t){var i=t<0?this._fields[n]:this._fields[$func.findOrder(this._allFields[n].Name,this._fields)];this.applyFilter(i,t>=0?"=":null,t>=0?i._listOfValues[t]:null)},applyFilter:function(n,t,i,r){var u=this,f=n.Type=="DateTime";r||(t=="="&&(n.FilterPanelReference=1),n.FilterPanelValue=f?$func.valueToString(i,n,!0):n.Type=="Boolean"?i?"1":"0":i),t==null&&i==null&&(n.FilterPanelValue=""),u.removeFromFilter(n),t&&Array.add(u._filter,n.Name+":"+t+(r&&f||i=="0"?i:$func.valueToString(i,n,!0))),u.set_gridPageIndex(-2),u._loadPage(1)},applyExternalFilter:function(){var n,t;for(this._filter=[],n=0;n<this._externalFilter.length;n++)t=this._externalFilter[n],Array.add(this._filter,t.Name+":="+t.Value)},R0:function(n,t,i){var f=this,r,u,e,o;t.keyCode==13&&(r=n.value,u=f._fields[$func.findOrder(f._allFields[i].Name,f._fields)],u.FilterPanelValue=r,e=u.FilterPanelReference?u.FilterPanelReference:10,f._customFilterField=u,u.Type=="Boolean"&&(r=r=="1"?"true":r=="0"?"false":r),e==10?f.applyCustomFilter(!1,u.FilterPanelValue,!0):(e==8&&(r="*"+r),o=["=","<>","<",">","<=",">=","*","*","!*"][e-1],f.applyFilter(u,o,r,!0)),f._customFilterField=null)},R1:function(n,t){var s=this,u=s._fields[$func.findOrder(s._allFields[n].Name,s._fields)],d="FilterPanelBackground",w,b,y,g;if(t>10){s._customFilterField=u,u.FilterPanelReference=10;var a=u.DataFormatString.indexOf("H")>=0?1:0,e=null,c,h=new Date,l=h.getMonth(),f=h.getFullYear(),k,o,i,r="dd/MM",p=">= {0}, <"+(a?"":"=")+" {1}",v="/yyyy";switch(t){case 11:e=h.format(r),a&&(i=new Date(h),i.setDate(i.getDate()+1),i.getFullYear()!=f&&(r+=v),e=String.format(p,e,i.format(r)));break;case 12:w=h.getDay(),k=h.getDate()-w+(w==0?-6:1),o=new Date(h.setDate(k)),i=new Date(o),i.setDate(i.getDate()+6+a),c=o.getFullYear()==f?r:r+v,i.getFullYear()!=f&&(r+=v),e=String.format(p,o.format(c),i.format(r));break;case 13:o=new Date(f,l,1),i=new Date(f,l+1,a),c=i.getFullYear()==f?r:r+v,e=String.format(p,o.format(r),i.format(c));break;case 14:l=(Math.ceil((l+1)/3)-1)*3,o=new Date(f,l,1),i=new Date(f,l+3,a),c=i.getFullYear()==f?r:r+v,e=String.format(p,o.format(r),i.format(c));break;case 15:e=a?String.format(">= 01/01, < 01/01/{0}",f+1):">= 01/01, <= 31/12"}u.FilterPanelValue=e,s.applyCustomFilter(!1,u.FilterPanelValue,!0),s._customFilterField=null;return}b=u.FilterPanelReference?u.FilterPanelReference:10,b!=t&&(y=$get(String.format("{0}_FilterPanelButton{1}",s._id,u.Name)),y&&(u.FilterPanelReference=t,Sys.UI.DomElement.removeCssClass(y,d+b),Sys.UI.DomElement.addCssClass(y,d+t))),g=$get(String.format("{0}_FilterPanelText{1}",s._id,u.Name)),u._filterPanelBehavior.hidePopup(),g.focus()},sort:function(n){this._isBusy||(this.set_sortExpression(n),this.set_gridPageIndex(0),this._loadPage(1))},validExpression:function(n,t,i,r,u){var f=this.get_element().parentForm;t&&this.executeExpression(n,t),i&&this.executeAggregate(i),r&&f.executeExpression(r),u&&this.live(n,u)},executeExpression:function(n,t){for(var i=0;i<t.length;i++)this.assignExpression(n.row-1,$func.replace(t[i],"$","R"))},assignExpression:function(n,t){var f=t.split(":="),i=$func.trim(f[0]).replace("[","").replace("]",""),r=this.calcExpression(n,$func.trim(f[1])),u;r!=null&&(i.startsWith("R")?(i=$func.right(i,i.length-1),this.get_element().parentForm.setItemValue(i,r)):(u=this._getColumnOrder(i),u>0&&this._setItemValue(n+1,u,r)))},executeAggregate:function(n){for(var t,i,r=0;r<n.length;r++)t=n[r],i=null,t.length>2&&(i=t[2]),this.assignAggregate(t[0],t[1],i)},assignAggregate:function(n,t,i){this.get_element().parentForm.setItemValue(n,this.sum(t,i))},calcExpression:function(n,t,i){var c=this,f=null,l={Expression:t,Variables:f},u,s,h,o;for($func.initExpression(l),u=t,s=0;s<l.Variables.length;s++){var e=l.Variables[s],r=f,a=!1;if(e.Name.startsWith("R")){var v=c.get_element().parentForm,y=$func.right(e.Name,e.Name.length-1),h=v.getItem(y);h||y in v._vacant?r=v.getItemValue(y):a=!0}else h=c._getColumnOrder(e.Name),h>=0?r=c._getItemValue(n+1,h):a=!0;if(a){u=f;break}else String.isInstanceOfType(r)?r="'"+r.toString().replace("'","\\'")+"'":(r==f||Date.isInstanceOfType(r))&&(r=r?"(new Date("+Date.parse(r)+"))":"null"),u=u.replace(e.Expression,r)}if(u)try{return o=eval(u),!i&&$func.isNumber(o)&&(o=parseFloat(o.toFixed(7))),o}catch(p){}return f},sum:function(n,t){for(var r=0,u=this._getColumnOrder(n),i=0;i<this._rowCount;i++)(!t||t&&this.calcExpression(i,t))&&(r+=u>0?this._getItemValue(i+1,u):this.calcExpression(i,n));return r},max:function(n,t){var r=this,f,o,u,i,e;if(r._rowCount==0)return-1;for(f=r._getColumnOrder(n),u=-1,i=0;i<r._rowCount;i++)(!t||t&&r.calcExpression(i,t))&&(e=f>0?r._getItemValue(i+1,f):r.calcExpression(i,n),(u==-1||e>o)&&(o=e,u=i));return u},min:function(n,t){var r=this,f,o,u,i,e;if(r._rowCount==0)return-1;for(f=r._getColumnOrder(n),u=-1,i=0;i<r._rowCount;i++)(!t||t&&r.calcExpression(i,t))&&(e=f>0?r._getItemValue(i+1,f):r.calcExpression(i,n),(u==-1||e<o)&&(o=e,u=i));return u},allocate:function(n,t,i,r){var u=this,s,f,h;if(u._rowCount!=0&&(s=u.max(t,r),s!=-1)){var e=u._getColumnOrder(t),c=u._getColumnOrder(i),o=u.sum(i,r),l=$func.scaleLength(u._getColumnFormat(e));for(f=0;f<u._rowCount;f++)(!r||r&&u.calcExpression(f,r))&&(o==0?u._setItemValue(f+1,e,0):(h=u._getItemValue(f+1,c),h=$func.round(n*h/o,l),u._setItemValue(f+1,e,h)));(o=u.sum(t,r),n!=o)&&u._setItemValue(s+1,e,u._getItemValue(s+1,e)+n-o)}},setItemGridBehavior:function(n,t){for(var i,r=0;r<t.length;r++)i=t[r],this.setItemControlBehavior(n,i[0],i[1],i[2],i[3])},setItemControlBehavior:function(n,t,i,r,u){var o;if($func.isArray(i)){if(o=i[0],i.length>1&&!this.calcExpression(n.row-1,i[1]))return}else o=i;if(u)if($func.isArray(u)){if(!(this.calcExpression(n.row-1),u[0]))return}else if($func.isString(o)){if($func.trim(o)=="")return}else if(!o)return;var s=n.row,f=null,e=this._getColumnOrder(t);if(e>0&&(this._setItemValue(s,e,o),f=this._getItem(s,e)),f){if(r!=null&&!f.label)try{e=this._getColumnOrder(this._fields[e-1].ItemReference),e>0&&(f.label=this._getItem(s,e))}catch(h){}r!=null&&f.label&&($func.isArray(r)?(f.label.value=r[0],r.length>1&&(f.label.checked=r[1],f.label.Checked=!0,r[1]?Sys.UI.DomElement.removeCssClass(f,"InvalidInput"):Sys.UI.DomElement.addCssClass(f,"InvalidInput"))):(f.label.value=r,f.label.checked=!0,Sys.UI.DomElement.removeCssClass(f,"InvalidInput")))}},live:function(n,t,i){var r,f,u;if(i){if(r=$get(t),r&&r.live&&(r._lastValue=this._getItemValue(r),$func.setCurPos(r,0),!$func.isOpr))try{r.select()}catch(e){}}else f=n.row,u=this._getColumnOrder(t),u>0&&(r=this._getItem(f,u)),r&&window.setTimeout(String.format("$find('{0}').live(null, '{1}', true);",this.get_id(),r.id),1)},validate:function(){var t,n,i,r;if((this._error=null,this._errorLabel=null,this._errorMessage=null,this._errorObject=null,this._checkScript&&this.excuteScript(this._checkScript),this.raiseGridEvent("Check"))&&!this._error)for(t=0;t<this._fields.length;t++)if(n=this._fields[t],!n.ReadOnly&&!n.Hidden&&!n.External&&n.Type!="Boolean"||n.AllowContain)for(i=0;i<this._rowCount;i++)if(r=this._getItem(i+1,t+1),!$func.validateGridObject(this.get_id(),r,n,this._fields)){this._error=!0,this._errorLabel=n.Label,this._errorObject=r;return}},validRowExpression:function(n,t){var r,i;if(t=$func.replace(t,"$","R"),r=this._getColumnOrder(n),r>0)for(i=0;i<this._rowCount;i++)if(!this.calcExpression(i,t))return this._error=!0,this._errorLabel=this._fields[r-1].Label,this._errorObject=this._getItem(i+1,r),!1;return!0},scatterMemvar:function(){},gatherMemvar:function(){var t,u,i,n,r,f;for(this._modified=this.get_element().parentForm._action=="New"?!0:!1,this._memvars=[],this._rowCount!=this._rows.length&&(this._modified=!0),t=0;t<this._rowCount;t++){if(u=this._getRow(t+1,!0),!this._modified)for(i=0;i<this._fields.length;i++)if(n=this._fields[i],(!n.ReadOnly&&!n.Hidden&&!n.External||n.AllowContain)&&(r=this._rows[t][n.Index],n.Type=="DateTime"&&(r=$func.offsetDate(r)),!$func.compareFieldValue(n,r,u[i]))){this._modified=!0;break}f=[u,0],Array.add(this._memvars,f)}},blankMemvar:function(n){var t,i;if(this._rowCount<n)return!0;for(t=0;t<this._fields.length;t++)if(i=this._fields[t],(!i.ReadOnly&&!i.Hidden&&!i.External||i.AllowContain)&&this._getItemValue(n,t+1))return!1;return!0},get_dirController:function(){return this._controller},get_dirMethod:function(){return this._serviceMethod},get_dirService:function(){return this._servicePath},get_dirID:function(){return this.get_id()},createDirExtender:function(){if(!this._dirExtender){var n=this.get_executeButton("View");this._dirExtender=$create(FastBusiness.AjaxControlExtender.DirExtender,{id:this.get_id()+"_dirExtender",viewMode:n,language:this._language,controller:this._controller,servicePath:this._servicePath,serviceLookup:this._serviceLookup,baseUrl:this._baseUrl,cookie:this._cookie},null,null,this._container),this._dirExtender.grid=this}},executeDirInfor:function(n){this.createDirExtender(),this._dirExtender.set_values(this._getPrimaryKeyValues()),this.raiseGridEvent("BeforeFormLoad",this._dirExtender),this._dirExtender.executeAction(n)},createSearchExtender:function(){this._searchExtender||(this._searchExtender=$create(FastBusiness.AjaxControlExtender.DirExtender,{id:this.get_id()+"_searchExtender",searchMode:!0,language:this._language,controller:this._controller,servicePath:this._servicePath,serviceLookup:this._serviceLookup,baseUrl:this._baseUrl,cookie:this._cookie},null,null,this._container),this._searchExtender.grid=this)},search:function(){this.createSearchExtender(),this._searchExtender.executeAction("Search")},createFormExtender:function(n){var t=$func.findForm(n,this._forms);t||(t=$create(FastBusiness.AjaxControlExtender.DirExtender,{id:this.get_id()+"_formExtender"+n,searchMode:!0,formMode:!0,language:this._language,controller:n,servicePath:this._servicePath,serviceLookup:this._serviceLookup,baseUrl:this._baseUrl,cookie:this._cookie},null,null,this._container),t.grid=this,t.entity={},Array.add(this._forms,t))},showForm:function(n){this.createFormExtender(n);var t=$func.findForm(n,this._forms);t.executeAction("Search")},addExternalScripts:function(n){var t,i,r;this._script||(t=this._script=document.createElement("script"),i=document.getElementsByTagName("head")[0],$func.isIE?t.text=n:(r=document.createTextNode(n),t.appendChild(r)),i.appendChild(t))},excuteScript:function(text){eval($func.resolveClientText(text,this._baseUrl))},addExternalCascadingStyleSheets:function(n){var t,i,r;this._css||(t=this._css=document.createElement("style"),t.type="text/css",t.rel="stylesheet",i=document.getElementsByTagName("head")[0],$func.isIE?t.styleSheet.cssText=n:(r=document.createTextNode(n),t.appendChild(r)),i.appendChild(t))},request:function(n,t,i,r,u,f){var o=this,l,s,h,v,y,c,p,e,a,w,b;if(o._servicePath&&(!f||n.value.replace(/ +$/,'')!=n._lastValue.replace(/ +$/,''))){if(l=[],u&&u.length>0)for(v=o.get_element().parentForm,c=0;c<u.length;c++)e=u[c],$func.isArray(e)?h={Name:e[0],Type:e[1],Value:e[1]=="Infinite"?$func.compress(e[2]):e[2]}:(y=v.getItem(e),s=$func.findField(e,v._fields),h={Name:"$"+e,Type:s?s.Type:"String",Value:y?$func.getItemValue(y,s):null},s.ItemStyle&&!s.ItemNormalCase&&(h.Ansi=!0)),Array.add(l,h);for(c=0;c<r.length;c++)p=n.row,e=r[c],$func.isArray(e)?(h={Name:e[0],Type:e[1],Value:e[1]=="Infinite"?$func.compress(e[2]):e[2]},Array.add(l,h)):(a=o._getColumnOrder(e),a>0&&(s=o._fields[a-1],h={Name:e,Type:s.Type,Value:o._getItemValue(p,a)},s.ItemStyle&&!s.ItemNormalCase&&(h.Ansi=!0),Array.add(l,h)));w=n.id+":"+i,b={actionID:t,values:l,controller:o._controller,language:o._language,element:$func._grant(n,1)},$func.showWait(o.get_id()),o._busy(!0),Sys.Net.WebServiceProxy.invoke(o.get_servicePath(),"GetGridResponse",!1,b,Function.createDelegate(o,o._onResponseComplete),Function.createDelegate(o,o._onResponseFailed),w)}},add_onResponseComplete:function(n){this.get_events().addHandler("onResponseComplete",n)},remove_onResponseComplete:function(n){this.get_events().removeHandler("onResponseComplete",n)},raiseResponseComplete:function(n){var t=this.get_events().getHandler("onResponseComplete");t&&t(this,n)},_onResponseComplete:function(n,t){var i;if(this._busy(!1),$func.hideWait(this.get_id()),n){n.ClientScript&&this.excuteScript(n.ClientScript),i=null,n.Row&&(i=n.Row);var r=t.split(":"),u=$get(r[0]),f=r[1],e=new FastBusiness.AjaxControlExtender.EventArgs(this,{Context:f,Result:i,Object:u});this.raiseResponseComplete(e)}},_onResponseFailed:function(n){this._busy(!1),$func.hideWait(this.get_id()),$message.showError(n)},_navigate:function(j,g){var a=this,b=null,e=b,h=b;if(j){e=$func.getLocationCell(j);h=e[0]-1;if(!g)g=a._fields[e[1]-1].HyperlinkFormatString}var i=g.match(/(^.+?\/)\w+\/\w+\.as[hp]x/),c=i?i[0]:"";if(!c)return;var m=c.length;c=$func.resolveClientUrl(c,a._baseUrl);var l=g.substring(m),k=String.format("{{{0}}}",l);a._args=b;try{a._args=JSON.parse(k.replace(/'/g, '"').replace(/(['"])?([a-z0-9A-Z_]+)(['"])?:/g,'"$2": '))}catch(o){a._args=b}if(a._args){if(a._args.Query&&h!=b)for(var f in a._args.Query){var n=a._args.Query[f];a._args.Query[f]=a.calcExpression(h,$func.trim(a._args.Query[f]),true);if(a._args.Query[f]==b)a._args.Query[f]=n}if(a._args.Script){if(e){a._activeRow=e[0];a._activeColumn=e[1]}try{a.excuteScript(a._args.Script)}catch(o){}a._args.Script=b;if(a._args.cancelEvent){a._args.cancelEvent=b;return}}if(a._args.Parameter)c+=String.format("?p={0}",a._args.Parameter)}var d=$func.requestFormData();d.action=c;d.target="_blank";d.rel="opener";$get("command",d).value="Navigate";$get("argument",d).value="0";$get("query",d).value=Sys.Serialization.JavaScriptSerializer.serialize(a._args);d.submit()},_passParameter:function(n){var t=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,6);this._args.Parameter=t,sessionStorage.setItem(t,Sys.Serialization.JavaScriptSerializer.serialize(n))},executePrint:function(n){var t=this,r=t._mode,f="Report",u="Voucher",e=r==f||r==u,o=r=="Detail",i;(e||t._rowSelected()||t._type==f&&!o)&&(i=$func.requestFormData(),t.setFormDataMemvar(n,i),i.action=$func.resolveClientUrl("~/AppHandler/Print.ashx",t._baseUrl),i.target="_blank",n.PrimaryKeyValues=t._getPrimaryKeyValues(),n.Memvars=[],n.Hash=t._hashValue,(e||o)&&(t._type!=u||r==u)&&(n.FilterMemvars=t._filterMemvars),t.submitForm(n,i))},executeExport:function(n){var t=$func.requestFormData();this.setFormDataMemvar(n,t),t.action=$func.resolveClientUrl("~/AppHandler/Export.ashx",this._baseUrl),n.View=this._viewId,n.LastPageIndex=this._lastPageIndex,n.FirstPageItem=this._firstPageItem,n.LastPageItem=this._lastPageItem,n.LastRowCount=this._lastRowCount,n.GridPageIndex=this._gridPageIndex,n.ExternalHiddenFields=this._externalHiddenFields,this._externalHeaderFields&&(n.ExternalHeaderFields=this._externalHeaderFields),this._alterTitle&&(n.Parameters=this._alterTitle[1]),this.submitForm(n,t)},clientExport:function(){for(var n=this,c="csv",d="﻿\uFEFF",f=new Sys.StringBuilder,y=window.document.title,g=y+"."+c,a="\r\n",l=n._fields.length,w=n._rowCount,b="utf-8",k="text/"+c+";charset="+b,i,p,v,r,s,h,e,nt,t,tt,u,o;!n._fields[l-1].Visible;)l--;for(f.append(y+a+"\n"),i=0;i<w;i++){for(p="",v="",r=0;r<l;r++)s=n._fields[r],s.Visible&&(h=s.Type,i==0&&(p+='"'+$func.replace(s.HeaderText,'"','""')+'",'),e=n._getItemValue(i+1,r+1),nt=h=="Boolean"?e?"1":"0":h=="DateTime"?e?n._getItem(i+1,r+1).value:"":e.toString(),v+=(h=="String"&&!isNaN(e)?"=":"")+'"'+$func.replace(nt,'"','""')+'"'+(r==l-1?"":","));f.append((i==0?p+a:"")+v+(i==w-1?"":a))}window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(new Blob([d+f.toString()],{encoding:b,type:k}),g):(t=document.createElement("a"),typeof t.download!="undefined"?(t.style="visibility:hidden",tt="data:"+k+","+d+encodeURIComponent(f.toString()),t.href=tt,t.download=g,document.body.appendChild(t),t.click(),document.body.removeChild(t)):(u=$func.requestFormData(),u.target=c,u.action=$func.resolveClientUrl("~/AppHandler/Export.ashx",n._baseUrl),o={Language:n._language,Controller:y,Cookie:n.get_cookie(),Time:(+new Date).toString()},o.commandName=c,o.commandArgument=$func.compress(f.toString()),$get("command",u).value=o.commandName,$get("argument",u).value="0",$get("query",u).value=Sys.Serialization.JavaScriptSerializer.serialize(o),u.submit())),n._activeCell&&n._activeCell.focus()},setFormDataMemvar:function(n,t){t.target=n.commandName,n.Language=this._language,n.Controller=this._controller,n.Memvars=this._type=="Report"?[]:this._memvars,n.FilterMemvars=[],n.Filter=this._filter,n.SortExpression=this._sortExpression,n.ExternalKey=this._externalKey,n.Cookie=this.get_cookie(),n.Time=(+new Date).toString()},submitForm:function(n,t){$get("command",t).value=n.commandName,$get("argument",t).value=n.commandArgument,$get("query",t).value=Sys.Serialization.JavaScriptSerializer.serialize(n),t.submit(),this._activeCell&&this._activeCell.focus()},getAggregateResult:function(){var t=this,u=t._activeCell,i,r;if(u&&u.field&&(i=u.field,i.Aggregate)){if(t.g$a&&(r=$func.findValue(i,t.g$a),r!=null)){$message.show(String.format(t._getResources("Message.Aggregate"),i.HeaderText,r?$func.valueToString(r,i):"0"),String.format("$find('{0}')._activeCell.focus();",t.get_id()));return}t._loadPage(-3)}},getItemFieldValue:function(n,t){var i=this._getColumnOrder(n);i>0&&this._getItemValue(t,i)},setItemFieldValue:function(n,t,i){var r=this._getColumnOrder(n);r>0&&this._setItemValue(t,r,i)},setSequenceNumber:function(n){var i=this._getColumnOrder(n),t;if(i>0)for(t=0;t<this._rowCount;t++)this._setItemValue(t+1,i,t+1)},setContinuance:function(n,t){var r=this,i,u;if(r._rowCount!=0){t||(t="000");var f=r._getColumnOrder(n),e="999",o=36;if(f>0)for(i=r._getItemValue(r.max(n)+1,f),i<t&&(i=t),u=0;u<r._rowCount;u++)$func.trim(r._getItemValue(u+1,f))==""&&(i=i<e?$func.increaseNumber(i):i==e?"A00":(parseInt(i,o)+1).toString(o).toUpperCase(),r._setItemValue(u+1,f,i))}},executeCommand:function(n){var t=this,h,c,v,y,l,e,s,u,f,a,p;if(!t._isBusy){$func.hidePopups();var i=n.commandName,o=n.commandArgument,r=t.get_executeButton(i);switch(i){case"Insert":if(r&&(e=null,t._activeRow>0&&(e=t._activeRow),t._insertRow(o)&&e>0))for(s=t._rowCount,u=0;u<t._fields.length;u++)f=t._fields[u],f.ClientDefault=="Default"&&(h=f.ItemReference,h&&h.length>0&&(c=t._getColumnOrder(h),c>0&&(v=t._getItem(e,c),v.Checked&&(v.checked||(y=t._getItem(s,u+1),l=t._getItem(s,c),y.label=l,l.checked=!1,l.Checked=!0,Sys.UI.DomElement.addCssClass(y,"InvalidInput"))))),f.HandleKey&&f.HandleKey.length>0&&$func.setObjectWhen(t._getItem(s,u+1),$func.getObjectWhen(t._getItem(e,u+1))));break;case"Remove":r&&t._removeRow();break;case"New":if(r){if(!t.raiseGridEvent(i))return;t.executeDirInfor(i)}break;case"Edit":if(t._rowSelected()&&r){if(!t.raiseGridEvent(i))return;t.executeDirInfor(i)}break;case"Delete":if(r&&t._rowSelected())if(o=="0")$message.show(t._getResources("Message.ConfirmDelete"),0,String.format("$find('{0}').executeCommand({{commandName:'Delete',commandArgument:'1'}});",t.get_id()),String.format("$find('{0}')._activeCell.focus();",t.get_id()));else{if(!t.raiseGridEvent(i))return;t.executeDirInfor(i)}break;case"Search":!r||t._childObject&&t._readOnly||t.search();break;case"View":if(t._rowSelected()&&r){if(!t.raiseGridEvent(i))return;t.executeDirInfor(i)}break;case"Print":if(r){if(!t.raiseGridEvent(i,o))return;t.executePrint(n)}break;case"Export":if(r){if(!t.raiseGridEvent(i,o))return;t._childObject?t.clientExport():t.executeExport(n)}break;case"Clone":if(r){if(!t.get_element().parentForm){if(t._rowSelected()){if(!t.raiseGridEvent("Copy"))return;t.executeDirInfor(i)}return}if(t._activeCell&&t.get_allowNew()&&t._validRowBehavior(t._activeRow)){if(!t.raiseGridEvent("BeforeCloneRow"))return;for(e=t._activeRow,t._appendRow(!0),s=t._rowCount,u=0;u<t._fields.length;u++)f=t._fields[u],f.HandleKey&&f.HandleKey.length>0&&$func.setObjectWhen(t._getItem(s,u+1),$func.getObjectWhen(t._getItem(e,u+1)));t.raiseGridEvent("AfterCloneRow")}}break;case"Grow":r&&t._activeCell&&t.get_allowEdit()&&t._activeRow>1&&t._moveRow(t._activeRow,t._activeRow-1)&&$func.moveUpDown(t.get_id(),t._fields,t._activeCell,null,t._activeRow,t._activeColumn,-1);break;case"Down":r&&t._activeCell&&t.get_allowEdit()&&t._activeRow<t._rowCount&&t._moveRow(t._activeRow,t._activeRow+1)&&$func.moveUpDown(t.get_id(),t._fields,t._activeCell,null,t._activeRow,t._activeColumn,1);break;case"Aggregate":r&&t.getAggregateResult(n);break;case"Freeze":if(r&&t._activeCell&&t._activeColumn>0){if(t._freezeColumns>0&&t._activeColumn>t._freezeColumns)return;a=!1;!1&&(p=t.get_toolbarButton(i));t._fixedColumns==t._activeColumn?(t._activeColumn<=t._fixedColumns&&($func.hideImageActiveCell(t._activeCell),a=!0),t._changePosition(-1),t._fixedColumns=0,t.A07(0),!1&&(p.title=t._getResources("Toolbar.Freeze"))):($func.hideImageActiveCell(t._activeCell),a=!0,t.set_fixedColumns(t._activeColumn),!1&&(p.title=t._getResources("Toolbar.Unlock")));$func.layoutGrid(t._divHeader,t._divGrid,!0,t._rowCount,t._divFooter);a&&$func.showImageActiveCell(t._activeCell)}break;default:o?t.raiseGridEvent(i,o):t.raiseGridEvent(i)}}}},FastBusiness.AjaxControlExtender.ReportExtender.registerClass("FastBusiness.AjaxControlExtender.ReportExtender",Sys.UI.Behavior),typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
var $func,$render;Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.GridFunction=function(){this.isIE6=Sys.Browser.agent==Sys.Browser.InternetExplorer&&Sys.Browser.version<7,this.isIE=Sys.Browser.agent==Sys.Browser.InternetExplorer,this.isFF=Sys.Browser.agent==Sys.Browser.Firefox,this.isIx=(new RegExp("Trident/([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)?parseFloat(RegExp.$1):-1)>=5,this.isFx=this.isFF&&Sys.Browser.version>=10,this.isSr=Sys.Browser.agent==Sys.Browser.Safari&&navigator.userAgent.indexOf(" Chrome/")<=-1,this.isCr=navigator.userAgent.indexOf(" Chrome/")>-1,this.isOpr=Sys.Browser.agent==Sys.Browser.Opera,this.isIF=this.isIx||this.isIE||this.isFF,this.isIO=this.isIE||this.isOpr,this.isCs=this.isCr||this.isSr,this.colResizeCursor=this.isOpr?"e-resize":"col-resize"},FastBusiness.AjaxControlExtender.GridFunction.prototype={setVisible:function(n,t){var i,r;n&&(i=n.style,t?(r="display",i.removeAttribute?i.removeAttribute(r):i.removeProperty(r)):i.display="none",i.visibility=t?"visible":"hidden")},dataFieldName:function(n,t){return this.replace(n,"%l",t=="v"?"":"2")},formatDateOrder:function(n){if(!n)return"";var t=n.z?n.z:n,u=t.getFullYear(),i=t.getMonth()+1,r=t.getDate();return""+u+(i>9?"":"0")+i+(r>9?"":"0")+r},formatStringToDate:function(n){var t=n.substring(0,4),i=n.substring(4,6),r=n.substring(6);return new Date(parseInt(t,10),parseInt(i,10)-1,parseInt(r,10))},isTimeFormat:function(n){return n.indexOf(":")>=0},getCookie:function(n){var t=null;try{t=localStorage.getItem(n)}catch(i){}return t},setCookie:function(n,t){try{localStorage.setItem(n,t)}catch(i){}},increaseNumber:function(n,t,i){var f,e,s,o,r,u;if((n.length=0)||(f=n.match(/\d+/g),f.length==0))return"";for(e=f[0].length,s=0,u=1;u<f.length;u++)f[u].length>e&&(e=f[u].length,s=u);if(o=f[s],r=String(parseInt(o,10)+1),e=o.length-r.length,e<0&&i)return"";for(u=0;u<e;u++)r="0"+r;return(r=n.replace(o,r),i!=null&&t!==null&&(r>i||r<t))?"":r},alter:function(n,t){for(var u=n,f,i,r=0;r<t.length;r++)f=t[r],i=t[r][1],f.length>2&&f[2]&&(i=String.format('<span class="TextHighlight">{0}</span>',this.isString(i)?this.htmlEncode(i):i)),u=this.replace(u,t[r][0],i);return u},clientScript:function(n){return this.isIE||n.ItemStyle!="AutoComplete"?n.ClientScript:n.ClientScript.replace('onchange="','onchange="if($func.clientChange(this)) ')},clientChange:function(n){return n._saveChangedValue?n.value!=n._saveChangedValue:!0},replace:function(n,t,i){return n.split(t).join(i)},isFunction:function(n){return n instanceof Function||typeof n=="function"},isString:function(n){return n instanceof String||typeof n=="string"},isArray:function(n){return n instanceof Array||typeof n=="array"},isDate:function(n){return n instanceof Date},isBoolean:function(n){return n instanceof Boolean||typeof n=="boolean"},isNumeric:function(n){var t=n.charCodeAt(0);return t>=48&&t<=57},isNumber:function(n){var u=n instanceof Number||typeof n=="number",t,i,r;if(u)return!0;if(t=""+n,t.length==0)return!1;for(i=0;i<t.length;i++)if(r=t.charAt(i),"0123456789.-".indexOf(r)==-1)return!1;return!0},fireChanged:function(n){if(document.createEventObject)n.fireEvent("onchange");else if(document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!0),n.dispatchEvent(t)}},initExpression:function(n){var u,i;if(!n.Variables){for(var r=[],f=/\[(\w+)\]/g,t=f.exec(n.Expression);t;){for(u=!1,i=0;i<r.length;i++)if(r[i].name==t[1]){u=!0;break}u||Array.add(r,{Name:t[1],Expression:new RegExp("\\["+t[1]+"\\]","g")}),t=f.exec(n.Expression)}n.Variables=r}},findAccessKey:function(n,t){for(var i=n.length-1;i>=0;i--)if(n[i][0]==t)return i;return-1},disableAccessKey:function(n){var t,u,i;this._accessKey||(this._accessKey=[]);var f=n.get_id(),r=this._accessKey,e=r.length;for(n._accessKey=[],e==0&&Array.add(r,[f,[]]),t=e-1;t>=0;t--)if(r[t][0]!=f){for(t==e-1&&Array.add(r,[f,[]]),u=0;u<r[t][1].length;u++)i=$get(r[t][1][u]),i&&i.accessKey&&(Array.add(n._accessKey,[i,i.accessKey]),i.removeAttribute("accesskey"));break}},assignAccessKey:function(n,t){this._accessKey||(this._accessKey=[]);var i=this._accessKey,r=this.findAccessKey(i,n);r==-1&&(Array.add(i,[n,[]]),r=i.length-1),Array.add(i[r][1],t)},restoreAccessKey:function(n){for(var i,r,t=0;t<n._accessKey.length;t++)n._accessKey[t][0].accessKey=n._accessKey[t][1];n._accessKey=[],this._accessKey&&(i=this._accessKey,r=this.findAccessKey(i,n.get_id()),r>-1&&Array.removeAt(i,r))},changeGridCaption:function(n,t){for(var i,u,r=0;r<n.childNodes[0].childNodes.length-1;r++)i=n.childNodes[0].childNodes[r+1].childNodes[0],u=t[r],i.headerCaption||(i.headerCaption=u.HeaderText),i.title=u.HeaderText},changeHeaderCaption:function(n){n.headerCaption&&(n.title=n.headerCaption)},getInnerText:function(n){return this.isFF?n.textContent:n.innerText},setInnerText:function(n,t){this.isFF?n.textContent=t:n.innerText=t},highlightItem:function(n,t,i){var f="Highlight",e="RowBottom",u,r;if(t>0)for(u=0;u<=t;u++)r=n.childNodes[u].childNodes[0],i==0?Sys.UI.DomElement.addCssClass(r,f):i==1?Sys.UI.DomElement.removeCssClass(r,f):i==2?Sys.UI.DomElement.addCssClass(r,e):i==3&&Sys.UI.DomElement.removeCssClass(r,e);this.isFF&&i==3&&this.reDraw(n)},reDraw:function(n){var t=n.style.display;n.style.display="none",n.offsetHeight,n.style.display=t},changeChildNode:function(n,t){this.isOpr&&(t?(n.x=n.childNodes[0],n.removeChild(n.x)):n.appendChild(n.x))},changePosition:function(n,t,i,r,u,f,e,o,s){for(var c=this,l=null,ft="1px solid #D2D6D9",ri="1px solid #9AC6FF",fi=8,lt=8,pt=0,oi=0,tt=24,vt=0,d,v,it,wt,k,w,g,h=0;h<f;h++)d=u[h],d._headerDropDownBehavior&&(s?d._headerDropDownBehavior.set_highlightBackgroundColor("transparent"):d._headerDropDownBehavior.set_highlightBackgroundColor("#EAF5F9")),d.Visible&&(tt+=u[h].Width+lt,vt+=1);var ni=r.parentNode.parentNode.scrollLeft,b=ni-(c.isFF&&!c.isFx?0:tt),vi=ni,rt=21,ut=17,ai=22,et=13,li=22,ci=l,yt=5,bt=0;c.isOpr||c.isCs?(rt=22,ut=18,et=14,yt=l):c.isFF&&(rt=22,ut=17,et=14,ci=1,bt=1),c.isIx&&(rt=22,ut=18,et=14,yt=l);var ii="RowBottom",p=ii,ct="GridHeader",hi=0,si=0,at=0,ht=0,ei=p,pi=29,yi=8;n&&(hi=15,si=15,at=-1,ht=0,ei=l,c.isFF&&(ht=-1,at=0));var y=i.childNodes,ui=1,nt=24,a=y[0].childNodes[0],st=n?39:9,ti=1;for(c.setPosition(a.childNodes[0],pt,b,rt+hi,nt+1,fi+si,l,ft,p,e,ct,s,n),v=nt+1,k=0,h=0;h<f;h++)u[h].Visible&&(k+=1,g=k==vt?ri:ft,a=y[0].childNodes[h+1],c.setPosition(a.childNodes[0],pt,b+v+1,ut+at,u[h].Width,fi+bt+ht,l,g,ei,e,ct,s),n&&c.setPosition(a.childNodes[1],pt+pi,b+v+1,l,u[h].Width+yi,l,l,g,p,e,ct,s,n),v+=u[h].Width+1+lt);for(p="HeaderBottom",it=0;it<2;it++)for(it==1&&(y=r.childNodes,st=0,b=vi,ui=o,p=ii,ti=t?t.length:0),h=ui;h<y.length;h++){var gt=l,ot=0,dt=ci,kt=yt;for(h==y.length-1&&(gt=p,c.isFF&&(ot=1,dt=1,kt=5)),a=y[h].childNodes[0],c.changeChildNode(a,s),nt=24,wt=(h+ti)%2==0?"RowCellDefault":"RowCellAlternating",c.setPosition(a.childNodes[0],st+oi+h*li,b,ai-ot,nt+1,dt,l,ft,p,e,wt,s),v=nt+1,k=0,w=0;w<f;w++)u[w].Visible&&(k+=1,g=k==vt?ri:ft,a=y[h].childNodes[w+1],c.setPosition(a.childNodes[0],st+oi+h*li,b+v+1,et-ot,u[w].Width,kt,l,g,gt,e,wt,s),v+=u[w].Width+1+lt)}return s||(tt=0),tt},changeLocation:function(n,t,i,r,u,f,e,o,s){var v=r.childNodes,g=1,d=8,b=24,p,w,y,h,c,l;s==null&&(s=u.parentNode.parentNode.scrollLeft);var a=s-(this.isFF&&!this.isFx?0:o),nt=s,k=v[0];for(k.childNodes[0].childNodes[0].style.left=a+"px",c=b+1,h=0;h<e;h++)f[h].Visible&&(p=k.childNodes[h+1],w=a+c+1+"px",p.childNodes[0].style.left=w,n&&(p.childNodes[1].style.left=w),c+=f[h].Width+d+1);for(y=0;y<2;y++)for(y==1&&(v=u.childNodes,a=nt,g=0),h=g;h<v.length;h++)for(c=b+1,v[h].childNodes[0].childNodes[0].style.left=a+"px",l=0;l<e;l++)f[l].Visible&&(v[h].childNodes[l+1].childNodes[0].style.left=a+c+1+"px",c+=f[l].Width+d+1)},layoutPosition:function(n,t,i,r,u,f){var s=this,a="1px solid #D2D6D9",v=0,y=n.parentNode.parentNode.scrollLeft,p=13,b=22,k=null,d=5,h,c,g,l,e,nt;for(s.isFF&&(k=1),(s.isCs||s.isOpr)&&(p=14,d=null),o=t.childNodes[0],f&&s.changeChildNode(o,!0),w0=24,h=i%2==0?"RowCellDefault":"RowCellAlternating",s.setPosition(o.childNodes[0],v+i*b,y,22,w0+1,k,null,a,"RowBottom",0,h,!0),w=w0+1,c=0,e=0;e<u;e++)g=r[e],g.Visible&&(c+=1);for(l=0,e=0;e<u;e++)r[e].Visible&&(l+=1,nt=l==c?"1px solid #9AC6FF":a,o=t.childNodes[e+1],s.setPosition(o.childNodes[0],v+i*b,y+w+1,p,r[e].Width,d,null,nt,"RowBottom",0,h,!0),w+=r[e].Width+9)},savePosition:function(n,t){n._fixedColumn||(n._styleTop=n.style.top,n._styleLeft=n.style.left,n._styleHeight=n.style.height,n._styleWidth=n.style.width,t||(n.parentNode._styleWidth=n.parentNode.style.width),n._stylePosition=n.style.position,n._stylePaddingTop=n.style.paddingTop,n._styleBorderRight=n.style.borderRight)},setPosition:function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v=n.style;if(!l){v.zIndex==1&&(v.zIndex=""),this.resetPosition(n,e,s,c,a);return}(this.savePosition(n,a),t!=null&&h==0&&(v.top=t+"px"),i!=null&&(v.left=i+"px"),h>0||n._fixedColumn)||(v.position="absolute",a&&(v.zIndex=1),n._fixedColumn=!0,r!=null&&(v.height=r+"px"),n.parentNode.style.width="0px",u!=null&&(v.width=u+"px"),f!=null&&(v.paddingTop=f+"px"),e!=null&&(v.backgroundColor=e),c!=null&&Sys.UI.DomElement.addCssClass(n,c),o!=null&&(v.borderRight=o),s!=null&&Sys.UI.DomElement.addCssClass(n,s))},resetPosition:function(n,t,i,r,u){var f=n.style;n._fixedColumn=!1,u||(n.parentNode.style.width=n.parentNode._styleWidth),f.position=n._stylePosition,f.top=n._styleTop,f.left=n._styleLeft,f.height=n._styleHeight,f.width=n._styleWidth,f.paddingTop=n._stylePaddingTop,f.borderRight=n._styleBorderRight,i!=null&&Sys.UI.DomElement.removeCssClass(n,i),r!=null&&Sys.UI.DomElement.removeCssClass(n,r)},changeScrollLeft:function(n,t,i,r,u,f){var s,e,o,h;if(i>f){for(s=n.parentNode,e=0,o=f;o<i-1;o++)h=u[o],h.Visible&&(e+=h.Width+this.getCurrentStyle(s,"paddingLeft")+this.getCurrentStyle(s,"paddingRight")+1);r.scrollLeft>e&&(r.scrollLeft=e)}},getCurrentStyle:function(n,t){return this.measurementToNumber($common.getCurrentStyle(n,t))},setElementWidth:function(n,t){n.style.width=t+"px"},setElementHeight:function(n,t){n.style.height=t+"px"},measurementToNumber:function(n){return parseInt(n.replace("px",""))},hidePopups:function(){for(var i=Sys.Application.getComponents(),n,t=0;t<i.length;t++)n=i[t],AjaxControlToolkit.DropDownBehavior.isInstanceOfType(n)?(n.hide(),n.unhover()):AjaxControlToolkit.PopupControlBehavior.isInstanceOfType(n)?n.hidePopup():AjaxControlToolkit.PopupBehavior.isInstanceOfType(n)&&n.hide()},getLastIndex:function(){return window._lastIndex||(window._lastIndex=1e4),window._lastIndex+=3},requestFormData:function(){var n=$get("requestFormData");return n||(n=document.createElement("form"),n.id="requestFormData",n.method="post",n.innerHTML='<input type="hidden" name="query" id="query"/><input type="hidden" name="command" id="command"/><input type="hidden" name="argument" id="argument"/>',document.body.appendChild(n)),n},compareFieldValue:function(n,t,i){return n.Type=="String"?this.compareStringValue(t,i):n.Type=="DateTime"?this.compareDateTimeValue(t,i):t!=i?!1:!0},compareStringValue:function(n,t){return n==null&&t==""||n==""&&t==null?!0:!(n==null&&t==null)&&(n==null||t==null||n!=t)?!1:!0},compareDateTimeValue:function(n,t){return!(n==null&&t==null)&&(n==null||t==null||Date.parse(n)!=Date.parse(t))?!1:!0},validateGridObject:function(n,t,i,r){var u=null,e=t.value,f,h,o,s;if(i.ItemStyle=="Numeric"&&!i.AllowNulls)return Web.Command.Val(e)==0?!1:!0;switch(i.Type){case"DateTime":i.AllowNulls||e==Web.Command.DateBlankFormat(i.DataFormatString)&&(u=!0);break;case"String":i.AllowNulls||this.trim(e)!=""?(t.addControl||t.label)&&i.ItemStyle=="AutoComplete"&&(f=i.ItemReference,f&&f.length>0&&(h=this.getLocationCell(t)[0],o=this.findOrder(f,r),o>-1&&(s=this.getObjectItem(n,h,o+1),s&&(s.checked||(u=!0))))):u=!0}return!u},validateFormFieldValue:function(n,t,i,r,u){var f=null,e,o;if(i.ItemStyle=="Numeric"&&!i.AllowNulls)return Web.Command.Val(r)==0?!1:!0;switch(i.Type){case"DateTime":i.AllowNulls||r==Web.Command.DateBlankFormat(i.DataFormatString)&&(f=!0);break;case"String":i.AllowNulls||this.trim(r)!=""?i.ItemStyle!="AutoComplete"||u&&i.AllowNulls&&!i.OnDemand||(e=i.ItemReference,e&&e.length>0&&(o=this.getItemInput(n,t,e),o&&(o.checked||(f=!0)))):f=!0}return!f},getItemInput:function(n,t,i,r){return r==null?$get(String.format("{0}{1}_form_{2}",n,t,i)):$get(String.format("{0}{1}_form_{2}{3}",n,t,i,r))},resolveClientText:function(n,t){return n.replace("~/",t)},siteUrl:function(n){var t=n.match(/(^.+?\/)\w+\/\w+\.asmx/);return t?t[1]:""},resolveClientUrl:function(n,t){return n?n.replace(/~\x2f/g,t):null},showWait:function(n,t){var i=$get(n+"_Wait");t&&(i=t),i&&(i.innerHTML!=FastBusiness.AjaxControlExtender.GridFunction.Resources.WaitHtml&&(this._oldWaitHTML=i.innerHTML,i._oldWaitHTML||(i._oldWaitHTML=i.innerHTML)),i.innerHTML=FastBusiness.AjaxControlExtender.GridFunction.Resources.WaitHtml)},hideWait:function(n,t,i){var r;this._oldWaitHTML?(r=$get(n+"_Wait"),i&&(r=i),r&&(r.innerHTML=r._oldWaitHTML?r._oldWaitHTML:this._oldWaitHTML)):t?t.innerHTML="":(r=$get(n+"_Wait"),r&&(r.innerHTML=""))},enableButtons:function(n){for(var r=document.getElementsByTagName("button"),t,i=0;i<r.length;i++)t=r[i],t&&(t.disabled=!n)},findItemByValue:function(n,t){var i,r,u;if(n.Items.length==0)return null;for(t=t==null?"":t.toString(),i=0;i<n.Items.length;i++)if(r=n.Items[i],u=r[0]==null?"":r[0].toString(),u==t)return r;return[t,t]},filterOf:function(n,t){for(var r=n.Name+":",i=0;i<t.length;i++)if(t[i].startsWith(r))return t[i].substr(r.length);return null},filterIsExternal:function(n,t){var i,f,u,r;if(t.length==0)return!1;for(i=0;i<n.length;i++){for(f=n[i].match(/([\w\$]+):/)[1],u=!1,r=0;r<t.length;r++)if(t[r].Name==f){u=!0;break}if(!u)return!1}return!0},fieldIsInExternalFilter:function(n,t){return this.findExternalFilterItem(n,t)!=null},findExternalFilterItem:function(n,t){for(var i,r=0;r<t.length;r++)if(i=t[r],n.Name==i.Name)return i;return null},A03:function(n,t,i,r,u,f,e,o,s){var h,v,y,c,a,l;for(this.A04(r,u),h=0;h<r.length;h++)v=$get(String.format("{0}_Header{1}",f,h+1)),y=$get(String.format("{0}_gridCell_$%r.{1}",f,h+1)),v&&(c=r[h],c.AllowSorting||c.AllowFilter&&!s?(c._dropDownPanel||(a=c._dropDownPanel=document.createElement("div"),Sys.UI.DomElement.setVisible(a,!1),a.id=f+"_DropDownPanel"+h.toString(),a.className="ContextMenuPanel"),e.appendChild(a),l=c._headerDropDownBehavior=$create(FastBusiness.AjaxControlExtender.DropDownBehavior,{dropDownControl:c._dropDownPanel,id:f+"_HeaderDropDown"+h.toString()},null,null,v),l.set_itemHeader(y),l.set_highlightBorderColor("transparent"),l.set_highlightBackgroundColor("#EAF5F9"),l.set_dropArrowBackgroundColor("white"),l.add_showing(u)):v.style.cursor="");n&&this.G98(f,r,t,i,s)},A04:function(n,t){var u=null,r;if(this.G97(n),n!=u)for(i=0;i<n.length;i++)if(r=n[i],r._headerDropDownBehavior!=u&&(r._headerDropDownBehavior.remove_showing(t),r._headerDropDownBehavior.dispose(),r._headerDropDownBehavior=u),r._dropDownPanel!=u){try{r._dropDownPanel.parentElement.removeChild(r._dropDownPanel)}catch(f){}r._dropDownPanel=u}},G98:function(n,t,r,u,f){var v=["Equal","NotEqual","LessThan","GreaterThan","LessThanOrEqual","GreaterThanOrEqual","StartsWith","Contain","NotContain","Filter","Day","Week","Month","Quarter","Year"],s,h,c,o,l,a;for(i=0;i<t.length;i++){var e=t[i],y=$get(String.format("{0}_FilterPanelButton{1}",n,e.Name)),p=$get(String.format("{0}_FilterPanelText{1}",n,e.Name));if(e.AllowFilter&&!f){for(s=e.f$p=document.createElement("div"),s.id=String.format("{0}_FilterPanelItems{1}",n,e.Name),Sys.UI.DomElement.setVisible(s,!1),document.body.appendChild(s),s.className="MenuExtenderContextPanel MenuExtenderContextBarPanel",h=new Sys.StringBuilder,c=e.Type=="DateTime"?15:10,o=0;o<c;o++)e.Type!="String"&&(o==6||o==7||o==8)||e.Type=="Boolean"&&o>=2&&o<=5||(o==10&&h.append('<div class="ContextMenuExtenderBreak"></div>'),l=$func.getResources(u,r,"FilterPanel."+v[o]),h.append(String.format('<a href="#" tabindex="-1" tabstop="false" onclick="$find(\'{0}\').R1({1},{2});return false;" class="MenuExtenderContextItem FilterPanelBackground{2}"><div class="Title">{3}</div></a>',n,e.Index,o+1,l)));s.innerHTML=h.toString(),a=e._filterPanelBehavior=$create(FastBusiness.AjaxControlExtender.PanelControlBehavior,{id:String.format("{0}_FilterPanelPopup{1}",n,e.Name),PopupControlID:s.id,Position:AjaxControlToolkit.PopupControlPopupPosition.Bottom,OffsetY:-8,OffsetX:15},null,null,y),a.hidePopup()}}},G97:function(n){if(n!=null)for(i=0;i<n.length;i++){var t=n[i];if(t._filterPanelBehavior&&(t._filterPanelBehavior.dispose(),t._filterPanelBehavior=null,t.f$p!=null)){try{t.f$p.parentNode.removeChild(t.f$p)}catch(r){}t.f$p=null}}},A05:function(n,t,i){var r=n._dropDownPanel,a,e;if(n._listOfValues&&n._adjustmentNeeded&&n.AllowFilter&&!i){a=r.style.display,r.style.display="block",r.style.width="200px",n._adjustmentNeeded=!1;var u=$get("Options",r),v=u.offsetHeight>150,s=v?20:0;u.style.overflow="auto",e=u.scrollWidth,u.style.overflow="",r.offsetWidth<e&&(u.style.width=e+s+"px",r.style.width=e+s+"px");var c=$common.getBounds(n._headerDropDownBehavior.get_element()),p=$common.getBounds(r),o={x:c.x+c.width-p.width,y:r.offsetTop},w=$common.getBounds(t);if(o.x<0&&(o.x=0),Sys.UI.DomElement.setLocation(r,o.x,r.offsetTop),v){var l=$common.getClientBounds(),f=250,h=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,y=$common.getBounds(u);y.y+f-h>l.height-2&&(f=l.height-(y.y-h)-2),f<150&&(f=150),u.style.height=f+"px",u.style.overflow="auto"}r.style.display=a}},clipboard:function(n,t){var i=$get(t);if(i){i.focus();switch(n){case"Cut":this.clipText=this.mid(i.value,i._lastCurPos+1,i._lastSelectionLength),this.paste(i,"");break;case"Copy":this.clipText=this.mid(i.value,i._lastCurPos+1,i._lastSelectionLength),this.setCurPos(i,i._lastCurPos);break;case"Paste":this.paste(i);break;case"Delete":this.paste(i,"");break;case"Select":i&&i.select()}}},paste:function(n,t){var o,i,r,u,f,e;if(!this.isIF)if(n.parentForm){if(n.parentForm._getReadOnly())return}else if(n.grid&&(o=n.grid,!o._getColumnEditable(o._activeColumn)))return;if(t!=""&&(t=this.clipText),i=n._lastCurPos,r=n._lastSelectionLength,t==null){this.setCurPos(n,i);return}if(u=-1,n.readOnly){this.setCurPos(n,i);return}n.maxLength&&n.maxLength>0&&(u=n.maxLength),f=n.value,r=f.length-i-r,e=this.left(f,i)+t+this.right(f,r),u>0&&(e=this.left(e,u)),n.value=e,this.setCurPos(n,i)},contextMenu:function(n,t){return String.format("$func.showContextMenu(event, this, '{0}', {1});return false;",n,t?!0:!1)},showContextMenu:function(n,t,i,r){if(!t._contextMenu){var u=FastBusiness.AjaxControlExtender.ContextMenu.Resources.Clipboard,f="$func.clipboard('{0}', '{1}')",e=[{CommandName:String.format(f,"Cut",t.id),HeaderText:u.Cut,CssClass:"Cut"},{CommandName:String.format(f,"Copy",t.id),HeaderText:u.Copy,CssClass:"Copy"},{CommandName:String.format(f,"Paste",t.id),HeaderText:u.Paste,CssClass:"Paste"},{},{CommandName:String.format(f,"Delete",t.id),HeaderText:u.Delete},{},{CommandName:String.format(f,"Select",t.id),HeaderText:u.Select}];t._contextMenu=$create(FastBusiness.AjaxControlExtender.ContextMenu,{id:t.id+"_ContextMenu",width:150,language:i,parentElement:r||t.parentNode._fixedColumn?t.parentNode:t.parentNode.parentNode,menuItems:e},null,null,t)}t._lastCurPos=$func.getCurPos(t),t._lastSelectionLength=Web.Command.GetSelectionLength(t),t._contextMenu.show(n,r)},attachContextMenu:function(n,t,i){var r=this.contextMenu(t,i);r&&r.length>0&&n.setAttribute("oncontextmenu",r)},detachContextMenu:function(n){n._contextMenu&&(n._contextMenu.dispose(),n._contextMenu=null)},itemClick:function(n,t){var i=this.getLocationCell(n),u=i[0],r=i[1];this.handleObject(n,t[r-1],t,u,r)},itemKeyPress:function(n,t,i,r,u,f,e,o,s,h,c){if(t){var l=this.keyCode(n);if(this.isOpr&&l==13){if(t.type=="checkbox")return;this.moveForeward(e,f,u,o,s,h,c,t,n,i,r);return}if(this.getColumnHandleKey(r,f)&&this.isOpr&&!this.getObjectWhen(t)&&l!=13&&!this.isNavKey(n)&&!f[r-1].OnDemand){t.stopKeypress=!0,this.cancelEvent(n);return}if(this.isOpr&&(u||f[r-1].ReadOnly)&&l!=13&&!this.isNavKey(n)){this.cancelEvent(n);return}}},getColumnHandleKey:function(n,t){var i=t[n-1];return i.HandleKey&&i.HandleKey.length>0},focusOnHold:function(n,t,i,r){if(this.isOpr){if(t){try{this.setSelectionRange(n,0,0)}catch(u){}return r.focus(),r.disabled=!0,!0}if(i&&i!=n){try{this.setSelectionRange(n,0,0)}catch(u){}return i.focus(),!0}}return!1},getHandleExternal:function(n,t,i,r,u,f,e,o,s){var c=this,h=r[i-1],l,a,v;if((n._currentValue=c.getItemValue(n,h),n._currentValue==n._lastValue&&!n._varied)||n.HandleOnHold)return!1;if(h.HandleExternal.length>0){var y=h.HandleQuery,p=c.getItemValue(n,h,t,i),w=h.HandleExternal.length;for(l=0;l<w;l++)a=h.HandleExternal[l][0],c.setObjectWhen(c.getItem(n,t,a+1),!1);if(c.trim(n.value)=="")return!1;if(c.isOpr&&n.a&&(n.a.childNodes[0]._w=c.getObjectWidth(n.a.childNodes[0]),n.a.childNodes[0].style.width="0px"),v=n.id,Sys.Net.WebServiceProxy.invoke(f,"GetHandleExternal",!1,{s:y,v:p,k:h.HandleFilter?h.HandleFilter:null,e:c._grant(n,2)},e,o,v),n.HandleOnHold=!0,u&&!s&&u.keyCode==9){if(u.shiftKey&&h.HandleBackward)return n.HandleBackward=!0,!0;if(!u.shiftKey&&h.HandleForeward)return n.HandleForeward=!0,!0}if(s){if(s=="HandleBackward"&&h.HandleBackward)return n.HandleBackward=!0,!0;if(s=="HandleForeward"&&h.HandleForeward)return n.HandleForeward=!0,!0}}return!1},handleComplete:function(n,t,i,r,u,f,e,o){var h,a,v,c,s;if(n&&n.length>0){var l=$get(t),y=this.getLocationCell(l),p=y[0],b=y[1],w=o[b-1];for(h=0;h<n.length;h++)if(a=w.HandleExternal[h][0],v=n[h],this.setObjectWhen(this.getItem(l,p,a+1),v),v&&(c=l.grid,s=c._activeCell,s&&s._controlBehavior&&s._controlBehavior._pending&&(s._controlBehavior._pending=null,p==c._activeRow&&a+1==c._activeColumn)))try{s._controlBehavior.set_button(s.a.childNodes[0])}catch(k){}}this.handleLeave(t,i,r,u,f,e,o)},handleLeave:function(n,t,i,r,u,f,e){var o=$get(n),c=this.getLocationCell(o),s=c[0],h=c[1];this.isOpr&&o.a&&o.a.childNodes[0]._w&&(o.a.childNodes[0].style.width=o.a.childNodes[0]._w+"px",o.a.childNodes[0]._w=null),o.HandleOnHold=null,o.HandleForeward?(o.HandleForeward=null,r==s&&u==h&&this.handleLeft(t,i,f,e,s,h,!0),this.isOpr&&(o.disabled=!1)):o.HandleBackward&&(o.HandleBackward=null,r==s&&u==h&&this.handleRight(t,i,f,e,s,h,!0),this.isOpr&&(o.disabled=!1))},handleDirection:function(n,t,i,r){var u=t[r-1];this.handleControl(n,u,t,i,r),n.HandleDirection=!0},handleControl:function(n,t,i,r,u){n.HandleDirection&&(n.HandleDirection=null),this.handleObject(n,t,i,r,u)},handleObject:function(n,t,i,r,u){var o,s,f;if(t.HandleControl&&t.HandleControl.length>0)for(o=this.getItemValue(n,t,r,u),s=t.HandleControl.length,f=0;f<s;f++){var h=t.HandleControl[f],e=i[h],c=$render.handleItemValue(o,e.HandleField,e.HandleKey,e.HandleType);this.setObjectWhen(this.getItem(n,r,h+1),c)}},handleLeftRight:function(n,t,i,r,u,f,e,o,s){var a=this.getLocationCell(n),c=a[0],h=a[1],l=s[h-1];return(n._currentValue=this.getItemValue(n,l),(n._currentValue!=n._lastValue||n._varied)&&(this.handleControl(n,l,s,c,h),this.getHandleExternal(n,c,h,s,u,t,i,r)))?this.isOpr?!0:!1:(u&&u.keyCode==9&&(u.shiftKey&&l.HandleRight?this.handleRight(f,e,o,s,c,h):!u.shiftKey&&l.HandleLeft&&this.handleLeft(f,e,o,s,c,h)),!1)},handleLeft:function(n,t,i,r,u,f,e){for(var o=r.length,s=t.parentNode.parentNode.parentNode.parentNode.childNodes.length;f<o&&(this.getColumnInactivate(f+1,r,i)||this.getItemHandleKey(t,r,u,f+1));)f+=1;if(f<o)f+=1,this.setHandleFocus(n,t,u,f,e);else if(f==o&&u<s){for(u+=1,f=1;f<o&&(this.getColumnInactivate(f+1,r,i)||this.getItemHandleKey(t,r,u,f+1));)f+=1;this.setHandleFocus(n,t,u,f,e)}},handleRight:function(n,t,i,r,u,f,e){while(f>1&&(this.getColumnInactivate(f-1,r,i)||this.getItemHandleKey(t,r,u,f-1)))f-=1;if(f>1)f-=1,this.setHandleFocus(n,t,u,f,e);else if(f==1&&u>1){for(u-=1,f=r.length;f>1&&(this.getColumnInactivate(f,r,i)||this.getItemHandleKey(t,r,u,f));)f-=1;this.setHandleFocus(n,t,u,f,e)}},setHandleFocus:function(n,t,i,r,u){var f,e;if(t)try{this.setSelectionRange(t,0,0)}catch(o){}if(f=this.getItem(t,i,r),this.isOpr&&!u){$find(n)._handleFocus=f;return}if(f.focus(),this.setCurPos(f,0),e=f.value.length,e>0)try{this.setSelectionRange(f,0,e)}catch(o){}},navigation:function(n,t,i,r,u,f,e,o,s,h,c){var l=this,v=t[c-1],a;return!l.isOpr&&s.keyCode==9&&(s.shiftKey&&v.HandleRight||!s.shiftKey&&v.HandleLeft)?(l.cancelEvent(s),-1):(a=s.keyCode,s.ctrlKey&&a==45)?(l.cancelEvent(s),1):s.ctrlKey&&a==127?(l.cancelEvent(s),2):s.ctrlKey&&a==69?(l.cancelEvent(s),3):l.getColumnHandleKey(c,t)&&!l.getObjectWhen(o)&&a!=13&&!l.isNavKey(s)&&!v.OnDemand?(o.stopKeypress=!0,l.cancelEvent(s),0):(v.ItemStyle=="Lookup"&&v.ItemReference!="ReadWrite"||!l.isIF&&l.getColumnReadOnly(v,i))&&a!=13&&!l.isNavKey(s)?(o.stopKeypress=!0,l.cancelEvent(s),0):a==13||a==37||a==38||a==39||a==40?(a==13?l.isOpr||l.moveForeward(n,t,i,r,u,f,e,o,s,h,c):a==37?l.moveLeft(n,t,i,r,u,f,e,o,s,h,c):a==38?o.show||l.moveUpDown(n,t,o,s,h,c,-1):a==39?l.moveRight(n,t,i,r,u,f,e,o,s,h,c):a==40&&(o.show||l.moveUpDown(n,t,o,s,h,c,1)),0):void 0},moveForeward:function(n,t,i,r,u,f,e,o,s,h,c,l){var y=o.field,k=y.ItemStyle,a,v,p,w,b;if(!l&&k=="AutoComplete"&&!(o.readOnly||o._viewMode||o._idle)&&o._controlBehavior&&(a=o._controlBehavior,!a._isOpen))if($func.trim(o.value)==""){if(!y.AllowNulls){a._currentPrefix="",a._showEvent();return}}else if(v=y.ItemReference,p=!0,v&&v.length>0&&(w=this.findOrder(v,t),w>-1&&(b=this.getObjectItem(n,h,w+1),b&&(b.checked||(p=!1)))),o.value!=a._saveTextValue||!p){a._currentPrefix=a._padSize?$func.padLeft(o.value,a._padSize):o.value,a._checkEvent(r);return}this.moveRight(n,t,i,r,u,f,e,o,s,h,c,!0)},moveLeft:function(n,t,i,r,u,f,e,o,s,h,c){var l=this.getCurPos(o),a=t.length;if(l==0||l==-2){if(this.handleDirection(o,t,h,c),this.getHandleExternal(o,h,c,t,r,u,f,e,"HandleBackward"))return;while(c>1&&(this.getColumnInactivate(c-1,t,i)||this.getItemHandleKey(o,t,h,c-1)))c-=1;if(c>1)c-=1,this.navFocus(n,t,!0,s,h,c,-1);else if(c==1&&h>1){for(h-=1,c=a;c>1&&(this.getColumnInactivate(c,t,i)||this.getItemHandleKey(o,t,h,c));)c-=1;this.navFocus(n,t,!0,s,h,c,-1)}}},moveRight:function(n,t,i,r,u,f,e,o,s,h,c,l){var p,a,v,w;if(l){if(p=o.field.ItemStyle,p=="Numeric"&&o._controlBehavior&&o._controlBehavior._isOpen)return;if(this.isOpr&&p=="AutoComplete"&&o.show)return}var b=this.getCurPos(o),y=t.length,k=o.parentNode.parentNode.parentNode.parentNode.childNodes.length;if(b==o.value.length||b==-2||l){if(this.handleDirection(o,t,h,c),this.getHandleExternal(o,h,c,t,r,u,f,e,"HandleForeward"))return;while(c<y&&(this.getColumnInactivate(c+1,t,i)||this.getItemHandleKey(o,t,h,c+1)))c+=1;if(c<y)c+=1,this.navFocus(n,t,!0,s,h,c,0,null,l);else if(c==y&&h<k){for(h+=1,c=1;c<y&&(this.getColumnInactivate(c,t,i)||this.getItemHandleKey(o,t,h,c));)c+=1;this.navFocus(n,t,!0,s,h,c,0,null,l)}else l&&(a=o.grid,a._childObject&&(v=a.get_allowAppend(),v&&(a._inactivateRow(h),a.executeCommand({commandName:"Insert",commandArgument:"1"}),a._rowCount!=h?a._getItem(a._rowCount,a._firstColumnFocus()).shift=!0:v=!1),v||(w=a.get_element(),w.parentForm._processKeyEvents(s,w,!0))))}},moveUpDown:function(n,t,i,r,u,f,e){var s=i.parentNode.parentNode.parentNode.parentNode.childNodes.length,o;(u<s&&e>0||u>1&&e<0)&&(u+=e,o=this.getCurPos(i),i.style.textAlign=="right"?(o=this.trim(i.value).length-o,this.navFocus(n,t,!1,r,u,f,o,!0)):this.navFocus(n,t,!1,r,u,f,o))},navFocus:function(n,t,i,r,u,f,e,o,s){r!=null&&this.cancelEvent(r),this.isOpr&&!s?window.setTimeout(String.format("$func.gridFocus('{0}', null, {1}, {2}, {3}, {4})",n,u,f,e?e:0,o?o:!1),1):this.gridFocus(n,t,u,f,e,o,s)},gridFocus:function(n,t,i,r,u,f,e,o){var h=this,s,c,l;t||(t=$find(n)._fields),u||(u=0),s=null;try{s=h.getObjectItem(n,i,r)}catch(a){}if(s){c=t[r-1],l=s.value.length,c.ItemStyle=="AutoComplete"&&c.Align=="right"&&(s.value=h.trim(s.value)),u==-1&&(u=l),f&&(u=h.trim(s.value).length-u,u<0&&(u=0));try{o&&o._enter(s),s.focus(),u>=0&&h.setCurPos(s,u),e&&u==0&&!h.isOpr&&h.setSelectionRange(s,0,l)}catch(a){}}},getObjectItem:function(n,t,i){return $get(String.format("{0}_inputCell_{1}.{2}",n,t,i))},getItem:function(n,t,i){return this.findBoundControl(n.parentNode.parentNode.parentNode.parentNode.childNodes[t-1].childNodes[i].childNodes[0])},getItemValue:function(n,t,i,r){var u,f;return(u=i==null&&r==null?n:this.getItem(n,i,r),f=t.length==null?t:t[r-1],t.Type=="Boolean")?u.checked:t.DataFormatString=="X"?u.value.toUpperCase():this.stringToValue(u.value,t)},getColumnInactivate:function(n,t,i){var r=t[n-1];return r.Type=="Boolean"&&this.getColumnReadOnly(r,i)?!0:r.Inactivate||!r.Visible},getItemHandleKey:function(n,t,i,r){var u=t[r-1];return u.HandleKey&&u.HandleKey.length>0&&!this.getObjectWhen(this.getItem(n,i,r))},getColumnReadOnly:function(n,t){return t||n.ReadOnly},isFieldRight:function(n){return this.isIO&&n.Align=="right"&&n.ItemStyle=="AutoComplete"},addControlBehavior:function(n,t,i,r,u,f,e,o,s,h,c){var w=this.getLocationCell(n),b=w[0],y=w[1],l=i[y-1],a,v,p;n.addControl||(this.attachControl(n,l,b,y,'WebResource.axd?d=6_B8r3tInx3NyTKhjMaWxfYt1PyyrV_vdAdFQeflHh0usPrBMaO7hi-LMmvHAwWSXve9C8HDLRf_UWfvKNCxbmgh8ZGlCsUvsOiRuN_6fVt_uZJceYdiMcKsfZmeRZRxrsXSWhawj7y6YNvqWoGhJXtA5JpbgoMRq1zv4IiesxE1&t=638255301260000000'),n.addControl=!0),a=null,l.ItemStyle=="AutoComplete"&&(v=l.ItemReference,v&&v.length>0&&(p=this.findOrder(v,i),p>=0&&(a=this.findBoundControl(n.parentNode.parentNode.parentNode.childNodes[p+1].childNodes[0]),a&&!n.label&&(n.label=a)))),this.attachControlBehavior(n,i,l,b,y,l.ItemController,a,t,f,e,o,s,h,c),this.isOpr&&this.layoutGrid(r,u)},addKeyHandler:function(n,t,i,r){n.addHandler||($addHandler(n,"keydown",t),this.isOpr&&($addHandler(n,"keypress",i),$addHandler(n,"keyup",r)),n.addHandler=!0)},removeKeyHandler:function(n,t,i,r){n.addHandler&&($removeHandler(n,"keydown",t),this.isOpr&&($removeHandler(n,"keypress",i),$removeHandler(n,"keyup",r)),n.addHandler=null)},selectCell:function(n,t,i,r){t&&(this.hideImageActiveCell(t),Sys.UI.DomElement.removeCssClass(t.parentNode,"SelectCellContainer"),Sys.UI.DomElement.removeCssClass(t.parentNode.parentNode,"SelectCellContainer")),Sys.UI.DomElement.addCssClass(n.parentNode.parentNode,"SelectCellContainer"),Sys.UI.DomElement.addCssClass(n.parentNode,"SelectCellContainer"),n.a&&($common.setVisible(n.a,!0),this.resizeImageActiveCell(n),this.isOpr&&this.layoutGrid(i,r))},setTextStatus:function(n){window.status=n},getLocationCell:function(n){var t=n.id.split("_inputCell_")[1].split(".");return[parseInt(t[0]),parseInt(t[1])]},attachFields:function(n,t){this.attachHandleKey(n,t),this.attachHandleControl(n,t),this.attachHandleDirection(n,t)},attachHandleKey:function(n,t){for(var o=n.length,r,f,i,e,u=0;u<o;u++)r=n[u].HandleKey,r&&r.length>0&&(f=r.split("[")[1].split("]")[0],i=n[u],i.HandleField=f,i.HandleIndex=this.findOrder(f,t),i.HandleIndex>=0&&(e=t[i.HandleIndex],i.HandleType=e.ItemStyle=="Numeric"?"Numeric":e.Type))},attachHandleControl:function(n,t){for(var o=n.length,s,i,f,h,e,c,u,r=0;r<o;r++)i=n[r],i.HandleControl=[],i.HandleExternal=[];for(r=0;r<o;r++)s=n[r].HandleKey,s&&s.length>0&&(i=n[r],u=this.findField(i.HandleField,n),u?Array.add(u.HandleControl,r):(u=this.findField(i.HandleField,t),u&&(u=this.findField(u.HandleField,n),u&&Array.add(u.HandleExternal,[r,i.HandleIndex]))));for(r=0;r<o;r++)if(i=n[r],i.HandleExternal.length>0){for(f="",h=i.HandleExternal.length,e=0;e<h;e++)c=i.HandleExternal[e][1],u=t[c],e>0&&(f+=","),f+=String.format("{0}{1}",u.HandleKey,u.Name);f+=String.format(":{0}",i.HandleSource),i.HandleFilter||(i.ItemCheckFilter&&i.ItemCheckFilter.length>0?i.HandleFilter=i.ItemCheckFilter:i.ItemKeyFilter&&i.ItemKeyFilter.length>0&&(i.HandleFilter=i.ItemKeyFilter)),i.HandleQuery=f}},attachHandleDirection:function(n){for(var i=n.length,r,t=0;t<i;t++)if(r=n[t].HandleKey,r&&r.length>0){if(t>0){for(j=t-1;n[j].Inactivate&&j>=0;)n[j].HandleLeft=!0,j-=1;j>=0&&(n[j].HandleLeft=!0)}if(t<i-1){for(j=t+1;n[j].Inactivate&&j<i;)n[j].HandleRight=!0,j+=1;j<i&&(n[j].HandleRight=!0)}}},getObjectWhen:function(n){return Sys.UI.DomElement.containsCssClass(n,"When")},setObjectWhen:function(n,t){t?Sys.UI.DomElement.addCssClass(n,"When"):Sys.UI.DomElement.removeCssClass(n,"When")},resizeMouseDown:function(n,t,i){if(t._onResize){var r=$find(i);r._saveHeaderWidth(t,n.clientX),r._activeColumn==r._i&&this.hideImageActiveCell(r._activeCell)}},resize:function(n,t,i){var r=$find(i);r._fixedColumns>0&&t.childNodes[0]._fixedColumn||r._obj||(this.mouseResize(n,t)?(t.style.cursor=this.colResizeCursor,t._onResize=!0):(t.style.cursor="",t._onResize=null))},stopResize:function(n,t){t.style.cursor="",t._onResize=null},setHeaderWidth:function(n,t,i,r,u,f,e){var s=this,h=0,c,a,o;s.isFF&&(h=t.parentNode.parentNode.parentNode.parentNode.parentNode.scrollLeft,h>0&&(t._onResize=!0));var p=s.getObjectWidth(u),y=$get(u.id.replace("$%r","1")),v=$get(u.id.replace("$%r","$%f")),l=e+"px";for(s.setItemWidth(u,l),s.setItemWidth(y,l),h>0&&(i.parentNode.scrollLeft=h,r&&(r.scrollLeft=h)),c=t.childNodes[0].childNodes,o=1;o<c.length;o++)$render.isRenderWidth(n,o,1)&&s.setItemWidth(c[o].childNodes[f],l);for(c=i.childNodes[0].childNodes,a=c.length,o=1;o<a;o++)$render.isRenderWidth(n,o)&&s.setItemWidth(c[o].childNodes[f],l);v&&s.setItemWidth(v,l),h>0?(t.parentNode.parentNode.parentNode.parentNode.parentNode.scrollLeft=h,t._onResize=null):s.layoutGrid(t.parentNode.parentNode.parentNode.parentNode.parentNode,i.parentNode,!0,a,r);try{u.childNodes[0].headerCaption&&s.changeHeaderCaption(u.childNodes[0])}catch(w){}},layoutGrid:function(n,t,i,r,u){if(i&&u&&r==0){t.scrollLeft=n.scrollLeft,u.scrollLeft=n.scrollLeft;return}t&&(n.scrollLeft=t.scrollLeft)},layoutRow:function(n,t,i){var e,r,u,f,o;if(this.isCr)for(e=n.childNodes[0].childNodes.length-1,r=i;r<e;r++)u=n.childNodes[0].childNodes[r+1],f=t.childNodes[t.childNodes.length-1].childNodes[r+1],u&&f&&(o=u.style.width,this.setItemWidth(f,o))},beforeRemoveFirstRow:function(n,t,i){var e,r,u,f,o;if(this.isIF&&!(n.childNodes.length<=0)&&(e=n.childNodes[0].childNodes.length-1,t==1&&n.childNodes.length>1))for(r=0;r<e;r++)u=n.childNodes[0].childNodes[r+1],f=n.childNodes[1].childNodes[r+1],u&&f&&(r<i?(f._styleWidth=u._styleWidth,f.childNodes[0]._styleWidth=u._styleWidth):(o=u.style.width,this.setItemWidth(f,o)))},beforeRemoveRow:function(n,t,i,r,u,f,e,o){var c=this,s,h,v;if(!(n.childNodes.length<=0)){c.beforeRemoveFirstRow(n,u,e);var y=n.childNodes[0].childNodes.length-1,l="RowCellDefault",a="RowCellAlternating";for(s=u;s<n.childNodes.length;s++)if(h=n.childNodes[s],o&&(h.childNodes[0].childNodes[0].childNodes[0].innerHTML=s.toString()),h){for(Sys.UI.DomElement.removeCssClass(h,s%2==0?l:a),Sys.UI.DomElement.addCssClass(h,s%2==0?a:l),j=0;j<=y;j++)e>0&&j<=e&&(Sys.UI.DomElement.removeCssClass(h.childNodes[j].childNodes[0],s%2==0?l:a),Sys.UI.DomElement.addCssClass(h.childNodes[j].childNodes[0],s%2==0?a:l)),j>0&&(v=c.findBoundControl(h.childNodes[j].childNodes[0]),v&&(v.id=String.format("{0}_inputCell_{1}.{2}",t,s,j))),h.childNodes[j].id=String.format("{0}_gridCell_{1}.{2}",t,s,j);if(h.id=String.format("{0}_gridRow{1}",t,s),c.isOpr)try{h.childNodes[0].childNodes[0].style.top=s*22+"px"}catch(p){}e>0&&c.layoutPosition(n,h,s-1,f,e,!1)}(u=r)&&c.detachControlBehavior(i);c.beforeRemoveLastRow(n,u,e)}},beforeRemoveLastRow:function(n,t,i){if(t==n.childNodes.length&&t>1){var r=n.childNodes[t-2];r&&(Sys.UI.DomElement.addCssClass(r,"RowBottom"),this.highlightItem(r,i,2))}},findBoundControl:function(n){var i,t,r;if(!n.hasChildNodes())return null;if(i=n.childNodes[0],t=i.type,t=="text"||t=="hidden"||t=="checkbox")return i;for(r=1;r<n.childNodes.length;r++)if(i=n.childNodes[r],t=i.type,t=="text"||t=="hidden"||t=="checkbox")return i;return null},findField:function(n,t){for(var i,r=0;r<t.length;r++)if(i=t[r],i.Name==n)return i;return null},findOrder:function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r.Name==n)return i;return-1},findCategory:function(n,t){for(var i,r=0;r<t.length;r++)if(i=t[r],i.Index==n)return i;return null},findCategoryIndex:function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r.Index==n)return i;return-1},findMemvar:function(n,t){for(var u=null,i,r=0;r<t.length;r++)if(i=t[r],i.Name==n){u=i;break}return u},findMemvarIndex:function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r.Name==n)return i;return-1},findValue:function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r[0]==n.Index)return r[1];return null},findForm:function(n,t){for(var i,r=0;r<t.length;r++)if(i=t[r],i._controller==n)return i;return null},attachControl:function(n,t,i,r,u){var f=t.ItemStyle;f=="AutoComplete"||f=="Lookup"?this.attachLookupControl(n,i,r,u,t,t.Align):t.Type=="DateTime"&&this.attachCalendarControl(n,i,r,u,t,t.Align)},attachLookupControl:function(n,t,i,r,u,f){this.attachImageControl(n,t,i,"CellImage CellImgLookup",r,u,f)},attachCalendarControl:function(n,t,i,r,u,f){this.attachImageControl(n,t,i,"CellImage CellImgCalendar",r,u,f)},attachImageControl:function(n,t,i,r,u,f,e){n.a=$common.createElementFromTemplate({nodeName:"a",properties:{style:{border:"none",color:"#0066A7",textDecoration:"none"}},cssClasses:["CellDivContainer"]});var o=$common.createElementFromTemplate({nodeName:"img",properties:{src:u,style:{border:"none",padding:"0px"}},cssClasses:[r]});!this.isOpr||e=="right"||!f.HandleForeward?(o.tabIndex=-1,o.TabStop=!1):(o.tabIndex=n.tabIndex,o.TabStop=!0,o.onfocus=String.format("$find('{0}')._imgFocus(this);",n.id.split("_inputCell_")[0])),n.a.TabStop=!1,n.a.tabIndex=-1,n.a.appendChild(o),this.resizeImageActiveCell(n),e!="right"?n.parentNode.appendChild(n.a):n.parentNode.insertBefore(n.a,n)},attachControlBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=this,b=y.getCurPos(n),w=i.DataFormatString,p=i.ItemStyle,k=p=="Lookup";if(p=="AutoComplete"||k?y.attachAutoCompleteBehavior(n,t,i,r,u,f,e,o,s,h,c,l,a,v,k):p=="Lookup"?y.attachLookupBehavior(n,t,i,r,u,f,o,s,h,c,l,a,v):p=="Numeric"?y.attachNumericBehavior(n,r,u,o,w):i.Type=="DateTime"?y.attachCalendarBehavior(n,t,r,u,o,w,h):p=="Mask"?y.attachMaskBehavior(n,r,u,o,w):$func.isTimeFormat(i.DataFormatString)&&y.attachTimeSpanBehavior(n,r,u,o,w),b>=0&&y.setCurPos(n,b),y.isIE)try{n.select()}catch(d){}},attachAutoCompleteBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var b=this,k,d,w,g,p;if(!n._controlBehavior&&(k=b.getItemHandleKey(n,t,r,u)&&!i.OnDemand,i.Align=="right"&&(n.value=b.trim(n.value)),d=!1,w=i.ItemNew,w&&w.length>0&&(d=!0),w=="Default"&&(w=i.ItemController),g={id:o+"_GridLookup"+r+"."+u,allowNew:d,baseUrl:l,dirController:w,controller:f,cookie:s,language:h,currentPrefix:n.value,dirService:a,dirMethod:v,servicePath:c},y&&(g.multipleSelection=!0),p=n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridLookup,g,null,null,n),n.grid.get_element().parentForm&&p._grant(n.grid.get_element().parentForm),y||p.set_label(e),k?p._pending=!0:p.set_button(n.a.childNodes[0]),i.Align=="right"&&(p.set_completionValueAlign("right"),p.set_padSize(i.MaxLength)),i.ItemNormalCase&&p.set_upperCase(!1),i.ItemKeyFilter&&p.set_completionKeyFilter(b.completionFilter(n,t,i.ItemKeyFilter,r,o)),i.ItemCheckFilter&&p.set_completionCheckFilter(b.completionFilter(n,t,i.ItemCheckFilter,r,o)),!y&&e)){try{b.setTextStatus(e.value)}catch(nt){}i.ItemRowCount>0&&!k&&p.set_initLabel(!0)}},requireResource:function(n,t,i){var r;document.$dictionary||(document.$dictionary={});var f=document.$dictionary,u=this.resolveClientUrl(t,i),e=String.format("Resource{0}{1}",n,u);f[e]||(r=document.createElement(n),n=="script"?r.src=u:(r.rel="stylesheet",r.href=u),document.getElementsByTagName("head")[0].appendChild(r),f[e]=!0)},getUrlParameter:function(n,t){t||(t=window.location.href),n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},parentForm:function(n){var i=n._element,t=i.grid;return n._showOnForm?i.parentForm:t&&t._element?t._element.parentForm:null},inactiveForm:function(n,t,i,r){var f=n._element,u;f&&(i&&(f.show=t),u=this.parentForm(n),u&&(r&&!t?window.setTimeout(String.format("try{{$find('{0}')._inactive=!1;}}catch(ex){{}}",u._id),1):u._inactive=t))},_grant:function(n,t){var r=null,i;if(n&&n._grant){if(i=n._grant,t&&(t==1&&!i.request||t==2&&!i.handle))return null;var f=i.form,e=f._action,u="";i.field?u=f.getItemValue(i.field):i.script&&(u=new Function("instance",i.script)(n)),r={ID:i.id,Action:e,Value:u},t&&(r.Controller=i.controller,t==1&&(r.Pattern=n.value))}return r},attachNumericBehavior:function(n,t,i,r,u){n._controlBehavior||(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridNumeric,{id:r+"_GridNumeric"+t+"."+i,format:u},null,null,n))},attachCalendarBehavior:function(n,t,i,r,u,f,e){!n._controlBehavior&&n.a&&(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridCalendar,{id:u+"_GridCalendar"+i+"."+r,language:e},null,null,n),this.getItemHandleKey(n,t,i,r)||n._controlBehavior.set_button(n.a.childNodes[0]))},attachMaskBehavior:function(n,t,i,r,u){n._controlBehavior||(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridMask,{id:r+"_GridMask"+t+"."+i,format:u},null,null,n))},attachTimeSpanBehavior:function(n,t,i,r,u){n._controlBehavior||(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.TimeSpan,{id:r+"_GridTimeSpan"+t+"."+i,format:u},null,null,n))},detachControlBehavior:function(n){this.detachContextMenu(n),n._controlBehavior&&(n._controlBehavior.dispose(),n._controlBehavior=null)},completionFilter:function(n,t,i,r,u){var f,p,c,y;i=this.replace(i,"[$","[R");for(var s=new Sys.StringBuilder,nt,b=/([\s\S]*?)\{([\s\S]*?)\}/g,w=0,h=b.exec(i);h;){if(w=h.index+h[0].length,s.append(h[1]),f=h[2],p=null,f){f=f.replace("$%c",String.format("{0}_inputCell_",u)).replace("$%r",r).replace("$%id",u);var k=/([\s\S]*?)\[([\s\S]*?)\]/g,a=new Sys.StringBuilder,l=0,e=k.exec(f);for(o=null;e;){if(l=e.index+e[0].length,a.append(e[1]),c=e[2],c.startsWith("R")){var g=$func.right(c,c.length-1),d=n.grid.get_element().parentForm,v=d.getItem(g);v&&(o=v.field.Type=="DateTime"?this.formatDateOrder(d.getItemValue(g)):v.value),p=!0}else y=this.findOrder(c,t),y>=0&&a.append(y+1),l<f.length&&s.append(f.substring(l)),nt=a.toString();e=k.exec(f)}p?o&&s.append(o.replace(/\x27/g,"''")):(o=$get(nt),o&&s.append(o.value.replace(/\x27/g,"''")))}h=b.exec(i)}return w<i.length&&s.append(i.substring(w)),s.toString()},showImageActiveCell:function(n){n&&n.a&&($common.setVisible(n.a,!0),this.resizeImageActiveCell(n))},hideImageActiveCell:function(n){n&&n.a&&(n._calendarExtender&&n._calendarExtender.hide(),$common.setVisible(n.a,!1),n.style.width="100%")},resizeImageActiveCell:function(n){n.style.width=this.getObjectWidth(n.parentNode)-(n.parentNode._fixedColumn?25:24)+"px"},mouseResize:function(n,t){var i=n.clientX,u=t.offsetWidth,f=t.offsetLeft,e=this.pos(t.offsetParent),r=e+f+u-t.offsetParent.offsetParent.offsetParent.offsetParent.scrollLeft;return i>r-10&&i<r+10},trim:function(n){return n?n.replace(/^\s+|\s+$/g,""):""},padLeft:function(n,t){return $common.padLeft(this.trim(n),t)},padRight:function(n,t){return $common.padRight(this.trim(n),t)},pos:function(n){var t=0;if(n.offsetParent)for(t=n.offsetLeft;n=n.offsetParent;)t+=n.offsetLeft;return t},vertex:function(n){var t=0;if(n.offsetParent)for(t=n.offsetTop;n=n.offsetParent;)t+=n.offsetTop;return t},setItemWidth:function(n,t){n&&(n.style.width=t,n.childNodes[0].style.width=t)},getObjectWidth:function(n){return $common.getBounds(n).width},getCurPos:function(n){if(n.type!="text")return-2;if(n.selectionStart==null&&n.createTextRange){var t=document.selection.createRange().duplicate();return(t.moveEnd("character",n.value.length),t.text=="")?n.value.length:n.value.lastIndexOf(t.text)}return n.selectionStart},setCurPos:function(n,t){n.type=="text"&&(t>n.value.length&&(t=n.value.length),this.setSelectionRange(n,t,t))},setSelectionRange:function(n,t,i){if(n.setSelectionRange)n.setSelectionRange(t,i);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r.select()}},clearEvent:function(n){n.stopPropagation&&n.stopPropagation(),this.removeSlection()},removeSlection:function(){if(document.selection)try{document.selection.empty()}catch(n){}else window.getSelection&&window.getSelection().removeAllRanges()},cancelEvent:function(n){var t="undefined";typeof n.returnValue!==t&&(n.returnValue=!1),typeof n.cancelBubble!==t&&(n.cancelBubble=!0),typeof n.preventDefault!==t&&n.preventDefault(),typeof n.stopPropagation!==t&&n.stopPropagation()},keyCode:function(n){return s=0,n.keyIdentifier&&(n.charCode==63272?s=46:n.charCode==63302?s=45:n.charCode==63233?s=40:n.charCode==63235?s=39:n.charCode==63232?s=38:n.charCode==63234?s=37:n.charCode==63273?s=36:n.charCode==63275?s=35:n.charCode==63277?s=34:n.charCode==63276?s=33:n.charCode==3&&(s=13)),s==0&&n.charCode&&(s=n.charCode),s==0&&(s=n.keyCode),s},rawEvent:function(n){return this.isOpr?n.type=="keydown"?!0:typeof n.rawEvent.which!="undefined"&&n.rawEvent.which!=null?n.rawEvent.which==0?!0:!1:!1:!0},isNavKey:function(n){var t=this.keyCode(n);switch(t){case 9:return!0;case 33:return this.rawEvent(n);case 34:return this.rawEvent(n);case 35:return!0;case 36:return!0;case 37:return this.rawEvent(n);case 38:return this.rawEvent(n);case 39:return this.rawEvent(n);case 40:return this.rawEvent(n);case 67:case 99:return n.ctrlKey}return!1},defaultString:function(n){var t=n.DataFormatString;switch(n.Type){case"String":return"";case"Boolean":return!1;case"DateTime":return this.dateBlank(t)}return t.length>0&&t.indexOf("#")>-1?this.numberFormat(0,t):""},stringToValue:function(n,t,i){var r=t.DataFormatString;switch(t.Type){case"SByte":case"Byte":case"Int16":case"Int32":case"UInt32":case"Int64":case"Single":case"Double":case"Decimal":return this.trim(n)==""?0:this.stringToNumeric(n);case"Boolean":return Boolean.parse(n);case"DateTime":return n==this.dateBlank(r)?null:r&&r.length?this.offsetDate(Date.parseLocale(n,r),i):Date.parse(n);case"String":return n}return n},offsetDate:function(n,t){if(t)return n;if(n){var r=n.getHours()*60-n.getTimezoneOffset(),i=new Date(n.getFullYear(),n.getMonth(),n.getDate());return i.setMinutes(r),i.z=n,i}return n},stringToNumeric:function(n){return n&&typeof n=="string"?Number.parseLocale(n.replace(Sys.CultureInfo.CurrentCulture.numberFormat.CurrencySymbol,"").replace(/ /g,"")):n},valueToFormatString:function(n,t,i,r){var u=t;u||(u="");switch(i.Type){case"String":return n==null?"":r?n:this.htmlAttributeEncode(n);case"Boolean":return n==null?!1:n;case"DateTime":return u&&u.length>0?n==null||n==""?this.dateBlank(u):n.format(u):n}return u.length>0&&u.indexOf("#")>-1?(n=n==null?0:n,this.numberFormat(n,u)):n==null?"":n},valueToString:function(n,t,i){return this.valueToFormatString(n,t.DataFormatString,t,i)},dateBlank:function(n){return n.replace(/y/gi," ").replace(/M/gi," ").replace(/d/gi," ").replace(/h/gi," ").replace(/s/gi," ")},formatValue:function(n,t){return t.length>0&&t.indexOf("#")>-1?numberFormat(n,t.replace(/{0:/g,"").replace(/}/g,"")):String.localeFormat(t,n)},round:function(n,t){return Math.round(n*Math.pow(10,t))/Math.pow(10,t)},scaleLength:function(n){var t=n.indexOf(".")+1;return t>0&&(t=n.length-t),t},numberFormat:function(n,t){for(var r,f,u,e,h,c,o,s="",i=t.length;i>0&&!(this.mid(t,i,1)=="#")&&!(this.mid(t,i,1)=="0");)s=this.mid(t,i,1)+s,i=i-1;for(t=this.left(t,i),o="",i=1;i<t.length&&this.mid(t,i,1)!=="#"&&this.mid(t,i,1)!=="0";)o=o+this.mid(t,i,1),i=i+1;if((t=this.right(t,t.length-i+1),n==0&&t.indexOf("0")<0&&s==""&&o=="")||n==0&&t.indexOf("0.")<0&&t.indexOf(".")>0&&s==""&&o=="")return"";if(u=t.indexOf(".")+1,u>0&&(u=t.length-u),n=this.round(n,u),e=this.str(n,u),u>0&&(u=u+1),r=this.right(e,u),u>0){for(i=1;this.right(r,1)=="0"&&this.mid(t,t.length-i+1,1)=="#";)r=this.left(r,r.length-1),i=i+1;r=="."&&(r="")}for(i=u+1,f=u+1;i<=t.length&&f<=e.length;)h=this.mid(t,t.length-i+1,1),c=this.mid(e,e.length-f+1,1),h!=="#"&&h!=="0"?f==e.length&&n<0?i=i+1:(r=h+r,i=i+1):(r=c+r,i=i+1,f=f+1);for(f<=e.length&&(r=this.left(e,e.length-f+1)+r);i<=t.length&&this.mid(t,i-f+1,1)=="0";)r="0"+r,i=i+1;return o+r+s},mid:function(n,t,i){return n.substr(t-1,i)},left:function(n,t){return this.mid(n,1,t)},right:function(n,t){return this.mid(n,n.length-t+1,t)},str:function(n,t){var r,u;if(t==0)return String(n);if(n==0)return"0."+this.replicate(0,t);r="",n<0&&(r="-",n=-n);var e=Math.pow(10,t),i=String(Math.round(n*e)),f=i.length;return f<t?r+"0."+this.replicate(0,t-f)+i:(u=f-t,i.substring(0,u)==""?r+"0."+i.substring(u):r+i.substring(0,u)+"."+i.substring(u))},replicate:function(n,t){for(var i="",r=0;r<t;r++)i=i+n;return i},getColumnAlign:function(n){if(n.Align&&n.Align.length>0)return n.Align;switch(n.Type){case"SByte":case"Byte":case"Int16":case"Int32":case"UInt32":case"Int64":case"Single":case"Double":case"Decimal":return"right";case"Boolean":return"center";case"DateTime":return"center"}return""},compress:function(n){var r,y,e,i,p,h,l,w;n=String.fromCharCode(74)+n;var c=256,o="",t=0,a=0,b=c,s={},v=[],u="",f="";for(r=0;r<c;r++)o+=String.fromCharCode(224),s[String.fromCharCode(r)]=r;for(r=0,y=n.length;r<y;r++)e=n.charAt(r),i=e.charCodeAt(0),i>255?(p=i,i=this.specialCode(i),p!=i?(e=String.fromCharCode(i),a++,t++,t>=c&&(u+=o,t=0)):(t>0&&(u+=o.substr(0,t),t=0),u+=String.fromCharCode(parseInt(i/256)))):(a++,t++,t>=c&&(u+=o,t=0)),h=f+e,s[h]?f=h:(i>255&&(e=String.fromCharCode(i%256)),v.push(s[f]),s[h]=b++,f=""+e);return f!=""&&v.push(s[f]),t>0&&(u+=o.substr(0,t)),l=this.cipher(this.encodeBinary(v)),n.length!=a?(w=this.cipher(this.encodeBinary(this.shorten(u))),l+"=="+w):l},shorten:function(n){for(var f=[],s=256,r={},i="",o,e,u,t=0;t<256;t++)r[String.fromCharCode(t)]=t;for(t=0,o=n.length;t<o;t++)e=n.charAt(t),u=i+e,r[u]?i=u:(f.push(r[i]),r[u]=s++,i=""+e);return i!=""&&f.push(r[i]),f},encodeBinary:function(n){for(var e=256,u=[],r=8,i=0,t=0,f=0,o=n.length;f<o;f++)for(i=(i<<r)+n[f],t+=r,e++,e>>r&&r++;t>7;)t-=8,u.push(i>>t),i&=(1<<t)-1;return u.push(t?i<<8-t:""),u},cipher:function(n){for(var r=[],u=0,t=0,e="",i,f=0,o=n.length;f<o;f++)i=n[f],i>127&&(i-=128,t+=Math.pow(2,u)),r.push(this.specialChar(i)?"="+String.fromCharCode(i+16):String.fromCharCode(i)),u++,u>6&&(e+=(this.specialChar(t)?"="+String.fromCharCode(t+16):String.fromCharCode(t))+r.join(""),r=[],t=0,u=0);return e+=(this.specialChar(t)?"="+String.fromCharCode(t+16):String.fromCharCode(t))+r.join("")},specialChar:function(n){return n==0||n==34||n==37||n==38||n==39||n==43||n==61||n==92},specialCode:function(n){switch(n){case 8364:n=128;break;case 8218:n=130;break;case 402:n=131;break;case 8222:n=132;break;case 8230:n=133;break;case 8224:n=134;break;case 8225:n=135;break;case 710:n=136;break;case 8240:n=137;break;case 352:n=138;break;case 8249:n=139;break;case 338:n=140;break;case 381:n=142;break;case 8216:n=145;break;case 8217:n=146;break;case 8220:n=147;break;case 8221:n=148;break;case 8226:n=149;break;case 8211:n=150;break;case 8212:n=151;break;case 732:n=152;break;case 8482:n=153;break;case 353:n=154;break;case 8250:n=155;break;case 339:n=156;break;case 382:n=158;break;case 376:n=159}return n},getResources:function(l,resources,r){var _v=String.format("l=='v'?resources.{0}.v:resources.{0}.e",r);try{return eval(_v)}catch(ex){return null}return null},htmlEncode:function(n){return n?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n},htmlAttributeEncode:function(n){return n?n.replace(/\x27/g,"&#39;").replace(/\x22/g,"&quot;"):n}},$func=new FastBusiness.AjaxControlExtender.GridFunction,FastBusiness.AjaxControlExtender.GridRender=function(){},FastBusiness.AjaxControlExtender.GridRender.prototype={G5:function(n,t,i,r,u,f,e,o,s,h,c,l){var y=this,a,v;for(n.append(String.format('<tr style="height:{0}px;" id="{1}_gridHeader" class="GridHeader">',c?"60":"30",r)),y.G9(n,r),a=0;a<i.length;a++)v=i[a],y.G4(n,i,v,r,a,v.Width,v.HeaderText,u,f,e,o,s,h,c,l);n.append("</tr>"),t&&t.length&&y.G19(n,t,i,r+"_header_freeze",f,!0,null,!0)},G19:function(n,t,i,r,u,f,e,o,s,h){for(var l=t.length,c=0;c<l;c++)this.G14(n,t[c],l,i,r,u,f,c,e,o,s,h)},G14:function(n,t,i,r,u,f,e,o,s,h,c,l){var v=this,y,a,p;for(v.G15(n,u,i,o,h,c),v.G10(n,u,o,s),y=0;y<r.length;y++)a=r[y],p=!1,!h&&a.HandleKey&&a.HandleKey.length>0&&(p=v.handleKeyValue(t,a)),v.G11(n,a,u,f,e,i,o,y,a.Width,$func.valueToString(t[a.Index],a),$func.getColumnAlign(a),p,h);v.G18(n,u,i,o,l)},createRowBlank:function(n,t,i,r,u,f,e,o,s,h){var v=this,y=v.createRow(r,t,e),l,c,a,p,b,w;for(v.createIndexCellRow(y,r,e,s),l=0;l<i.length;l++)c=i[l],a=v.clientDefaultValue(n,c,l),o&&(a=n[l]),c.Type=="DateTime"&&a&&a.z&&(a=a.z),p=!1,c.HandleKey&&c.HandleKey.length>0&&(p=c.When&&c.When.length>0?c.When=="when"?!0:!1:v.handleDefaultValue(n,c,i,l)),v.createItemBlank(y,c,r,u,f,t,e,l,c.Width,$func.valueToString(a,c),$func.getColumnAlign(c),p);return h&&(b=$common.createElementFromTemplate({nodeName:"div",properties:{style:{width:"17px"}}}),w=$common.createElementFromTemplate({nodeName:"td",properties:{style:{visibility:"hidden"}},cssClasses:["HiddenBottom"]}),w.appendChild(b),y.appendChild(w)),y},G11:function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v=this;v.G12(n,t,i,e,o,s,h,c,a),v.G16(n,t,f,e,o,s,h,c,a),v.G0(n,t,i,r,u,e,o,s,h,c,l,a),v.G17(n,t,f,e,o,s,h,c),v.G13(n,t,i,e,o,s,h,c)},createItemBlank:function(n,t,i,r,u,f,e,o,s,h,c,l){var a=this.createItem(t,i,e,o,s,h,c),v=this.createRowCellContainer(t,f,e,o,s,h,c);v.innerHTML=this.getCellInputTag(t,i,r,u,e,o,s,h,c,l),a.appendChild(v),n.appendChild(a)},G10:function(n,t,i,r){this.G6(n,t,i),this.G7(n,r?i+1:0),this.G8(n,t,i)},createIndexCellRow:function(n,t,i,r){var u=this.createIndexCell(t,i),f=this.createIndexCellContainer(i,r);u.appendChild(f),n.appendChild(u)},G15:function(n,t,i,r,u,f){f||(f=0);var e=(r+f)%2==0?"RowCellDefault":"RowCellAlternating",o=r==i-1,s=o?" HeaderBottom":"";n.append(u?String.format('<tr class="{0}{1}">',e,s):String.format("<tr id=\"{0}_gridRow{1}\" class=\"{2} {3}\" onmouseover=\"Sys.UI.DomElement.addCssClass(this,'Highlight');$find('{0}')._highlightItem(this,0);\" onmouseout=\"Sys.UI.DomElement.removeCssClass(this,'Highlight');$find('{0}')._highlightItem(this,1);\">",t,r+1,e,o?"RowBottom":""))},G18:function(n,t,i,r,u){n.append(String.format("{0}<\/tr>",u?String.format('<td style="visibility:hidden"{0}><div style="width:17px"><\/div><\/td>',r==i-1?' class="HiddenBottom"':""):""))},createRow:function(n,t,i){var r=$common.createElementFromTemplate({nodeName:"tr",properties:{id:String.format("{0}_gridRow{1}",n,i+1)},cssClasses:i%2==0?i==t-1?["RowCellDefault","RowBottom"]:["RowCellDefault"]:i==t-1?["RowCellAlternating","RowBottom"]:["RowCellAlternating"]});return r.setAttribute("onmouseover",String.format('Sys.UI.DomElement.addCssClass(this, "Highlight");$find("{0}")._highlightItem(this, 0);',n)),r.setAttribute("onmouseout",String.format('Sys.UI.DomElement.removeCssClass(this, "Highlight");$find("{0}")._highlightItem(this, 1);',n)),r},G7:function(n,t){n.append(String.format('<div style="width:24px;height:21px;">{0}</div>',t?String.format('<div style="width:100%;display:inline-block;overflow:hidden;text-align:center;padding-top:4px;color:#8f8faf;">{0}</div>',t):""))},createIndexCellContainer:function(n,t){var i=$common.createElementFromTemplate({nodeName:"div",properties:{style:{width:"24px",height:"21px"}}}),r;return t&&(r=$common.createElementFromTemplate({nodeName:"div",properties:{innerHTML:(n+1).toString(),style:{width:"100%",display:"inline-block",overflow:"hidden",textAlign:"center",paddingTop:"4px",color:"#8f8faf"}}}),i.appendChild(r)),i},G9:function(n,t){n.append(String.format('<td style="width:24px;" class="IndexCellHeader" id="{0}_gridCell_$%r.0">',t)),this.G7(n),n.append("</td>")},G6:function(n,t,i){n.append(String.format('<td style="width:24px;" class="{2} {3}" id="{0}_gridCell_{1}.0">',t,i+1,"IndexCellBody",""))},G8:function(n,t,i){$func.isOpr&&n.append(String.format('<a style="top:{0}px;left:0px;height:1px;width:0px;position:absolute;overflow:hidden;">&nbsp;</a>',(i+1)*22)),n.append("</td>")},createIndexCell:function(n,t){var i=$common.createElementFromTemplate({nodeName:"td",properties:{id:String.format("{0}_gridCell_{1}.0",n,t+1),style:{width:"24px"}},cssClasses:["IndexCellBody"]});return $func.isOpr&&t<3&&(i.innerHTML=String.format('<a style="top:{0}px;left:0px;height:1px;width:0px;position:absolute;overflow:hidden;">&nbsp;</a>',(t+1)*22)),i},G4:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){n.append(String.format('<td nowrap onmouseover="$func.resize(event,this,\'{0}\');" onmousemove="$func.resize(event,this,\'{0}\');" onmousedown="$func.resizeMouseDown(event,this,\'{0}\');" onmouseout="$func.stopResize(event,this);" style="overflow:hidden;width:{2}px;{3}{4}" class="HeaderCellDefault{5}" id="{0}_gridCell_$%r.{1}">',r,u+1,f,i.Visible?"":"display:none;",$func.isIx?"height:30px":"",l&&!i.AllowNulls&&!i.ReadOnly?" Required "+$func.replace(a,".","_"):"")),n.append(String.format('<div align="center" style="display:inline-block;overflow:hidden;{0}width:{1}px;vertical-align:middle;{2}" class="HeaderCellContainer{3}"{4}',v?"padding-top:8px;height:17px;":"",f,"",$func.isFieldRight(i)?" CellAlignRight":"",i.AllowSorting||i.AllowFilter?String.format('<a><span id="{0}_Header{1}" style="width:3px">&nbsp;</span></a>',r,u+1):"")),this.G1(n,t,i,r,e,o,s,h,c,y),n.append("</div>"),v&&this.G96(n,t,i,r,s,h,y),n.append("</td>")},G96:function(n,t,i,r,u,f,e){n.append('<div class="FilterPanel">'),i.AllowFilter&&!e&&(n.append(String.format('<span id="{0}_FilterPanelButton{1}" class="FilterPanelButton FilterPanelBackground{2}">&nbsp;</span>',r,i.Name,i.FilterPanelReference?i.FilterPanelReference:"10")),n.append(String.format('<input id="{0}_FilterPanelText{1}" type="text" tabstop="false" tabindex="-1" autocomplete="off" spellcheck="false" style="text-align:{2};" class="FilterPanelText" value="{3}" onkeypress="$find(\'{0}\').R0(this,event,{4})"/>',r,i.Name,$func.getColumnAlign(i),i.FilterPanelValue?$func.htmlAttributeEncode(i.FilterPanelValue.toString()):"",i.Index))),n.append("</div>")},G1:function(n,t,i,r,u,f,e,o,s,h){i.AllowSorting?(n.append(String.format('<a href="#" onclick="$find(\'{0}\').sort(\'{1}\');return false" id="{0}_HeaderText_{1}" title="{3}">{2}</a>',r,i.Name,u,String.format($func.getResources(e,o,"HeaderFilter.SortBy"),u))),s!=null&&s.startsWith(i.Name+" ")&&n.append(s.endsWith(" asc")?'<span class="HeaderSortUp">&nbsp;</span>':'<span class="HeaderSortDown">&nbsp;</span>'),this.G99(n,t,i,r,f,e,o,h)):(n.append(String.format('<span id="{0}_HeaderText_{1}" class="GridHeaderText">{2}</span>',r,i.Name,u)),this.G99(n,t,i,r,f,e,o,h))},G99:function(n,t,i,r,u,f,e,o){if(i.AllowFilter&&!o){var h="<span onclick=\"$find('{0}').",c=');return false" title="{2}" class="',s='">&nbsp;</span>',l=$func.findOrder(i.Name,t),a=$func.filterOf(i,u)!=null,v=a?String.format(h+"applyFilterByIndex({1},-1"+c+"HeaderClear"+s,r,l,String.format($func.getResources(f,e,"HeaderFilter.ClearFilter"),i.HeaderText)):'<span style="width:7px;padding-left:3px;padding-right:3px;margin-left:-2px'+s;n.append(String.format(h+"showCustomFilter({1},1"+c+'{3}Filter" id="{0}_CustomFilterHeader{1}"style="cursor:default'+s+"{4}",r,l,$func.getResources(f,e,"HeaderFilter.CustomFilterOption"),a?"":"Header",v))}},G3:function(n,t,i,r,u){var e=r?" AggregationBackground":"",o=r?" AggregationLayout":"",f;for(r||n.append(String.format('<div id="{0}_divSplit" class="SplitStyle" tabindex=-1 TabStop=false style="position:relative;top:0px;left:0px;height:8px;outline:none;"><\/div>',i)),n.append(String.format('<div id="{0}_divFooter" class="FooterStyle{1}" tabindex=-1 TabStop=false style="position:relative;top:0px;left:0px;overflow-y:hidden;height:{2}px;outline:none;">',i,e,r?40:22)),n.append(String.format('<table id="{0}_gridFooter" class="GridTable" cellpadding="0" cellspacing="0"><tbody><tr id="{0}_gridFooter" class="GridFooter">',i)),n.append(String.format('<td id="{0}_gridCell_$%f.0" style="width:24px;" class="IndexCellFooter"><div{1} style="width:24px;height:17px;"><\/div><\/td>',i,r?String.format(' class="{0}{1}"',e,o):"")),f=0;f<t.length;f++)this.G2(n,t[f],i,f,t[f].Width,r,e,o);u&&n.append('<td style="visibility:hidden"><div style="width:17px"><\/div><\/td>');n.append("<\/tr><\/tbody><\/table><\/div>")},G2:function(n,t,i,r,u,f,e,o){var h,s;n.append(String.format('<td nowrap style="overflow:hidden;width:{2}px;{3}" class="FooterCellDefault" id="{0}_gridCell_$%f.{1}">',i,r+1,u,t.Visible?"":"display:none;"));n.append(String.format('<div align="right" style="display:inline-block;overflow:hidden;{0}width:{1}px;vertical-align:middle;height:17px;" class="FooterCellContainer{2}{3}{4}">',f?"":"z-index:-1;",u,$func.isFieldRight(t)?" FooterAlignRight":"",e,o));h="";f&&(s=$func.findValue(t,f),h=s==null?"":s?$func.valueToString(s,t):"-");n.append(String.format("{0}<\/div><\/td>",h))},G12:function(n,t,i,r,u,f,e,o,s){n.append(String.format('<td nowrap style="overflow:hidden;{3}{6}{7}" class="{4} {5}" id="{0}_gridCell_{1}.{2}">',i,r+1,u+1,this.isRenderWidth(t,r,s)?String.format("width:{0}px;",f):"","CellDefault","",o?String.format("text-align:{0};",o):"",t.Visible?"":"display:none;"))},G13:function(n){n.append("</td>")},createItem:function(n,t,i,r,u,f,e){var o=$common.createElementFromTemplate({nodeName:"td",properties:{id:String.format("{0}_gridCell_{1}.{2}",t,i+1,r+1),nowrap:"",style:this.isRenderWidth(n,i)?{width:u+"px",overflow:"hidden",textAlign:e,verticalAlign:"middle"}:{overflow:"hidden",textAlign:e,verticalAlign:"middle"}},cssClasses:["CellDefault"]});return o.noWrap=!0,n.Visible||$common.setVisible(o,!1),o},G16:function(n,t,i,r,u,f,e,o,s){n.append(String.format('<div style="{0}vertical-align:middle;{1}" class="RowCellContainer{2}">',this.isRenderWidth(t,r,s)?String.format("width:{0}px;",f):"","",($func.isFieldRight(t)?" CellAlignRight":"")+(r<i-1&$func.isFF?" CellPaddingTop":"")))},G17:function(n){n.append("</div>")},createRowCellContainer:function(n,t,i,r,u){return $common.createElementFromTemplate({nodeName:"div",properties:{style:this.isRenderWidth(n,i)?{width:u+"px",verticalAlign:"middle"}:{verticalAlign:"middle"}},cssClasses:$func.isFieldRight(n)?["RowCellContainer","CellAlignRight"]:["RowCellContainer"]})},getCellInputTag:function(n,t,i,r,u,f,e,o,s,h){var c=new Sys.StringBuilder;return this.G0(c,n,t,i,r,u,f,e,o,s,h),c.toString()},G0:function(n,t,i,r,u,f,e,o,s,h,c,l){var y=t.Type,a=y!="Boolean",v;if(t.Hidden){n.append(String.format('<input id="{0}_inputCell_{1}.{2}" type="{3}" value="{4}" {5}/>',i,f+1,e+1,a?"hidden":"checkbox",a?s:"",a?"":s?"checked":""));return}l?n.append(String.format('<input type="text" readonly="readonly" tabindex=-1 TabStop=false value="{0}" class="CellInput TextInput" {1}/>',a?s:"",h?String.format('style="text-align:{0};"',h):"")):(v=$func.contextMenu(r),n.append(String.format('<input id="{0}_inputCell_{1}.{2}" ondrop="return false" spellcheck="false" autocomplete="off" {3} onfocus="$find(\'{0}\')._focus(this);" onblur="$find(\'{0}\')._blur(this);" class="CellInput {11} {12}" type="{6}" value="{4}" {7} {5} {8} {9} {10} {13} {14} {15}/>',i,f+1,e+1,((u||t.ReadOnly)&&$func.isIF?'readonly="readonly"':"")+(t.ClientScript?" "+$func.clientScript(t):""),a?s:"",h?String.format('style="text-align:{0};"',h):"",a?"text":"checkbox",a?"":s?"checked":"",t.Inactivate||t.HandleKey&&t.HandleKey.length>0?"tabindex=-1 TabStop=false":"",!a&(u||t.ReadOnly)?'disabled="disabled"':"",t.MaxLength&&t.MaxLength>0&&t.ItemStyle!="AutoComplete"?String.format('maxlength="{0}"',t.MaxLength):"",a?"TextInput":$func.isOpr?"CheckPadding":"CheckInput",c?"When":"",v&&v.length?String.format('oncontextmenu="{0}"',v):"",!a&&$func.isCs?String.format("onclick=\"$find('{0}')._click(this);\"",i):"",t.HyperlinkFormatString?String.format("onmouseover=\"Sys.UI.DomElement.addCssClass(this, '{0}');\" onmouseout=\"Sys.UI.DomElement.removeCssClass(this, '{0}');\" onmousedown=\"$find('{1}')._navigate(this);\"","Hyperlink",i):"")))},clientDefaultValue:function(n,t,i){var r=null;return i==null&&(i=t.Index),t.ClientDefault!=null&&(t.ClientDefault=="Default"?n&&n.length>0&&(r=n[i]):r=t.ClientDefault),r},handleDefaultValue:function(n,t,i,r){var e=t.HandleKey,u,f;return e&&e.length>0?(u=$func.findOrder(t.HandleField,i),u<0)?!1:(f=this.clientDefaultValue(n,i[u],r),f)?this.handleKeyValue(n,t,!0,f):!1:!1},handleKeyValue:function(n,t,i,r){if(t.HandleIndex<0)return!1;var u;return u=i?r:n[t.HandleIndex],this.handleItemValue(u,t.HandleField,t.HandleKey,t.HandleType)},handleItemValue:function(n,t,i,r){var f,u;return(f=r=="Boolean"?String.format("{0}",n?"true":"false"):r=="Numeric"?String.format("{0}",n):r=="String"?String.format("'{0}'",n.replace("'","'")):String.format("{0}",n),u=$func.replace(i,String.format("[{0}]",t),f),u)?eval(u):!1},isRenderWidth:function(n,t,i){return $func.isIF&!i?t==0||$func.isFieldRight(n):!0},renderGrid:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var b=!0,k=y?y.length:0;n.append(String.format('<div id="{0}_divHeader" class="HeaderStyle" tabindex=-1 TabStop=false style="overflow:hidden;position:relative;top:0px;left:0px;outline:none;">',u));n.append('<table cellpadding="0" cellspacing="0" style="position:relative;"><tbody><tr><td>');n.append(String.format('<table id="{0}_gridHeader" class="GridTable" cellpadding="0" cellspacing="0"><tbody>',u));$render.G5(n,y,i,u,o,f,s,h,c,l,a,v);n.append("<\/tbody><\/table>");n.append("<\/td><td>");n.append('<div tabindex=-1 TabStop=false style="position:relative;width:24px;height:24px;outline:none;"><\/div>');n.append("<\/td><\/tr><\/tbody><\/table>");n.append("<\/div>");n.append(String.format('<div id="{0}_divGrid" class="GridStyle" tabindex=-1 TabStop=false style="overflow:auto;position:relative;top:0px;left:0px;height:{1}px;{2}outline:none;">',u,e,b?"overflow-x:hidden;":""));n.append(String.format('<table id="{0}_gridTable" class="GridTable" cellpadding="0" cellspacing="0"><tbody>',u));$render.G19(n,t,i,u,f,r,c,null,k,w);n.append("<\/tbody><\/table>");n.append("<\/div>");b&&$render.G3(n,i,u,p,w)},renderTitle:function(n,t,i,r){(t&&t.length>0||i&&i.length>0)&&(n.append(String.format('<div class="{0}" tabindex=-1 TabStop=false style="display:inline-block;overflow:hidden;height:48px;width:100%;top:0px;left:0px;outline:none;">',r?"FilterStyle":"TitleStyle")),n.append('<table cellpadding="0" cellspacing="0"><tbody><tr nowrap>'),t&&t.length>0&&n.append(String.format('<td nowrap style="overflow:hidden;" class="TitleText">{0}<td>',t)),i&&i.length>0&&n.append(String.format('<tr><td nowrap style="overflow:hidden;" class="{1}">{0}<td></tr>',i,r?"InfoFilter":"SubTitleText")),n.append("</tr></tbody></table>"),n.append("</div>"))},renderToolbar:function(n,t,i,r,u,f,e,o,s,h,c,l,a){var p,v,y,w;if(i&&i.length>0||h>0){for(n.append(String.format('<div class="ToolbarStyle {0}" tabindex=-1 TabStop=false style="overflow:hidden;display:inline-block;height:26px;width:100%;top:0px;left:0px;vertical-align:middle;padding-top:2px;outline:none;">',a?a:"")),n.append('<table cellpadding="0" cellspacing="0"><tbody><tr nowrap>'),p=screen.width>1024,v=0;v<i.length;v++)y=$func.getResources(c,l,i[v][1]),w=i[v].length>2,y||(y=i[v][1]),this.renderToolbarButton(n,t,i[v][0],y,a,w,p);h>0?this.renderViewPager(n,t,u,f,e,o,s,h,c,l):n.append(String.format('<td nowrap>&nbsp;<\/td><td nowrap width="22px"><div id="{0}_Wait" style="height:22px;width:55px;border-width:0px;"/><\/td>',t));r&&n.append(String.format('<td align="right" class="GridPager" id="{0}_GridTitle" style="width:100%;"><span class="Comment">{1}<\/span><\/td>',t,r));n.append("<\/tr><\/tbody><\/table>");n.append("<\/div>")}},renderToolbarButton:function(h,g,e,b,f,d,k){if(b=="-")h.append('<td nowrap width="1">&nbsp;</td><td nowrap width="1px" style="padding:1px;background-color:white;"><div style="height:18px;width:1px;border-width:0px;background-color:#559DFF;"/></td>');else{var a="",c=b.split("$"),i=c.length,j=i>2;b=c[0];if(k&&i>1)a=c[1]?c[1]:$func.trim(b.split("(")[0]);h.append(String.format('<td nowrap width="1">&nbsp;</td><td nowrap style="{4}"><div id="{0}_ToolbarButton_{1}" class="ToolbarBackgroundImage {5}{7}" style="height:22px;{4}border-width:0px;{8}" title="{2}" {6} onmouseover="Sys.UI.DomElement.addCssClass(this,\'{5}Over{3}\');" onmouseout="Sys.UI.DomElement.removeCssClass(this,\'{5}Over{3}\');">{9}</div></td>',g,e,b,f?f:"",a?"":String.format("width:{0}px;",d?30:22),(a?"Text":"")+(d?"Group":"")+e,d?"":String.format("onclick=\"$find('{0}').executeCommand({{commandName:'{1}',commandArgument:'0'}});return false\"",g,e),a?" ToolbarTextButton"+(j?"":" ToolbarWidthButton"):"",j?String.format("max-width:{0}px;",c[2]):"",d&&a?'<span class="ToolbarGroupSpan">'+a+"</span>":a))}},A02:function(n,t,i,r,u,f){var l,c,s,o,a,e,v,h;for(n.append(String.format('<span class="Information">&nbsp;</span>{0}',$func.getResources(u,f,"InfoBar.FilterApplied"))),l=0;l<i.length;l++)if(c=i[l].match(/([\w\$]+):([\s\S]*)/),s=$func.findField(c[1],t),s&&!$func.fieldIsInExternalFilter(s,r)){n.append(String.format(f.InfoBar.ValueIs,s.HeaderText));for(var p=/(\*|\!={0,1}|\>={0,1}|\<[=,>]{0,1}|=)([\s\S]*?)(\0|$)/g,y=!0,w=$func.getResources(u,f,c[2].match(">|<")?"InfoBar.And":"InfoBar.Or");(info=p.exec(c[2]))!=null;){y?y=!1:n.append(w),o=info[2],a=o.startsWith("%")||o.startsWith("*");switch(info[1]){case"=":e=o=="null"?"Empty":"EqualTo";break;case"!=":case"<>":e="NotEqualTo";break;case"<":e="LessThan";break;case"<=":e="LessThanOrEqualTo";break;case">":e="GreaterThan";break;case">=":e="GreaterThanOrEqual";break;case"*":e=a?"Like":"StartsWith";break;case"!":e=a?"NotLike":"DoesNotStartWith"}n.append($func.getResources(u,f,"InfoBar."+e)),v=$func.findItemByValue(s,o),h=v==null?o:v[1],s.Type=="Boolean"&&(h=h=="true"?"1":h=="false"?"0":h),o!="null"&&n.append(String.format('<span class="TextHighlight">{0}</span>',$func.htmlEncode(h)))}n.append(".")}},A06:function(n,t,i,r,u,f,e,o){var h,a,w;n._adjustmentNeeded=!0;var y=n.Type,v=y=="String",b=$func.getResources(f,e,"HeaderFilter."+(v?"StringSortAscending":y=="DateTime"?"DateSortAscending":"GenericSortAscending")),k=$func.getResources(f,e,"HeaderFilter."+(v?"StringSortDescending":y=="DateTime"?"DateSortDescending":"GenericSortDescending")),l=new Sys.StringBuilder;if(n.AllowSorting&&l.append(String.format('<a href="#" onclick="$find(\'{0}\').sort(\'{1} asc\');return false" class="ContextMenuItem SortAscending">{2}</a><a href="#" onclick="$find(\'{0}\').sort(\'{1} desc\');return false" class="ContextMenuItem SortDescending">{3}</a>',i,n.Name,b,k)),t||(t=n._listOfValues),n.AllowFilter&&!o)if(t){for(h=$func.filterOf(n,u),h=h&&h.startsWith("=")?h.substr(1):h?"\x00":null,n.AllowSorting&&l.append('<div class="ContextMenuBreak"></div>'),l.append(String.format('<div id="Options"><a href="#" id="{0}_CustomFilterOption{1}" onclick="{3}if(!this.disabled)$find(\'{0}\').applyFilterByIndex({1},-1);return false" class="ContextMenuItem FilterOff{2} {2}" {3}>{4}&nbsp;</a><a href="#" onclick="$find(\'{0}\').showCustomFilter({1});return false" class="ContextMenuItem {6}">{5}</a>',i,$func.findOrder(n.Name,r),h!=null?"":"Disabled",h!=null?"":"return false;",String.format($func.getResources(f,e,"HeaderFilter.ClearFilter"),n.HeaderText),$func.getResources(f,e,"HeaderFilter.CustomFilterOption"),h&&h.indexOf("\x00")>=0?"Checked":"CustomFilter")),t.length>0&&l.append('<div class="ContextMenuBreak"></div>'),a=0;a<t.length;a++){var p=!1,c=t[a],s=c;c==null?s=$func.getResources(f,e,"HeaderFilter.EmptyValue"):n.Items.length>0?(w=$func.findItemByValue(n,c),s=w[1]):v&&$func.trim(c)==""?s=$func.getResources(f,e,"HeaderFilter.BlankValue"):n.DataFormatString!=null&&n.DataFormatString.length>0&&(s=$func.valueToString(c,n)),c=c==null?"null":$func.valueToString(c,n),p=c.toString()==h,n.Type=="Boolean"&&(s=t[a]?"1":"0"),s.length>e.HeaderFilter.MaxTextLength&&(s=s.substring(0,e.HeaderFilter.MaxTextLength)+"..."),l.append(String.format('<a href="#" onclick="$find(\'{0}\').applyFilterByIndex({1},{2});return false" class="ContextMenuItem {4}">{3}</a>',i,n.Index,a,v&&c!="null"?$func.htmlEncode(s):s==""?"0":s,p?"Checked":""))}l.append("</div>")}else l.append(String.format('<div class="Wait">{0}</div>',$func.getResources(f,e,"HeaderFilter.Loading")));n._dropDownPanel.innerHTML=l.toString()},renderViewPager:function(n,t,r,u,f,e,o,s,h,c){var a='<a href="#" onclick="$find(\'{1}\').goToPage({0});return false" class="PaddedLink">',l,p,w,v,y;if(n.append('<td nowrap width="1">&nbsp;</td><td nowrap><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td align="left" class="GridPager">'),r>1){for(l=f,p=c.Pager.PageButtonCount,o>0?n.append(String.format(a+"{2}</a>",o-1,t,$func.getResources(h,c,"Pager.Previous"))):n.append(String.format('<span class="Disabled">{0}</span>',$func.getResources(h,c,"Pager.Previous"))),n.append(String.format(" | {0}: ",$func.getResources(h,c,"Pager.Page"))),l>0&&(l>1&&n.append(String.format(a+"1</a>",0,t)),n.append(String.format(a+"...</a>",l-1,t)));p>0&&l<r;)l==o?n.append(String.format('<span class="Selected">{0}</span>',l+1)):n.append(String.format(a+"{2}</a>",l,t,l+1)),l++,p--;l<r&&(w=f+c.Pager.PageButtonCount,n.append(String.format(a+"...</a>",w,t)),w!=r-1&&n.append(String.format(a+"{2}</a>",r-1,t,r))),n.append(" | "),o<r-1?n.append(String.format(a+"{2}</a>",o+1,t,$func.getResources(h,c,"Pager.Next"))):n.append(String.format('<span class="Disabled">{0}</span>',$func.getResources(h,c,"Pager.Next")))}if(n.append('</td><td align="right" class="GridPager">&nbsp;'),v=c.Pager.PageSizes,u>s){for(n.append($func.getResources(h,c,"Pager.ItemsPerPage")),i=0;i<v.length;i++)i>0&&n.append(", "),s==v[i]?n.append(String.format("<b>{0}</b>",s)):n.append(String.format('<a href="#" onclick="$find(\'{0}\').set_gridPageSize({1});return false">{1}</a>',t,v[i]));n.append(" | ")}u>0&&(y=(o+1)*s,y>u&&(y=u),n.append(String.format($func.getResources(h,c,"Pager.ShowingItems"),o*s+1,y,u)),n.append(" | ")),n.append(String.format('</td><td align="center" class="GridPager" id="{0}_Wait" style="width:55px">',t)),n.append(String.format(a+"{2}</a>",-1,t,$func.getResources(h,c,"Pager.Refresh"))),n.append("</td></tr></table></td>")}},$render=new FastBusiness.AjaxControlExtender.GridRender,FastBusiness.AjaxControlExtender.Msg=function(n,t){this._id=n+"_DialogMessage",this._language=t},FastBusiness.AjaxControlExtender.Msg.prototype={initialize:function(){},dispose:function(){this.close()},get_id:function(){return this._id},set_id:function(n){this._id=n},get_language:function(){return this._language},set_language:function(n){this._language=n},_getResources:function(r){var _v=String.format("this._language=='v'?FastBusiness.AjaxControlExtender.Msg.Resources.{0}.v:FastBusiness.AjaxControlExtender.Msg.Resources.{0}.e",r);return eval(_v)},_bodyKeydown:function(n){if(this._dlgModalPopupBehavior){var t=this.get_id();if(n.keyCode==Sys.UI.Key.esc)n.preventDefault(),this._dlgModalPopupBehavior.hide(),this.close(),this._cancel?window.setTimeout(this._cancel,0):this._execute&&window.setTimeout(this._execute,0);else if(n.keyCode==Sys.UI.Key.left){n.preventDefault();try{$get(t+"_dlgOk").focus()}catch(i){}}else if(n.keyCode==Sys.UI.Key.right){n.preventDefault();try{$get(t+"_dlgCancel").focus()}catch(i){}}}},firm:function(n,t,i,r){this.showDialog(n,"CellImage QuestionIcon",t?1:0,i,r)},showError:function(n){var t=this._getResources("Dialog.Error"),i=String.format("Timed out: {0}\r\nException: {1}\r\nMessage: {2}\r\nStack:\r\n{3}",n.get_timedOut(),n.get_exceptionType(),n.get_message(),n.get_stackTrace());this.show(t,null,null,null,i)},show:function(n,t,i,r,u){u?this.showDialog(n,"CellImage WarningIcon",null,t,null,u):t==null?this.showDialog(n,"CellImage InformationIcon",null,null):typeof t=="string"?this.showDialog(n,"CellImage InformationIcon",null,t):this.firm(n,t,i,r)},showDialog:function(n,t,i,r,u,f){var e=this.get_id(),h=e+"_dlgModalPopupBehavior",l='WebResource.axd?d=6_B8r3tInx3NyTKhjMaWxfYt1PyyrV_vdAdFQeflHh0usPrBMaO7hi-LMmvHAwWSXve9C8HDLRf_UWfvKNCxbmgh8ZGlCsUvsOiRuN_6fVt_uZJceYdiMcKsfZmeRZRxrsXSWhawj7y6YNvqWoGhJXtA5JpbgoMRq1zv4IiesxE1&t=638255301260000000',a=FastBusiness.AjaxControlExtender.Msg.Resources.Dialog.Title,s,c,o;this._execute=r,this._cancel=u,s=this._dialogPanel=document.createElement("div"),c=this._dialogPanel.a=document.createElement("a"),document.body.appendChild(s),document.body.appendChild(c),s.className="Dialog",s.id=e+"_Dlg",Sys.UI.DomElement.setVisibilityMode(s,Sys.UI.VisibilityMode.hide),Sys.UI.DomElement.setVisibilityMode(s.a,Sys.UI.VisibilityMode.hide),o=new Sys.StringBuilder,o.append(String.format('<div id="{0}_dlgTitle" class="DlgTitle"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width:100%;"><div class="DlgTitleText">{1}</div></td></tr></tbody></table></div></div>',e,a)),o.append('<div class="DlgContainer" style="display: block;"><div style="margin:10px;display:none;"></div>'),o.append(String.format('<div class="DlgFrame" style="overflow:hidden;white-space:normal;display:block;"><div class="TaskDialog"><img class="TaskDialogIcon {0}" src="{1}">',t,l)),f?o.append(String.format('<div class="TaskDialogContent">{0}<a id="{1}_showDetail" onclick="$find(\'{2}\').parentObject.showDetail()" class="TaskDialogShowDetail"> {3}</a></div><textarea id="{1}_dlgText" style="resize:none;display:none;" class="TaskDialogText" rows="2">{4}</textarea>',n,e,h,this._getResources("Dialog.Detail"),f)):o.append(String.format('<div class="TaskDialogContent">{0}</div>',n)),o.append('<div class="TaskDialogFooter"><table width="100%" cellpadding="0" cellspacing="0">'),o.append(String.format('<tr><td width="100%" align="right"><button id="{0}_dlgOk">{1}</button>{2}</td></tr>',e,i==null?this._getResources("Dialog.Ok"):this._getResources("Dialog.Yes"),i==null?"":String.format('<button id="{0}_dlgCancel">{1}</button>',e,this._getResources("Dialog.No")))),o.append("</table></div>"),o.append("</div></div></div></div>"),s.innerHTML=o.toString(),this._dlgModalPopupBehavior=i==null?$create(FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior,{id:h,titleId:e+"_dlgTitle",OkControlID:e+"_dlgOk",OnOkScript:String.format("$find('{0}').parentObject.executeDialog()",h),PopupControlID:s.id,DropShadow:!0,BackgroundCssClass:"ModalBackground"},null,null,c):$create(FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior,{id:h,titleId:e+"_dlgTitle",OkControlID:e+"_dlgOk",CancelControlID:e+"_dlgCancel",OnOkScript:String.format("$find('{0}').parentObject.executeDialog()",h),OnCancelScript:String.format("$find('{0}').parentObject.closeDialog()",h),PopupControlID:s.id,DropShadow:!0,BackgroundCssClass:"ModalBackground"},null,null,c),this._dlgModalPopupBehavior._backgroundElement.style.zIndex=3e5,this._dlgModalPopupBehavior._foregroundElement.style.zIndex=300001,this._dlgModalPopupBehavior.parentObject=this,this._dlgModalPopupBehavior.show(),this._dialogPanel._bodyKeydownHandler=Function.createDelegate(this,this._bodyKeydown),$addHandler(document.body,"keydown",this._dialogPanel._bodyKeydownHandler),$get(e+(i?"_dlgCancel":"_dlgOk")).focus()},showDetail:function(){$common.setVisible($get(this.get_id()+"_showDetail"),!1);var n=$get(this.get_id()+"_dlgText");$common.setVisible(n,!0),$func.attachContextMenu(n,this._language,!0),this._dlgModalPopupBehavior._fixupDropShadowBehavior()},close:function(){var n=$get(this.get_id()+"_dlgText");n&&$func.detachContextMenu(n),this._dlgModalPopupBehavior&&(this._dlgModalPopupBehavior.dispose(),this._dlgModalPopupBehavior=null),this._dialogPanel&&(this._dialogPanel._bodyKeydownHandler&&($removeHandler(document.body,"keydown",this._dialogPanel._bodyKeydownHandler),this._dialogPanel._bodyKeydownHandler=null),this._dialogPanel.a&&(this._dialogPanel.a.parentNode.removeChild(this._dialogPanel.a),this._dialogPanel.a=null),this._dialogPanel.parentNode.removeChild(this._dialogPanel),this._dialogPanel=null)},executeDialog:function(){this.close(),this._execute&&window.setTimeout(this._execute,0)},closeDialog:function(){this.close(),this._cancel&&window.setTimeout(this._cancel,0)}},FastBusiness.AjaxControlExtender.Msg.Resources={Dialog:{Title:"Fast Business Online",Ok:{v:"Nhận",e:"Ok"},Yes:{v:"Có",e:"Yes"},No:{v:"Không",e:"No"},Detail:{v:"Chi tiết",e:"Detail"},Error:{v:"Có lỗi chưa xác định. Nếu bạn đang cập nhật dữ liệu, thông tin bạn vừa cập nhật có thể chưa thực hiện xong. Nhấn vào chi tiết để xem thêm thông tin về lỗi.",e:"There was an unexpected error. If you were in the middle of something, the information you were working on might be lost. Click detail for more information about this error."}}},FastBusiness.AjaxControlExtender.Key=function(n,t,i,r){this.ctrlKey=n,this.altKey=t,this.shiftKey=i,this.keyCode=r},FastBusiness.AjaxControlExtender.Key.prototype={},FastBusiness.AjaxControlExtender.ColumnEventArgs=function(n){this._object=n},FastBusiness.AjaxControlExtender.ColumnEventArgs.prototype={get_object:function(){return this._object}},FastBusiness.AjaxControlExtender.ColumnEventArgs.registerClass("FastBusiness.AjaxControlExtender.ColumnEventArgs",Sys.EventArgs),FastBusiness.AjaxControlExtender.RenderEventArgs=function(n,t){this.grid=n,this.type=t},FastBusiness.AjaxControlExtender.RenderEventArgs.registerClass("FastBusiness.AjaxControlExtender.RenderEventArgs",Sys.EventArgs),FastBusiness.AjaxControlExtender.EventArgs=function(n,t){this.object=n,this.type=t},FastBusiness.AjaxControlExtender.EventArgs.registerClass("FastBusiness.AjaxControlExtender.EventArgs",Sys.EventArgs),FastBusiness.AjaxControlExtender.ContextMenu=function(n){FastBusiness.AjaxControlExtender.ContextMenu.initializeBase(this,[n]),this._language=null,this._width=null,this._parentElement=null,this._menuItems=null,this._position=null,this._offsetX=0,this._offsetY=0,this._popupBehavior=null,this._popupKeyDownHandler=null,this._popupClickHandler=null,this._bodyClickHandler=null},FastBusiness.AjaxControlExtender.ContextMenu.prototype={initialize:function(){FastBusiness.AjaxControlExtender.ContextMenu.callBaseMethod(this,"initialize");var n=this.get_element();this._bodyClickHandler=Function.createDelegate(this,this._onBodyClick),this._popupClickHandler=Function.createDelegate(this,this._onPopupClick),this._popupKeyDownHandler=Function.createDelegate(this,this._onPopupKeyDown),$addHandler(document.body,"click",this._bodyClickHandler),$addHandler(n,"keydown",this._popupKeyDownHandler)},dispose:function(){var n=this.get_element();this._bodyClickHandler&&($removeHandler(document.body,"click",this._bodyClickHandler),this._bodyClickHandler=null),this._popupClickHandler&&(this._popupElement&&$removeHandler(this._popupElement,"click",this._popupClickHandler),this._popupClickHandler=null),this._popupKeyDownHandler&&($removeHandler(n,"keydown",this._popupKeyDownHandler),this._popupElement&&$removeHandler(this._popupElement,"keydown",this._popupKeyDownHandler),this._popupKeyDownHandler=null),this._dropShadowBehavior&&(this._dropShadowBehavior.dispose(),this._dropShadowBehavior=null),this._popupBehavior&&(this._popupBehavior.dispose(),this._popupBehavior=null),this._container&&(this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=null),this._popupDiv&&(this._popupDiv=null),FastBusiness.AjaxControlExtender.ContextMenu.callBaseMethod(this,"dispose")},get_language:function(){return this._language},set_language:function(n){this._language=n},get_width:function(){return this._width},set_width:function(n){n!=this._width&&(this._width=n)},get_parentElement:function(){return this._parentElement},set_parentElement:function(n){n!=this._parentElement&&(this._parentElement=n)},get_menuItems:function(){return this._menuItems},set_menuItems:function(n){this._menuItems=n},_initContextMenu:function(){if(!this._container){var n=this.get_element();this._buildContextMenu(),this._render(),this._popupBehavior=$create(FastBusiness.AjaxControlExtender.PopupBehavior,{parentElement:this._parentElement},{},{},this._container),this._dropShadowBehavior=$create(FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior,{popupWidth:this._width,Opacity:.1,TrackPosition:!0},null,null,this._popupDiv),this._popupBehavior.set_positioningMode(9),this._popupElement=this._container,$addHandler(this._popupElement,"click",this._popupClickHandler),$addHandler(this._popupElement,"keydown",this._popupKeyDownHandler)}},_buildContextMenu:function(){var t=this.get_element(),n=this.get_id()+"_context";this._container=$common.createElementFromTemplate({nodeName:"div",properties:{id:n+"_container"},visible:!1},this._parentElement),this._popupDiv=$common.createElementFromTemplate({nodeName:"div",properties:{id:n+"_popupDiv"}},this._container)},_render:function(){var i=new Sys.StringBuilder,u=this._width,n,e,t,f;for(i.append(String.format('<table cellpadding="0" cellspacing="0" class="ContextMenuContextTable" style="width:{0}px;table-layout:fixed;"><tr><td style="padding:0px;"><div class="ContextMenuContextPanel">',u)),t=0;t<this._menuItems.length;t++)n=this._menuItems[t],e=n.UrlImage?String.format("style=\"background-image:url('{0}');\"",n.UrlImage):"",n.CommandName==null||n.CommandName.length==0||n.HeaderText.v=="-"||n.HeaderText.e=="-"?i.append('<div class="ContextMenuBreak"></div>'):n.Disabled?i.append(String.format('<div {0} class="ContextMenuContextItemDisabled {1}"><div class="ContextMenuContextTextDisabled">{2}</div></div>',e,n.CssClass&&n.CssClass.length>0?n.CssClass:"",this._language=="v"?n.HeaderText.v:n.HeaderText.e)):i.append(String.format('<div onclick="$find(\'{0}\').hide();{1};return false;" {2} class="ContextMenuContextItem {3}"><div class="ContextMenuContextText">{4}</div></div>',this.get_id(),n.CommandName?n.CommandName:"",e,n.CssClass&&n.CssClass.length>0?n.CssClass:"",this._language=="v"?n.HeaderText.v:n.HeaderText.e));for(i.append("</div></td></tr></table>"),i.append(String.format('<table style="width:{0}px;" cellpadding="0" cellspacing="0" border="0" class="ContextMenu ContextMenuPopupTable"><tbody><tr class="ContextMenuPopupTableRow"><td class="ContextMenuCell">',u)),i.append('<table cellspacing="0" cellpadding="0" border="0" class="ContextMenuTable"><tbody><tr class="ContextMenuTableRow">'),t=0;t<u+5;t+=1){i.append('<td style="width:1px;" class="ContextMenuArrowCell">');var s=10,o=Math.round(s/2),r=t%s;r=r<o?o-r:r-o,f="",t==0?f="background-color:#868686!important;":t==1||t==26?f="background-color:#F5F5F5!important;":t>1&&t<26?f="background-color:#E9EEEE!important;":t==u-1&&(f="background-color:#868686!important;"),t<u&&i.append(String.format('<div class="ContextMenuLine" style="width:1px;height:{0}px;{1}"></div>',r,f)),t>=5&&(t>=u&&i.append(String.format('<div class="ContextMenuLine ContextMenuLineArrow" style="width:1px;height:{0}px;;opacity:0.1;;filter:alpha(opacity=10);"></div>',r)),i.append(String.format('<div class="ContextMenuLine ContextMenuLineShadow" style="height:{0}px;opacity:0.1;;filter:alpha(opacity=10);"></div>',r<5?9-2*r:0))),i.append("</td>")}i.append("</tr></tbody></table>"),i.append("</td></tr></tbody></table>"),this._popupDiv.innerHTML=i.toString()},_onBodyClick:function(){this.hide()},_onPopupKeyDown:function(n){n.keyCode==27&&this._isOpen&&(this.hide(),this.get_element().focus())},_onPopupClick:function(n){$func.cancelEvent(n)},show:function(n,t){var i,u,f,e,r,o;this._initContextMenu(),this._isOpen||(this._isOpen=!0,this._popupBehavior.show()),i=0,u=0,n||(n=window.event),n.offsetX?i=n.offsetX:n.layerX&&(i=n.layerX),n.offsetY?u=n.offsetY:n.layerY&&(u=n.layerY),f=-5,e=-15,t&&(i+=this.get_element().offsetLeft+5,f=0,e=0),r=$common.getBounds(this._container),o=$common.getClientBounds(),n.clientX+r.width>o.width&&(f=r.width-10),n.clientY+r.height>o.height&&(e=r.height),this._popupBehavior.set_x(Math.round(i-f)),this._popupBehavior.set_y(Math.round(u-e))},hide:function(){this._isOpen&&(this._container&&this._popupBehavior.hide(),this._isOpen=!1)}},FastBusiness.AjaxControlExtender.ContextMenu.registerClass("FastBusiness.AjaxControlExtender.ContextMenu",AjaxControlToolkit.BehaviorBase),FastBusiness.AjaxControlExtender.ContextMenu.Resources={Clipboard:{Cut:{v:"Cắt",e:"Cut"},Copy:{v:"Chép",e:"Copy"},Paste:{v:"Dán",e:"Paste"},Delete:{v:"Xóa",e:"Delete"},Select:{v:"Chọn tất",e:"Select all"}}},FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior=function(n){FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior.initializeBase(this,[n]),this._popupWidth=null},FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior.prototype={get_popupWidth:function(){return this._popupWidth},set_popupWidth:function(n){n!=this._width&&(this._popupWidth=n)},setShadow:function(n,t){var f=this.get_element(),e,i,r,u;this.get_isInitialized()&&f&&(this._width||n)&&(e=this._shadowDiv,e||this.buildShadowDiv(),i={x:f.offsetLeft,y:f.offsetTop},(n||this._lastX!=i.x||this._lastY!=i.y||!e)&&(this._lastX=i.x,this._lastY=i.y,u=this.get_Width(),i.x+=this._popupWidth,i.y+=u,$common.setLocation(this._shadowDiv,i)),r=f.offsetHeight,u=this.get_Width(),(n||r!=this._lastH||u!=this._lastW||!e)&&(this._lastW=u,this._lastH=r,r=Math.max(0,r-15),this._rounded&&e&&!t?(this.disposeShadowDiv(),this.setShadow()):(this._shadowDiv.style.width=u+"px",this._shadowDiv.style.height=r+"px")),this._shadowDiv&&(this._shadowDiv.style.visibility=$common.getCurrentStyle(f,"visibility")))}},FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior.inheritsFrom(AjaxControlToolkit.DropShadowBehavior),FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior.registerClass("FastBusiness.AjaxControlExtender.ArrowDropShadowBehavior",AjaxControlToolkit.DropShadowBehavior),FastBusiness.AjaxControlExtender.PopupBehavior=function(n){FastBusiness.AjaxControlExtender.PopupBehavior.initializeBase(this,[n])},FastBusiness.AjaxControlExtender.PopupBehavior.prototype={setupPopup:function(){var n=this.get_element(),t=this.getBounds();$common.setLocation(n,t),this.adjustPopupPosition(t),n.style.zIndex=3000100,this.addBackgroundIFrame()}},FastBusiness.AjaxControlExtender.PopupBehavior.inheritsFrom(AjaxControlToolkit.PopupBehavior),FastBusiness.AjaxControlExtender.PopupBehavior.registerClass("FastBusiness.AjaxControlExtender.PopupBehavior",AjaxControlToolkit.PopupBehavior),FastBusiness.AjaxControlExtender.PopupControlBehavior=function(n){FastBusiness.AjaxControlExtender.PopupControlBehavior.initializeBase(this,[n])},FastBusiness.AjaxControlExtender.PopupControlBehavior.prototype={initialize:function(){AjaxControlToolkit.PopupControlBehavior.callBaseMethod(this,"initialize");var n=this.get_element();this._popupElement=$get(this._popupControlID),this._popupBehavior=$create(FastBusiness.AjaxControlExtender.PopupBehavior,{id:this.get_id()+"PopupBehavior",parentElement:n},null,null,this._popupElement),this._onShowJson&&this._popupBehavior.set_onShow(this._onShowJson),this._onHideJson&&this._popupBehavior.set_onHide(this._onHideJson),this._focusHandler=Function.createDelegate(this,this._onFocus),this._popupClickHandler=Function.createDelegate(this,this._onPopupClick),this._bodyClickHandler=Function.createDelegate(this,this._onBodyClick),this._popupKeyDownHandler=Function.createDelegate(this,this._onPopupKeyDown),$addHandler(n,"focus",this._focusHandler),$addHandler(n,"click",this._focusHandler),$addHandler(document.body,"click",this._bodyClickHandler),$addHandler(this._popupElement,"click",this._popupClickHandler),$addHandler(this._popupElement,"keydown",this._popupKeyDownHandler),this.registerPartialUpdateEvents(),AjaxControlToolkit.PopupControlBehavior.__VisiblePopup&&this.get_id()==AjaxControlToolkit.PopupControlBehavior.__VisiblePopup.get_id()&&this._onFocus(null)}},FastBusiness.AjaxControlExtender.PopupControlBehavior.inheritsFrom(AjaxControlToolkit.PopupControlBehavior),FastBusiness.AjaxControlExtender.PopupControlBehavior.registerClass("FastBusiness.AjaxControlExtender.PopupControlBehavior",AjaxControlToolkit.PopupControlBehavior),FastBusiness.AjaxControlExtender.PanelControlBehavior=function(a){FastBusiness.AjaxControlExtender.PanelControlBehavior.initializeBase(this,[a])},FastBusiness.AjaxControlExtender.PanelControlBehavior.prototype={_getLeftOffset:function(){var b=180,d=b/2,c=FastBusiness.AjaxControlExtender.PopupControlBehavior.callBaseMethod(this,"_getLeftOffset"),f=(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)+document.documentElement.clientWidth,e=$common.getBounds(this.get_element()),a=e.x+e.width+b-f;if(a>0)c-=d;if(a>d){if(a>b)a=b;c-=a-d}return c}},FastBusiness.AjaxControlExtender.PanelControlBehavior.inheritsFrom(FastBusiness.AjaxControlExtender.PopupControlBehavior),FastBusiness.AjaxControlExtender.PanelControlBehavior.registerClass("FastBusiness.AjaxControlExtender.PanelControlBehavior",FastBusiness.AjaxControlExtender.PopupControlBehavior),FastBusiness.AjaxControlExtender.DropDownBehavior=function(n){FastBusiness.AjaxControlExtender.DropDownBehavior.initializeBase(this,[n]),this._itemHeader=null},FastBusiness.AjaxControlExtender.DropDownBehavior.prototype={initialize:function(){var n,t,i;AjaxControlToolkit.DropDownBehavior.callBaseMethod(this,"initialize"),n=this.get_element(),t=n.parentNode,this._dropDownControl==null&&$common.createElementFromTemplate({parent:t,nameTable:this,name:"_dropDownControl",nodeName:"div",visible:!1,cssClasses:this._dropDownControl?null:["ajax__dropdown_panel"],properties:{__GENERATED:!0}}),$addHandlers(this._dropDownControl,this._dropDownControl$delegates),i={},this._dropArrowImageUrl&&(i.src=this._dropArrowImageUrl),$common.createElementFromTemplate({parent:t,nameTable:this,name:"_dropFrame",nodeName:"span",visible:!1,children:[{name:"_dropFrameTop",nodeName:"div",cssClasses:["ajax__dropdown_frame_line"]},{name:"_dropFrameRight",nodeName:"div",cssClasses:["ajax__dropdown_frame_line"]},{name:"_dropFrameBottom",nodeName:"div",cssClasses:["ajax__dropdown_frame_line"]},{name:"_dropFrameLeft",nodeName:"div",cssClasses:["ajax__dropdown_frame_line"]},{name:"_dropArrow",nodeName:"div",cssClasses:this._dropArrowImageUrl?["ajax__dropdown_arrow"]:["ajax__dropdown_arrow","HeaderArrowImage"],properties:{style:{width:this._dropArrowWidth,backgroundColor:this._dropArrowBackgroundColor}},events:this._dropFrame$delegates,children:[{name:"_dropArrowWrapper",nodeName:"div",visible:!!this._dropArrowImageUrl,cssClasses:["ajax__dropdown_arrow_wrapper"],children:[{name:"_dropArrowImage",nodeName:"img",properties:i}]}]}]}),$common.createElementFromTemplate({parent:null,nameTable:this,name:"_dropWrapper",nodeName:"span",properties:{id:n.id+"_dropWrapper",style:{cursor:"default"}},events:this._dropWrapper$delegates,content:n}),this._dropPopupPopupBehavior=$create(FastBusiness.AjaxControlExtender.PopupBehavior,{positioningMode:AjaxControlToolkit.PositioningMode.BottomLeft,parentElement:n,y:-1},null,null,this._dropDownControl),this._onShowJson&&this._dropPopupPopupBehavior.set_onShow(this._onShowJson),this._onHideJson&&this._dropPopupPopupBehavior.set_onHide(this._onHideJson),this._dropWrapperHoverBehavior=$create(AjaxControlToolkit.HoverBehavior,{hoverElement:this._dropFrame.parentNode.parentNode},this._dropWrapperHoverBehavior$delegates,null,this._dropWrapper),$addHandlers(document,this._document$delegates)},get_itemHeader:function(){return this._itemHeader},set_itemHeader:function(n){this._itemHeader=n},hover:function(){this._itemHeader&&!this._isOver&&(this._oldParentBackgroundColor||(this._oldParentBackgroundColor=$common.getCurrentStyle(this._itemHeader,"backgroundColor")),this._itemHeader.style.backgroundColor=this._highlightBackgroundColor),FastBusiness.AjaxControlExtender.DropDownBehavior.callBaseMethod(this,"hover")},unhover:function(){if(this._itemHeader&&(this._isOver||!this._isOpen)){var n=this.get_element();this._isOpen||(this._oldParentBackgroundColor?(this._itemHeader.style.backgroundColor=this._oldParentBackgroundColor,this._oldParentBackgroundColor=null):this._itemHeader.style._oldParentBackgroundColor="transparent")}FastBusiness.AjaxControlExtender.DropDownBehavior.callBaseMethod(this,"unhover")}},FastBusiness.AjaxControlExtender.DropDownBehavior.inheritsFrom(AjaxControlToolkit.DropDownBehavior),FastBusiness.AjaxControlExtender.DropDownBehavior.registerClass("FastBusiness.AjaxControlExtender.DropDownBehavior",AjaxControlToolkit.DropDownBehavior),FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior=function(n){FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.initializeBase(this,[n]),this._titleId=null,this._floatingBehavior=null},FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.prototype={initialize:function(){FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.callBaseMethod(this,"initialize"),this._createFloatingBehavior();var n=$func.getLastIndex();this._backgroundElement.style.zIndex=n+1,this._foregroundElement.style.zIndex=n+2},dispose:function(){this._floatingBehavior&&(this._floatingBehavior.dispose(),this._floatingBehavior=null),FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.callBaseMethod(this,"dispose")},get_titleId:function(){return this._titleId},set_titleId:function(n){this._titleId=n},show:function(){this._setStyleIndex||(this._setStyleIndex=!0),FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.callBaseMethod(this,"show")},_createFloatingBehavior:function(){if(!this._floatingBehavior&&this._titleId){var n=$get(this._titleId);n&&(this._floatingBehavior=$create(AjaxControlToolkit.FloatingBehavior,{handle:n,id:this._titleId+"_floatingBehavior"},null,null,this._foregroundElement))}},_onLayout:function(){var n=$common.getClientBounds(),t=n.width,i=n.height;$func.isIE&&document.compatMode!="CSS1Compat"?(this._backgroundElement.style.width=document.body.scrollWidth+"px",this._backgroundElement.style.height=document.body.scrollHeight+"px"):(this._backgroundElement.style.width=Math.max(Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),t)+"px",this._backgroundElement.style.height=Math.max(Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),i)+"px")}},FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.inheritsFrom(AjaxControlToolkit.ModalPopupBehavior),FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior.registerClass("FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior",AjaxControlToolkit.ModalPopupBehavior),FastBusiness.AjaxControlExtender.ResizableControlBehavior=function(n){FastBusiness.AjaxControlExtender.ResizableControlBehavior.initializeBase(this,[n])},FastBusiness.AjaxControlExtender.ResizableControlBehavior.prototype={_resizeControl:function(n,t,i,r){if(n==0&&t==0&&i==0&&r==0&&!this._loaded){this._startResizeControl(n,t,i,r),this._loaded=!0;return}this._baseResizeControl(n,t,i,r)},_startResizeControl:function(){var n=this._frame.offsetWidth,t=this._frame.offsetHeight,i=n-this._handle.offsetWidth+this._HandleOffsetX-2,r=t-this._handle.offsetHeight+this._HandleOffsetY-2;this._lining.style.width=n-2+"px",this._lining.style.height=t-2+"px",this._handle.style.left=i+"px",this._handle.style.top=r+"px"},_baseResizeControl:function(n,t,i,r){var u,f;this._lastClientX=n,this._lastClientY=t;var s=this._lining.offsetWidth,h=this._lining.offsetHeight,e=Math.min(Math.max(this._lining.offsetWidth+i,Math.max(this._MinimumWidth,this._handle.offsetWidth)),this._MaximumWidth),o=Math.min(Math.max(this._lining.offsetHeight+r,Math.max(this._MinimumHeight,this._handle.offsetHeight)),this._MaximumHeight);this._lining.style.width=e+"px",this._lining.style.height=o+"px",this._frame.style.width=e+"px",this._frame.style.height=o+"px",u=this._lining.offsetWidth-this._handle.offsetWidth+this._HandleOffsetX,f=this._lining.offsetHeight-this._handle.offsetHeight+this._HandleOffsetY,this._handle.style.left=u+"px",this._handle.style.top=f+"px",this._deltaX=this._lining.offsetWidth-s,this._deltaY=this._lining.offsetHeight-h,this.raiseResizing()}},FastBusiness.AjaxControlExtender.ResizableControlBehavior.inheritsFrom(AjaxControlToolkit.ResizableControlBehavior),FastBusiness.AjaxControlExtender.ResizableControlBehavior.registerClass("FastBusiness.AjaxControlExtender.ResizableControlBehavior",AjaxControlToolkit.ResizableControlBehavior),FastBusiness.AjaxControlExtender.GridFunction.Resources={WaitHtml:'<div class="Wait"></div>',Message:{ConfirmDelete:{v:'Hệ thống sẽ <span class="TaskDialogContentHighlight">xóa bản ghi đang được chọn</span>, bạn có chắc chắn xóa không?',e:'Are you sure you want to <span class="TaskDialogContentHighlight">delete this record?</span>'},Aggregate:{v:'Tổng cộng trong trường <span class="Highlight">{0}</span> là: {1}.',e:'Total sum of field <span class="Highlight">{0}</span>: {1}.'}},FilterPanel:{Equal:{v:"Bằng",e:"Equals"},NotEqual:{v:"Không bằng",e:"Does not equals"},LessThan:{v:"Nhỏ hơn",e:"Less than"},GreaterThan:{v:"Lớn hơn",e:"Greater than"},LessThanOrEqual:{v:"Nhỏ hơn hoặc bằng",e:"Less than or equal to"},GreaterThanOrEqual:{v:"Lớn hơn hoặc bằng",e:"Greater than or equal to"},StartsWith:{v:"Bắt đầu bằng...",e:"Starts with..."},Contain:{v:"Thuộc...",e:"Contains..."},NotContain:{v:"Không thuộc...",e:"Does not contains..."},Filter:{v:"Lọc...",e:"Filter..."},Day:{v:"Ngày hôm nay",e:"Today"},Week:{v:"Trong tuần này",e:"During this week"},Month:{v:"Trong tháng này",e:"During this month"},Quarter:{v:"Trong quý này",e:"During this quarter"},Year:{v:"Năm nay",e:"During this year"}},InfoBar:{FilterApplied:{v:"Các bản ghi đang được lọc.",e:"A filter has been applied."},ValueIs:' <span class="Highlight">{0}</span> ',Or:{v:" hoặc ",e:" or "},And:{v:" và ",e:" and "},EqualTo:{v:"bằng ",e:"is equal to "},NotEqualTo:{v:"khác ",e:"is not equal to "},LessThan:{v:"nhỏ hơn ",e:"is less than "},LessThanOrEqualTo:{v:"nhỏ hơn hoặc bằng ",e:"is less than or equal to "},GreaterThan:{v:"lớn hơn ",e:"is greater than "},GreaterThanOrEqual:{v:"lớn hơn hoặc bằng ",e:"is greater than or equal to "},Like:{v:"thuộc ",e:"is like "},NotLike:{v:"không thuộc ",e:"is not like "},StartsWith:{v:"bắt đầu bằng ",e:"starts with "},DoesNotStartWith:{v:"không bắt đầu bằng ",e:"does not start with "},Empty:{v:"không có",e:"empty"}},Pager:{ItemsPerPage:{v:"Số bản ghi một trang: ",e:"Items per page: "},PageSizes:[5,10,15,20,25],ShowingItems:{v:"Xem <b>{0}</b>-<b>{1}</b>/<b>{2}</b> bản ghi",e:" Showing <b>{0}</b>-<b>{1}</b>/<b>{2}</b> item(s)"},Refresh:{v:"Làm tươi",e:"Refresh"},Next:{v:"Tiếp »",e:"Next »"},Previous:{v:"« Trước",e:"« Previous"},Page:{v:"Trang",e:"Page"},PageButtonCount:10},HeaderFilter:{GenericSortAscending:{v:"Nhỏ nhất lên trước",e:"Smallest on Top"},GenericSortDescending:{v:"Lớn nhất lên trước",e:"Largest on Top"},StringSortAscending:{v:"Tăng dần",e:"Ascending"},StringSortDescending:{v:"Giảm dần",e:"Descending"},DateSortAscending:{v:"Gần nhất lên trước",e:"Earliest on Top"},DateSortDescending:{v:"Xa nhất lên trước",e:"Latest on Top"},EmptyValue:{v:"(Không có)",e:"(Empty)"},BlankValue:{v:"(Trắng)",e:"(Blank)"},Loading:{v:"Đang thực hiện...",e:"Loading..."},ClearFilter:{v:"Bỏ lọc trường {0}",e:"Clear Filter from {0}"},SortBy:{v:"Sắp xếp theo {0}",e:"Sort by {0}"},MaxTextLength:80,CustomFilterOption:{v:"Lọc...",e:"Custom Filter..."},CustomFilterPrompt:{v:'Xem tất cả các dòng trong <span class="Highlight">{0}</span> khi <span class="Highlight">{1}</span> thỏa mãn các điều kiện sau. Có thể chọn nhiều điều kiện cách nhau bằng dấu , và dùng &gt;, &lt;, &gt;=, &lt;=, &lt;&gt; hoặc != đặt trước các giá trị. Có thể dùng dấu * và % của các trường ký tự để lọc.',e:'Show all rows in <span class="Highlight">{0}</span> where column <span class="Highlight">{1}</span> matches the following value(s). You may separate multiple values with comma and use &gt;, &lt;, &gt;=, &lt;=, &lt;&gt; or != operators placed before the value. Use *, % operators placed before or after the value.'},CustomFilterLimit:5,FormFilterPrompt:{v:'<span class="Highlight">Điều kiện lọc</span>',e:"Filter"}},ModalPopup:{Close:{v:"Đóng",e:"Close"},MaxWidth:700,MaxHeight:500,Ok:{v:"Nhận",e:"Ok"},Cancel:{v:"Hủy",e:"Cancel"}},Toolbar:{New:{v:"Mới (Ctrl + Insert)$",e:"New (Ctrl + Insert)$"},Edit:{v:"Sửa (Ctrl + E)$",e:"Edit (Ctrl + E)$"},Delete:{v:"Xóa (Ctrl + Delete)$",e:"Delete (Ctrl + Delete)$"},Copy:{v:"Chép dữ liệu$$90",e:"Copy$"},Search:{v:"Tìm$",e:"Search$"},View:{v:"Xem$",e:"View$"},Preview:{v:"Xem trước",e:"Preview"},Print:{v:"In$",e:"Print$"},Save:{v:"Lưu",e:"Save"},Cancel:{v:"Hủy",e:"Cancel"},Option:{v:"Tùy chọn",e:"Option"},Export:{v:"Kết xuất",e:"Export"},Page:{v:"Trang",e:"Page"},Insert:{v:"Thêm dòng (Ctrl + Insert)$Thêm",e:"Insert (Ctrl + Insert)$"},Remove:{v:"Xóa dòng (Ctrl + Delete)$Xóa",e:"Remove (Ctrl + Delete)$"},Grow:{v:"Chuyển lên$$100",e:"Up$"},Down:{v:"Chuyển xuống$$100",e:"Down$"},Clone:{v:"Nhân dòng$$90",e:"Clone$"},Aggregate:{v:"Tổng cộng",e:"Aggregate"},Retrieve:{v:"Lấy dữ liệu$$120",e:"Retrieve Data$$120"},Freeze:{v:"Khóa cột",e:"Freeze Columns"},Unlock:{v:"Bỏ khóa",e:"Unfreeze Columns"}}},typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
FastBusiness.AjaxControlExtender.GridCalendar=function(n){FastBusiness.AjaxControlExtender.GridCalendar.initializeBase(this,[n]),this._showOnForm=null},FastBusiness.AjaxControlExtender.GridCalendar.prototype={initialize:function(){FastBusiness.AjaxControlExtender.GridCalendar.callBaseMethod(this,"initialize"),Sys.Browser.agent!=Sys.Browser.InternetExplorer&&(this._cell$delegates={mouseover:Function.createDelegate(this,this._cell_onmouseover),mouseout:Function.createDelegate(this,this._cell_onmouseout),mousedown:Function.createDelegate(this,this._cell_onclick)})},dispose:function(){try{FastBusiness.AjaxControlExtender.GridCalendar.callBaseMethod(this,"dispose")}catch(n){}},get_showOnForm:function(){return this._showOnForm},set_showOnForm:function(n){this._showOnForm!=n&&(this._showOnForm=n)},_onFocus:function(){var t=this.get_element();Web.Command.onDateFocus(t);t._lastText=$func.trim(t.value)},_onBlur:function(n){var t=this.get_element();FastBusiness.AjaxControlExtender.GridCalendar.callBaseMethod(this,"_onBlur",[n]),$func.trim(t.value)!=t._lastText&&$func.fireChanged(t)},_onKeyPressdown:function(n){var t=this.get_element(),i;if(!t||!t.stopKeypress){if(!n.ctrlKey&&!n.altKey){i=this._format;Web.Command.onDateKeyDown(t,i,n)}n.keyCode==Sys.UI.Key.esc&&this.hide()}},_onKeyPress:function(n){var t,i;if(!n.ctrlKey&&!n.altKey){if(t=this.get_element(),t&&t.stopKeypress)return;i=this._format,t.value==Web.Command.DateBlankFormat(this._format)&&Web.Command.GetSelectionLength(t)==10;Web.Command.onDateKeyPress(t,i,n)}},_ensureCalendar:function(){if(!this._container){var n=this.get_element(),t=n.parentNode.parentNode;(this._showOnForm||n.parentNode._fixedColumn)&&(t=n.parentNode),this._buildCalendar(),this._buildHeader(),this._buildBody(),this._buildFooter(),this._popupBehavior=new $create(FastBusiness.AjaxControlExtender.PopupBehavior,{parentElement:t},{},{},this._container),this._popupPosition==AjaxControlToolkit.CalendarPosition.TopLeft?this._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.TopLeft):this._popupPosition==AjaxControlToolkit.CalendarPosition.TopRight?this._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.TopRight):this._popupPosition==AjaxControlToolkit.CalendarPosition.BottomRight?this._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.BottomRight):this._popupPosition==AjaxControlToolkit.CalendarPosition.Right?this._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.Right):this._popupPosition==AjaxControlToolkit.CalendarPosition.Left?this._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.Left):this._popupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.BottomLeft)}},show:function(){FastBusiness.AjaxControlExtender.GridCalendar.callBaseMethod(this,"show"),$func.inactiveForm(this,!0,!0)},hide:function(){FastBusiness.AjaxControlExtender.GridCalendar.callBaseMethod(this,"hide"),$func.inactiveForm(this,!1,!0,!0)},focus:function(){try{this.get_element().focus()}catch(n){}},_button_onblur:function(){this._enabled&&(this._popupMouseDown=!1)},_changeReadOnly:function(n){var t=this.get_element(),i=t.readOnly;n!=null&&(i=n),i?(this._blurHandler&&($removeHandler(t,"blur",this._blurHandler),this._blurHandler=null),this._focusHandler&&($removeHandler(t,"focus",this._focusHandler),this._focusHandler=null),this._keypressHandler&&($removeHandler(t,"keypress",this._keypressHandler),this._keypressHandler=null),this._keypressdown&&($removeHandler(t,"keydown",this._keypressdown),this._keypressdown=null)):(this._keypressdown=Function.createDelegate(this,this._onKeyPressdown),this._keypressHandler=Function.createDelegate(this,this._onKeyPress),this._focusHandler=Function.createDelegate(this,this._onFocus),this._blurHandler=Function.createDelegate(this,this._onBlur),$addHandler(t,"keydown",this._keypressdown),$addHandler(t,"keypress",this._keypressHandler),$addHandler(t,"focus",this._focusHandler),$addHandler(t,"blur",this._blurHandler))}},FastBusiness.AjaxControlExtender.GridCalendar.inheritsFrom(FastBusiness.AjaxControlExtender.CalendarExtender),FastBusiness.AjaxControlExtender.GridCalendar.registerClass("FastBusiness.AjaxControlExtender.GridCalendar",FastBusiness.AjaxControlExtender.CalendarExtender),FastBusiness.AjaxControlExtender.GridNumeric=function(n){FastBusiness.AjaxControlExtender.GridNumeric.initializeBase(this,[n]),this._showOnForm=null},FastBusiness.AjaxControlExtender.GridNumeric.prototype={initialize:function(){FastBusiness.AjaxControlExtender.GridNumeric.callBaseMethod(this,"initialize"),this._popupBehavior=null,this._reset()},dispose:function(){this._status=null,this._result=null,this._calc=null,this._popupBehavior&&(this._popupBehavior.dispose(),this._popupBehavior=null),this._container&&(this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=null),this._popupDiv&&(this._popupDiv=null),FastBusiness.AjaxControlExtender.GridNumeric.callBaseMethod(this,"dispose")},get_id:function(){return this._id},set_id:function(n){this._id!=n&&(this._id=n)},get_showOnForm:function(){return this._showOnForm},set_showOnForm:function(n){this._showOnForm!=n&&(this._showOnForm=n)},_initCalculator:function(){if(!this._container){var n=this.get_element();this._buildCalculator(),this._popupBehavior=this._showOnForm||n.parentNode._fixedColumn?new $create(FastBusiness.AjaxControlExtender.PopupBehavior,{parentElement:n.parentNode},{},{},this._container):new $create(FastBusiness.AjaxControlExtender.PopupBehavior,{parentElement:n.parentNode.parentNode},{},{},this._container),this._popupBehavior.set_positioningMode(5)}},_buildCalculator:function(){var t=this.get_element(),n=this.get_id();this._container=$common.createElementFromTemplate({nodeName:"div",properties:{id:n+"_container"},visible:!1},t.parentNode.parentNode),this._popupDiv=$common.createElementFromTemplate({nodeName:"div",properties:{id:n+"_popupDiv"}},this._container)},_render:function(){var t=new Sys.StringBuilder,s=180,u,f,e,o,n,i,r;for(t.append(String.format('<table style="width:{0}px;" cellpadding="0" cellspacing="0" border="0" class="Calculator CalculatorPopupTable"><tbody><tr class="CalculatorPopupTableRow"><td class="CalculatorCell">',s)),t.append('<table cellspacing="0" cellpadding="0" border="0" class="CalculatorTable"><tbody><tr class="CalculatorTableRow">'),n=0;n<s;n+=1)t.append('<td style="width:1px;" class="CalculatorArrowCell">'),u=n%10,u=u<5?4-u:u-4,i="",n==0||n==25?i="background-color:#F5F5F5;":n>0&&n<25&&(i="background-color:#E9EEEE;"),t.append(String.format('<div class="CalculatorLine" style="width:1px;height:{0}px;{1}"></div>',u,i)),t.append("</td>");for(t.append("</tr></tbody></table>"),t.append("</td></tr></tbody></table>"),t.append('<table cellpadding="0" cellspacing="0" class="CalculatorContextTable"><tr><td style="padding:0px;text-align:right;"><div class="CalculatorContextPanel">'),f=this._calc.length,e=0,f>10&&(t.append('<div class="CalculatorContextItem">...</div>'),e=f-10),o=!1,n=e;n<f;n++)i=this._calc[n][0],r=$func.numberFormat(this._calc[n][1],this._format),i=="Result"&&(t.append('<div class="CalculatorResult"></div>'),i=""),r.length>20&&(r=r.substr(r.length-20,20),r="..."+$func.trim(r)),t.append(String.format('<div class="CalculatorContextItem {0}"><div class="CalculatorContextText">{1}</div></div>',i,r)),!o&&n>e&&n<f-1&&i==""?(t.append('<div class="CalculatorBreak"></div>'),o=!0):o=!1;t.append("</div></td></tr></table>"),this._popupDiv.innerHTML=t.toString()},_key:function(n){switch(n){case"Add":this._active(n);break;case"Sub":this._active(n);break;case"Mul":this._active(n);break;case"Div":this._active(n);break;case"Result":if(this._status=="")break;var i=this._get_number();this._opr(this._status),Array.add(this._calc,[this._status,i]),Array.add(this._calc,["Result",this._result]),this._set_number(this._result),this._result=0,this._status="",this._open();break;case"Enter":if(this._status=="")break;this._opr(this._status),this._set_number(this._result),this.hide();break;case"Esc":this.hide()}},_active:function(n){var t=this._get_number();this._opr(this._status),Array.add(this._calc,[this._status,t]),this._status=n,this._open()},_open:function(){this._isOpen?(this._render(),this._popupBehavior._reposition()):this.show();try{this.get_element().select()}catch(n){}},_opr:function(n){var t=this._get_number(),i;switch(n){case"":this._result=t;break;case"Add":this._result+=t;break;case"Sub":this._result-=t;break;case"Mul":try{this._result=this._result*t}catch(r){this._result=0}break;case"Div":try{this._result=t==0?0:this._result/t}catch(r){this._result=0}}},_reset:function(){this._status="",this._result=0,this._calc=[]},show:function(){var n=this;n._initCalculator(),n._render(),n._isOpen||(n._isOpen=!0,n._popupBehavior.show(),$func.inactiveForm(n,!0))},hide:function(){var n=this;if(n._isOpen){if(n._container){n._popupBehavior.hide(),n._reset();try{n.get_element().select(),n.get_element().focus()}catch(t){}}n._isOpen=!1,$func.inactiveForm(n,!1,!1,!0)}},_onKeyPressdown:function(n){var t=n.keyCode,i=this.get_element(),r,u;if(!i||!i.stopKeypress){if($func.isCs&&t==27&&this._isOpen){$func.cancelEvent(n),this._key("Esc");return}if($func.isOpr){if(t==43||t==187){$func.cancelEvent(n),this._key("Add");return}if(t==45||t==189){if(r=$func.getCurPos(i),r>0){$func.cancelEvent(n),this._key("Sub");return}}else{if(t==42||t==56&&n.shiftKey){$func.cancelEvent(n),this._key("Mul");return}if(t==47||t==191){$func.cancelEvent(n),this._key("Div");return}}}if(!n.ctrlKey&&!n.altKey){u=this._format;Web.Command.onNumericKeyDown(i,u,n)}}},_onKeyPress:function(n){var t=n.charCode,i=this.get_element(),r,u;if(!i||!i.stopKeypress){if(!$func.isOpr){if(t==43){$func.cancelEvent(n),this._key("Add");return}if(t==45){if(r=$func.getCurPos(i),r>0){$func.cancelEvent(n),this._key("Sub");return}}else{if(t==42){$func.cancelEvent(n),this._key("Mul");return}if(t==47){$func.cancelEvent(n),this._key("Div");return}}}if(t==61&&this._isOpen){$func.cancelEvent(n),this._key("Result");return}if(t==13&&this._isOpen){$func.cancelEvent(n),this._key("Enter");return}if(t==27&&this._isOpen&&!$func.isCs){$func.cancelEvent(n),this._key("Esc");return}if(!n.ctrlKey&&!n.altKey){u=this._format;Web.Command.onNumericKeyPress(i,u,n)}}},set_format:function(n){if(this._format!=n){this._format=n;var t=$func.scaleLength(n);this._set_number($func.round(this._get_number(),t))}},_get_number:function(){var n=this.get_element();return $func.stringToNumeric(n.value)},_set_number:function(n){var t=this.get_element();t.value=$func.numberFormat(n,this._format)},_refresh:function(){this._set_number(this._get_number())},_changeReadOnly:function(n){var t=this.get_element(),i=t.readOnly;n!=null&&(i=n),i?(this._keypressHandler&&($removeHandler(t,"keypress",this._keypressHandler),this._keypressHandler=null),this._keypressdown&&($removeHandler(t,"keydown",this._keypressdown),this._keypressdown=null)):(this._keypressdown=Function.createDelegate(this,this._onKeyPressdown),this._keypressHandler=Function.createDelegate(this,this._onKeyPress),$addHandler(t,"keydown",this._keypressdown),$addHandler(t,"keypress",this._keypressHandler))}},FastBusiness.AjaxControlExtender.GridNumeric.inheritsFrom(FastBusiness.AjaxControlExtender.NumericExtender),FastBusiness.AjaxControlExtender.GridNumeric.registerClass("FastBusiness.AjaxControlExtender.GridNumeric",FastBusiness.AjaxControlExtender.NumericExtender),FastBusiness.AjaxControlExtender.GridMask=function(n){FastBusiness.AjaxControlExtender.GridMask.initializeBase(this,[n]),this._showOnForm=null},FastBusiness.AjaxControlExtender.GridMask.prototype={initialize:function(){if(FastBusiness.AjaxControlExtender.GridMask.callBaseMethod(this,"initialize"),Sys.Browser.agent==Sys.Browser.Opera&&this._format.toUpperCase()=="X"){var n=this.get_element();n.autocomplete="",n.setAttribute("autocomplete","off")}},dispose:function(){FastBusiness.AjaxControlExtender.GridMask.callBaseMethod(this,"dispose")},get_id:function(){return this._id},set_id:function(n){this._id!=n&&(this._id=n)},get_showOnForm:function(){return this._showOnForm},set_showOnForm:function(n){this._showOnForm!=n&&(this._showOnForm=n)},_onKeyPressdown:function(n){var t=this.get_element(),i;if((!t||!t.stopKeypress)&&!n.ctrlKey&&!n.altKey){i=this._format;Web.Command.onMaskKeyDown(t,i,n)}},_onKeyPress:function(n){var t,i;if(!n.ctrlKey&&!n.altKey){if(t=this.get_element(),t&&t.stopKeypress)return;i=this._format;Web.Command.onMaskKeyPress(t,i,n)}},_onFocus:function(n){FastBusiness.AjaxControlExtender.GridMask.callBaseMethod(this,"_onFocus",[n]);var t=this.get_element();t._lastText=$func.trim(t.value)},_onBlur:function(n){var t=this.get_element();FastBusiness.AjaxControlExtender.GridMask.callBaseMethod(this,"_onBlur",[n]),$func.trim(t.value)!=t._lastText&&this._format!="x"&&this._format!="X"&&$func.fireChanged(t)},_changeReadOnly:function(n){var t=this.get_element(),i=t.readOnly;n!=null&&(i=n),i?(this._blurHandler&&($removeHandler(t,"blur",this._blurHandler),this._blurHandler=null),this._focusHandler&&($removeHandler(t,"focus",this._focusHandler),this._focusHandler=null),this._keypressHandler&&($removeHandler(t,"keypress",this._keypressHandler),this._keypressHandler=null),this._keypressdown&&($removeHandler(t,"keydown",this._keypressdown),this._keypressdown=null)):(this._keypressdown=Function.createDelegate(this,this._onKeyPressdown),this._keypressHandler=Function.createDelegate(this,this._onKeyPress),this._focusHandler=Function.createDelegate(this,this._onFocus),this._blurHandler=Function.createDelegate(this,this._onBlur),$addHandler(t,"keydown",this._keypressdown),$addHandler(t,"keypress",this._keypressHandler),$addHandler(t,"focus",this._focusHandler),$addHandler(t,"blur",this._blurHandler))}},FastBusiness.AjaxControlExtender.GridMask.inheritsFrom(FastBusiness.AjaxControlExtender.MaskExtender),FastBusiness.AjaxControlExtender.GridMask.registerClass("FastBusiness.AjaxControlExtender.GridMask",FastBusiness.AjaxControlExtender.MaskExtender),FastBusiness.AjaxControlExtender.TimeSpan=function(n){FastBusiness.AjaxControlExtender.TimeSpan.initializeBase(this,[n]),this._showOnForm=null;var t=this.get_element();t.value==this._empty&&(t.value="")},FastBusiness.AjaxControlExtender.TimeSpan.prototype={initialize:function(){this._setBlankValue(),FastBusiness.AjaxControlExtender.TimeSpan.callBaseMethod(this,"initialize");var n=this.get_element();$common.removeHandlers(n,this._element$delegates)},dispose:function(){try{var n=this.get_element();$addHandlers(n,this._element$delegates)}catch(t){}try{FastBusiness.AjaxControlExtender.TimeSpan.callBaseMethod(this,"dispose")}catch(t){}},get_showOnForm:function(){return this._showOnForm},set_showOnForm:function(n){this._showOnForm!=n&&(this._showOnForm=n)},_setBlankValue:function(n){var t=this.get_element(),i=this._format;$func.trim(t.value)==""&&(t.value=i.replace(/H/gi,"0").replace(/h/gi,"0").replace(/m/gi,"0").replace(/s/gi,"0"),n&&$func.setCurPos(t,0))},_onFocus:function(){var t=this.get_element();this._setBlankValue(!0);Web.Command.onDateFocus(t);t._lastText=$func.trim(t.value)},_onBlur:function(n){var t=this.get_element();FastBusiness.AjaxControlExtender.TimeSpan.callBaseMethod(this,"_onBlur",[n]),$func.trim(t.value)!=t._lastText&&$func.fireChanged(t)},_onKeyPressdown:function(n){var t=this.get_element(),i;if((!t||!t.stopKeypress)&&!n.ctrlKey&&!n.altKey){i=this._format;Web.Command.onDateKeyDown(t,i,n)}},_onKeyPress:function(n){var t,i;if(!n.ctrlKey&&!n.altKey){if(t=this.get_element(),t&&t.stopKeypress)return;i=this._format,t.value==Web.Command.DateBlankFormat(this._format)&&Web.Command.GetSelectionLength(t)==10;Web.Command.onDateKeyPress(t,i,n)}},_changeReadOnly:function(n){var t=this.get_element(),i=t.readOnly;n!=null&&(i=n),i?(this._blurHandler&&($removeHandler(t,"blur",this._blurHandler),this._blurHandler=null),this._focusHandler&&($removeHandler(t,"focus",this._focusHandler),this._focusHandler=null),this._keypressHandler&&($removeHandler(t,"keypress",this._keypressHandler),this._keypressHandler=null),this._keypressdown&&($removeHandler(t,"keydown",this._keypressdown),this._keypressdown=null)):(this._keypressdown=Function.createDelegate(this,this._onKeyPressdown),this._keypressHandler=Function.createDelegate(this,this._onKeyPress),this._focusHandler=Function.createDelegate(this,this._onFocus),this._blurHandler=Function.createDelegate(this,this._onBlur),$addHandler(t,"keydown",this._keypressdown),$addHandler(t,"keypress",this._keypressHandler),$addHandler(t,"focus",this._focusHandler),$addHandler(t,"blur",this._blurHandler))}},FastBusiness.AjaxControlExtender.TimeSpan.inheritsFrom(FastBusiness.AjaxControlExtender.CalendarExtender),FastBusiness.AjaxControlExtender.TimeSpan.registerClass("FastBusiness.AjaxControlExtender.TimeSpan",FastBusiness.AjaxControlExtender.CalendarExtender),FastBusiness.AjaxControlExtender.GridLookup=function(n){FastBusiness.AjaxControlExtender.GridLookup.initializeBase(this,[n]),this._element=n,this._completionTextAlign="",this._completionValueAlign="",this.delimiterCharacters="",this._serviceMethod="GetCompletionList",this._completionItemElementCssClass="CompletionItemElement",this._completionListCssClass="CompletionListElement",this._completionListItemCssClass="CompletionLisItem",this._highlightedItemCssClass="CompletionHighlighted",this._completionTextFieldWidth=0,this._completionValueFieldWidth=0,this._completionSetCount=10,this._minimumPrefixLength=3,this._enableCaching=!1,this._firstRowSelected=!0,this._showOnlyCurrentWordInCompletionListItem=!0,this._selectedKeyList=[],this._multipleSelection=!1,this._allowNew=!1,this._showOnForm=null,this._dirScript=null,this._ground=null,this._initLabel=null,this._saveChangedValue=""},FastBusiness.AjaxControlExtender.GridLookup.prototype={initialize:function(){var n=this,i=null,t=n._element;t._idle?(AjaxControlToolkit.AutoCompleteBehavior.callBaseMethod(n,"initialize"),n._focusHandler=Function.createDelegate(n,n._onGotFocus),n._blurHandler=Function.createDelegate(n,n._onLostFocus),$addHandler(t,"focus",n._focusHandler),$addHandler(t,"blur",n._blurHandler),n._idle=t._idle):(FastBusiness.AjaxControlExtender.AutoCompleteExtender.callBaseMethod(n,"initialize"),n._popupBehavior&&(n._popupBehaviorHiddenHandler&&n._popupBehavior.remove_hidden(n._popupBehaviorHiddenHandler),n._popupBehavior.dispose()),n._popupBehavior=n._showOnForm||t.parentNode._fixedColumn?$create(FastBusiness.AjaxControlExtender.PopupBehavior,{id:n.get_id()+"PopupBehavior",parentElement:t.parentNode,positioningMode:AjaxControlToolkit.PositioningMode.BottomLeft},null,null,n._completionListElement):$create(FastBusiness.AjaxControlExtender.PopupBehavior,{id:n.get_id()+"PopupBehavior",parentElement:t.parentNode.parentNode,positioningMode:AjaxControlToolkit.PositioningMode.BottomLeft},null,null,n._completionListElement),n._popupBehavior.add_hidden(n._popupBehaviorHiddenHandler),n._onShowJson&&n._popupBehavior.set_onShow(n._onShowJson),n._onHideJson&&n._popupBehavior.set_onHide(n._onHideJson));n._label=i;n._padSize=i;n._upperCase=!0;n._dirInfor=i;n._dirAccess=i;n._viewId=i;t._saveChangedValue="";n._headerDropDownOnShowingHandler=Function.createDelegate(n,n._headerDropDownOnShowing);n._bodyKeydownHandler=Function.createDelegate(n,n._bodyKeydown);n._viewSelectorOnShownHandler=Function.createDelegate(n,n._viewSelectorOnShown);n._quickFindHandlers={focus:n._onQuickFindFocus,blur:n._onQuickFindBlur,keydown:n._onQuickFindKeydown}},dispose:function(){if(this._dirExtender&&(this._dirExtender.dispose(),this._dirExtender=null),this._lookupModalBehavior&&(this._lookupModalBehavior.dispose(),this._lookupModalBehavior=null),this._button)try{$common.removeHandlers(this._button,this._button$delegates)}catch(t){}if(this._container&&(this._container.parentNode.removeChild(this._container),this._container=null),this._idle){var n=this.get_element();n&&(this._focusHandler&&$removeHandler(n,"focus",this._focusHandler),this._blurHandler&&$removeHandler(n,"blur",this._blurHandler)),this._focusHandler=null,this._blurHandler=null}FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"dispose"),this._panel&&(this._panel.parentNode.removeChild(this._panel),this._panel=null),this._viewSelectorOnShownHandler=null},get_showOnForm:function(){return this._showOnForm},set_showOnForm:function(n){this._showOnForm!=n&&(this._showOnForm=n)},get_dirInfor:function(){return this._dirInfor},set_dirInfor:function(n){this._dirInfor=n},get_dirAccess:function(){return this._dirAccess},set_dirAccess:function(n){this._dirAccess=n},get_dirScript:function(){return this._dirScript},set_dirScript:function(n){this._dirScript=n},get_ground:function(){return this._ground},set_ground:function(n){this._ground=n},get_elementFocus:function(){return this._elementFocus},set_elementFocus:function(n){this._elementFocus=n},get_initLabel:function(){return this._initLabel},set_initLabel:function(n){this._initLabel=n},showCustomFilter:function(n,t){FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"showCustomFilter",[n,t]);var i=$get(this._lookupID+"_Query");i&&$func.attachContextMenu(i,this._language,!0)},closeCustomFilter:function(){var n=$get(this._lookupID+"_Query");n&&$func.detachContextMenu(n,!0),FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"closeCustomFilter")},get_padSize:function(){return this._padSize},set_padSize:function(n){this._padSize!=n&&(this._padSize=n)},get_upperCase:function(){return this._upperCase},set_upperCase:function(n){this._upperCase!=n&&(this._upperCase=n)},get_label:function(){return this._label},set_label:function(n){if(this._label!=n){this._label=n,n.Checked||(this._label.checked=!0,n.Checked=!0);var t=this.get_element();t&&n&&(t.title=n.value)}},get_currentPrefix:function(){return this._currentPrefix},set_currentPrefix:function(n){this._currentPrefix!=n&&(this._currentPrefix=n,this._saveTextValue=n)},get_quickFindString:function(){return FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.QuickFind")+String.fromCharCode(9)},get_quickFindText:function(){return this._quickFindText?this._quickFindText:this.get_quickFindString()},set_quickFindText:function(n){this._quickFindText=n},get_quickFindElement:function(){return $get(this._lookupID+"_QuickFind")},_setFields:function(n){var t=this,r,u,i,f;if((n||t._setCompletion||(r=Sys.Serialization.JavaScriptSerializer.deserialize(t._sessionItem()),r&&(n=r,t._sessionStorage=!0)),FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(t,"_setFields",[n]),n)&&(t._requireScript&&$func.requireResource("script",t._requireScript,t._baseUrl),t._requireCss&&$func.requireResource("link",t._requireCss,t._baseUrl),t._quickFindIndexField=t._findIndex?parseInt(t._findIndex):t._lookupTextFieldID,!t._fields[t._quickFindIndexField].HeaderText))for(u=Web.Command.Trim(n.Code),i=0;i<t._fields.length;i++)if(f=t._fields[i],f.Name.toLowerCase()==u.toLowerCase()){t._quickFindIndexField=i;break}},_renderViewHeaderBar:function(n){var t=this,i=t._lookupID,r=t.get_quickFindText();n.append(String.format('<tr id="{0}_ActionBar" class="ActionRow"><td colspan="{1}" class="ActionBar">',i,t._get_colSpan()));n.append('<table style="width:100%" cellpadding="0" cellspacing="0"><tr>');n.append(String.format('<td class="QuickFind" title="{0}"><div class="QuickFind"><input type="text" id="{1}_QuickFind" value="{2}" class="QuickFindInput{3}"{4}/><\/div>',FastBusiness.AjaxControlExtender.GridControl.getResources(t._language,"Message.QuickFindToolTip"),i,$func.htmlAttributeEncode(r),r==t.get_quickFindString()?" WhenQuickFindInputEmpty":" WhenQuickFindInputNonEmpty",t._idle&&t._idle!=9||t._element.hasAttribute("idle")&&t._element.getAttribute("idle")!=9?' disabled="disabled" style="background-color:transparent;"':""));n.append(String.format('<\/td><td><span class="QuickFindButton" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').quickFind()">&nbsp;<\/span><\/td><td style="width:100%">&nbsp;<\/td><td align="right">',i));n.append(String.format('<table class="ViewSelector" cellpadding="0" cellspacing="0"><tr><td class="Label">{1}:<\/td><td class="Selector"><div id="{0}_ViewSelector" class="Name">{2}<\/div><\/td><\/tr><\/table>',i,t.getResources("SelectField"),t._fields[t._lookupValueFieldID].HeaderText));n.append("<\/td><\/tr><\/table>");n.append("<\/td><\/tr>")},_onQuickFindFocus:function(){var t=this.get_quickFindElement();t.value==this.get_quickFindString()&&(t.value=""),Sys.UI.DomElement.removeCssClass(t,"WhenQuickFindInputEmpty"),Sys.UI.DomElement.removeCssClass(t,"WhenQuickFindInputNonEmpty")},_onQuickFindBlur:function(){var t=this.get_quickFindElement();t.value?Sys.UI.DomElement.addCssClass(t,"WhenQuickFindInputNonEmpty"):(t.value=this.get_quickFindString(),Sys.UI.DomElement.addCssClass(t,"WhenQuickFindInputEmpty"))},quickFind:function(){var n=this,t,i;n._idle&&n._idle!=9||(t=n.get_quickFindElement().value,i=n._fields[n._quickFindIndexField],t==n.get_quickFindString()&&(t=""),n.set_quickFindText(t),i.Hidden||(t?i.Type=="String"?n.applyFilter(i,"*","%"+t+"%"):n.applyFilter(i,"=",t):(n.removeFromFilter(i),n.set_lookupPageIndex(-2),n._loadPage())))},_onQuickFindKeydown:function(n){n.keyCode==Sys.UI.Key.enter&&(n.preventDefault(),n.stopPropagation(),this.quickFind())},_onGotFocus:function(n){this._idle||FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"_onGotFocus",[n]);var t=this.get_element();this._saveChangedValue=t.value,t._saveChangedValue=t.value},_onLostFocus:function(){this._idle||(this._textBoxHasFocus=!1,this._timer.set_enabled(!1),this._element&&(this._element.show=!1)),this._setLabelText()},_setLabelText:function(n){var t=this,r=t.get_element(),i=r.value,u=$func.trim(i),f,e;if((t._padSize?(r.value=t._currentPrefix=$func.padLeft(i,t._padSize),f=$func.trim(t._saveTextValue)!=u):f=t._saveTextValue.replace(/ +$/,"")!=i.replace(/ +$/,""),t._label)&&(e=!1,!n&&t._initLabel&&t._label.checked&&u&&$func.trim(t._label.value)==""&&(e=!0),e||f||n)){if(t._saveTextValue=i,t._idle){t._setLabelValue("");return}if(u==""){t._setLabelValue(""),t._label.checked=!0,t._setLabelChecked(r,!0);return}t._padSize?t._getLabelText(-2):t._upperCase?t._getLabelText(-1):t._getLabelText(-3)}},_getLabelText:function(n){var t=this;if(t._servicePath&&t._serviceMethod){var f=t._currentCompletionWord(),r=t.get_element().value,u=t.get_element().id,i={type:t._sessionType(-1),prefixText:r,count:n,language:t._language,controller:t._controller,cookie:t.get_cookie(),pageItemEnd:t._pageItemEnd,variable:null,valueField:t._completionValueField,textField:t._completionTextField,dataTable:t._completionDataTable,keyFilter:t._completionKeyFilter,keyValid:t._completionCheckFilter,check:t._completionCheck,keyFilter:t._completionKeyFilter,orderField:t._completionOrderField,lookupPageIndex:t._lookupPageIndex,lookupRefresh:t._lookupRefresh,filter:[],sortExpression:null,element:$func._grant(t.get_element())};t._useContextKey&&(i.contextKey=t._contextKey),t._webRequest&&(t._webRequest.get_executor().abort(),t._webRequest=null),t._busy(!0),t._webRequest=Sys.Net.WebServiceProxy.invoke(t.get_servicePath(),t.get_serviceMethod(),!1,i,Function.createDelegate(this,t._onLostFocusComplete),Function.createDelegate(this,t._onLostFocusFailed),u),$common.updateFormToRefreshATDeviceBuffer()}},_onLostFocusComplete:function(n,t){var i=this,f,r,u;i._busy(!1),i._webRequest=null,i._setResult(n),i._setFields(n.LookupFields),r=$get(t),n&&n.Rows&&n.Rows.length?(u=n.Rows,i._upperCase&&r&&(r.value=r.value.toUpperCase()),f=u[0],u.length>1&&r&&(r.value=u[1]),i._label&&(i._label.checked=!0,i._setLabelChecked(r,!0))):(f="",i._label&&(i._label.checked=!1,i._setLabelChecked(r,!1))),i._setLabelValue(f,!0),window.setTimeout(Function.createDelegate(i,i._handleFlyoutFocus),500)},_onLostFocusFailed:function(){this._busy(!1),this._webRequest=null,this._setLabelValue(""),this._label&&(this._label.checked=!1),window.setTimeout(Function.createDelegate(this,this._handleFlyoutFocus),500)},_setText:function(n){var t=this,e=null,r=e,s=e,i=e;n.tagName=="SPAN"?(r=n.parentNode._value,i=n.parentNode):n.tagName=="TD"?(r=n.firstChild._value,i=n.firstChild):(r=n._value,i=n),s=r,t._timer.set_enabled(!1);var u=t.get_element(),o=u.control,f=t._showOnlyCurrentWordInCompletionListItem?t._getTextWithInsertedWord(r):r;o&&o.set_text?o.set_text(f):u.value=f,t._label&&(t._setLabelValue(i._text),t._label.checked=!0,t._setLabelChecked(u,!0)),t._saveTextValue=i._value,f.replace(/ +$/,"")!=t._saveChangedValue.replace(/ +$/,"")&&($common.tryFireEvent(u,"change"),t._saveChangedValue=f,u._saveChangedValue=f),t.raiseItemSelected(new AjaxControlToolkit.AutoCompleteItemEventArgs(i,i._text,i._value)),t._currentPrefix=t._currentCompletionWord(),t._hideCompletionList()},_setTextValue:function(n,t){var i=this.get_element(),u=i.control,r=this._showOnlyCurrentWordInCompletionListItem?this._getTextWithInsertedWord(t):t;u&&u.set_text?u.set_text(r):i.value=r,this._label&&(this._label.checked=!0,this._setLabelValue(n),this._setLabelChecked(i,!0)),this._saveTextValue=t,r.replace(/ +$/,'')!=this._saveChangedValue.replace(/ +$/,'')&&($func.fireChanged(i),this._saveChangedValue=r,i._saveChangedValue=r,i._varied=!0,i._lastValue=r)},_setLabelValue:function(n,t){this._label&&(this._label.value=n),this._element&&(this._element.title=n);try{(!t||this._showOnForm)&&$func.setTextStatus(n)}catch(i){}},_setLabelChecked:function(n,t){if(n){if(n._searchMode&&n.field.AllowNulls&&!n.field.OnDemand)return;t?Sys.UI.DomElement.removeCssClass(n,"InvalidInput"):Sys.UI.DomElement.addCssClass(n,"InvalidInput")}},_initLookupBehavior:function(){this._buttonID||(this._buttonID=this.get_id()+"_Button"),FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"_initLookupBehavior");var t=$func.getLastIndex(),n=this._lookupModalBehavior;if(n._backgroundElement.style.zIndex=t+1,n._foregroundElement.style.zIndex=t+2,n._showHandler){try{$removeHandler(this._button,"click",n._showHandler)}catch(i){}n._showHandler=null}},showPopup:function(){FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"showPopup"),$func.inactiveForm(this,!0,!0)},hidePopup:function(){FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"hidePopup"),$func.inactiveForm(this,!1,!0,!0)},add_loading:function(n){this.get_events().addHandler("loading",n)},remove_loading:function(n){this.get_events().removeHandler("loading",n)},raiseLoading:function(n){var t=this.get_events().getHandler("loading");t&&t(this,n)},add_opening:function(n){this.get_events().addHandler("opening",n)},remove_opening:function(n){this.get_events().removeHandler("opening",n)},raiseOpening:function(n){var t=this.get_events().getHandler("opening");t&&t(this,n)},add_close:function(n){this.get_events().addHandler("close",n)},remove_close:function(n){this.get_events().removeHandler("close",n)},raiseClose:function(n){var t=this.get_events().getHandler("close");t&&t(this,n)},showLookup:function(){var n=this,t=new FastBusiness.AjaxControlExtender.EventArgs(this,{cancelEvent:!1,Value:n._element.value,Action:"Loading"}),r,i;(n.raiseLoading(t),t.type.cancelEvent)||(n._multipleSelection&&(r=n._element.value,n._selectedKeyList=$func.trim(r)==""?[]:r.split(", ")),FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(n,"showLookup"),$func.hidePopups(),t=new FastBusiness.AjaxControlExtender.EventArgs(n,{cancelEvent:!1,Value:n._element.value,Action:"Opening"}),n.raiseOpening(t),$func.inactiveForm(n,!0),i=n._element,n._saveChangedValue=i.value,i._saveChangedValue=i.value)},hideLookup:function(){var n=this,t;if(n._detachContextBehaviors(),FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(n,"hideLookup"),n._element){if(n._elementFocus)try{n._elementFocus.disabled||n._elementFocus.focus()}catch(i){}else n._element.focus();$func.inactiveForm(n,!1)}t=new FastBusiness.AjaxControlExtender.EventArgs(n,n._element?n._element.value:null),n.raiseClose(t)},_getItemText:function(n,t){try{var i=Sys.Serialization.JavaScriptSerializer.deserialize("("+n+")");return t&&i&&i.Second?i.Second:i&&i.First?i.First:n}catch(r){return n}return n},_update:function(n,t,i){var r=this,l=null,bt=r._reverse,v,at=299,u,et=r._pageIndex,lt=et==0,ui="white",b="0px",ft="4px",k="1px solid silver",kt="1px solid "+ui,ti={tableLayout:"fixed",backgroundColor:ui,cellPadding:b,padding:b},wt=r._completionTextFieldWidth,pt=r._completionTextAlign,rt=r._completionListElement,h,f,s,ot,o,e,nt,tt,st,ht,gt,oi,vt;if(i&&r.get_enableCaching()&&(r._cache||(r._cache={}),lt&&n!=""&&(r._cache[n]=t)),!r._textBoxHasFocus||n!=r._currentCompletionWord()){r._hideCompletionList();return}if(t&&t.length){rt.innerHTML="",r._selectIndex=-1;var it=l,g=l,w=l,p=l,yt=l;if(p=document.createElement("table"),r._completionTableCssClass?Sys.UI.DomElement.addCssClass(p,r._completionTableCssClass):($common.setStyle(p,ti),p.cellSpacing=b),yt=document.createElement("tbody"),p.appendChild(yt),h=t.length,h>r._completionSetCount){if(et==r._pageCount)try{f=Sys.Serialization.JavaScriptSerializer.deserialize("("+t[h-1]+")"),r._pageItemEnd=f&&f.First?f.Second:f}catch(si){r._pageItemEnd=t[h-1]}h=r._completionSetCount}else r._pageItemEnd="";for(s=0;s<h;s++){var dt="div",c=document.createElement(dt),a=document.createElement(dt);try{f=Sys.Serialization.JavaScriptSerializer.deserialize("("+t[s]+")"),f&&f.First?(g=f.First,w=f.Second):(g=f,w=f)}catch(si){g=t[s],w=t[s]}ot=r._showOnlyCurrentWordInCompletionListItem?g:r._getTextWithInsertedWord(g),c.appendChild(document.createTextNode(r._getItemText(ot,!0))),a.appendChild(document.createTextNode(w)),c._value=a._value=w,c._text=a._text=r._getItemText(ot),c.__item="",c.innerHTML=r.highlighText(c.innerHTML,n),a.innerHTML=r.highlighText(a.innerHTML,n),o=document.createElement("tr"),e=document.createElement("td"),o._value=w,o._text=r._getItemText(ot),Sys.UI.DomElement.addCssClass(o,r._completionListItemCssClass),it==l&&(it=o),nt=r._completionValueFieldWidth,v=Math.max(1,nt&&nt>0?nt:$common.getBounds(r.get_element().parentNode).width-8),u=e.style,e.width=v+"px",u.paddingLeft=u.paddingRight=ft,u.borderTop=u.borderLeft=u.borderRight=k,u.borderBottom=s<h-1?kt:k,tt=r._completionValueAlign,tt&&tt.length>0&&(u.textAlign=tt),e.appendChild(a),o.appendChild(e),e=document.createElement("td"),u=e.style,r._completionItemElementCssClass&&Sys.UI.DomElement.addCssClass(e,r._completionItemElementCssClass),wt&&wt>0?(st=Math.max(1,wt),v+=st,u.width=st+"px"):(v+=at,e.width=at+"px;"),u.borderTop=u.borderRight=k,u.borderLeft=kt,u.paddingLeft=u.paddingRight=ft,u.borderBottom=s<h-1?kt:k,bt&&(u.display="none",u.visibility="hidden"),pt&&pt.length>0&&(u.textAlign=pt),e.appendChild(c),o.appendChild(e),yt.appendChild(o)}var d=document.createElement("table"),ri=document.createElement("tbody"),ii=document.createElement("tr"),y=document.createElement("td");$common.setStyle(d,ti),d.cellSpacing=b,u=d.style,u.padding=ft,u.borderBottom=u.borderLeft=u.borderRight=k,d.appendChild(ri),y.height="20px",v+=1,ht=v+1-(bt?at+10:0),y.width=ht+"px",u=y.style,u.paddingRight=u.paddingLeft=ft,u.borderBottom=u.borderLeft=u.borderRight=b,y.align="right";var ut=document.createElement("div"),ct=r._pageItemEnd=="",ni=r._pageCache,fi=ni&&ni[1],ei=(!ct||et<r._pageCount)&&et>0;ut.style.color="#666666",bt&&$common.setStyle(ut,{paddingLeft:"16px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",width:ht-16+"px"}),gt=ei?"Message":lt&&(!ct||fi)?"PgDownMessage":lt&&ct?"NoneMessage":"PgUpMessage",ut.appendChild(document.createTextNode(r.getResources(gt))),y.appendChild(ut),ii.appendChild(y),ri.appendChild(ii),rt.appendChild(p),rt.appendChild(d),oi=$common.getBounds(r.get_element()),rt.scrollTop=0,r.raisePopulated(Sys.EventArgs.Empty),vt=new Sys.CancelEventArgs,r.raiseShowing(vt),vt.get_cancel()||(r.showPopup(),r._firstRowSelected&&it!=l&&(r._highlightItem(it),r._selectIndex=0))}else r._hideCompletionList()},_attachBehaviors:function(){var i,t,n;FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"_attachBehaviors"),i=this.get_quickFindElement(),i&&$addHandlers(i,this._quickFindHandlers,this),(this._allowNew||this._multipleSelection)&&(t=$get(this._lookupID+"_ViewSelector"),t&&(t.innerHTML=String.format('<table style="width:100%;" cellpadding="0" cellspacing="0"><tr><td nowrap style="width:100%;padding:0px 12px 0px 4px"><span>{0}</span></td ><td class="ajax__dropdown_arrow_image" style="padding:0px 14px 0px 0px">&nbsp;</td></table>',this._fields[this._lookupValueFieldID].HeaderText),panel=this._viewSelectorPanel=document.createElement("div"),Sys.UI.DomElement.setVisible(panel,!1),panel.id=this._lookupID+"_ViewSelectorMenu",panel.className="ContextMenuPanel",this._panel.appendChild(panel),dropDown=this._viewSelectorPopupBehavior=$create(FastBusiness.AjaxControlExtender.DropDownBehavior,{dropDownControl:panel,id:this._lookupID+"_ViewSelectorDropDown"},null,null,t),dropDown._dropPopupPopupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.BottomRight),dropDown.set_highlightBorderColor("#EAF5F9"),dropDown.set_highlightBackgroundColor("#EAF5F9"),dropDown.set_dropArrowBackgroundColor("white"),this._viewSelectorPopupBehavior.add_shown(this._viewSelectorOnShownHandler),sb=new Sys.StringBuilder,n=String.format('<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').execute',this._lookupID),this._allowNew&&sb.append(String.format('{0}Action(\'New\', -1);return false;" class="ContextMenuItem NewIcon">{1}</a>',n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.AddNew"))),this._multipleSelection&&(sb.append(String.format('{0}SelectedRow(\'Mark\', -1);return false;" class="ContextMenuItem Checked">{1}</a>',n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.Mark"))),sb.append(String.format('{0}SelectedRow(\'Unmark\', -1);return false;" class="ContextMenuItem">{1}</a>',n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.Unmark"))),sb.append('<div class="ContextMenuBreak"></div>'),sb.append(String.format('{0}SelectedRow(\'Select\', -1);return false;" class="ContextMenuItem">{1}</a>',n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.Select")))),panel.innerHTML=sb.toString(),sb.clear(),sb=null),this._allowNew&&this._attachRowContextBehaviors()),this.dragPanel=$create(AjaxControlToolkit.FloatingBehavior,{handle:$get(this._lookupID+"_HeaderText"),id:this._lookupID+"_dragPanel"},null,null,this._lookupModalBehavior._foregroundElement)},_attachRowContextBehaviors:function(){for(this._rowSelectors=[],i=0;i<this._lookupResult.length;i++)this._attachItemContextBehaviors(i)},_attachItemContextBehaviors:function(n){var i=document.createElement("div"),t,r,u;Sys.UI.DomElement.setVisible(i,!1),i.className="ContextMenuPanel",t=new Sys.StringBuilder,r=String.format('<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').execute',this._lookupID),t.append(String.format('{0}Action(\'New\', {1});return false;" class="ContextMenuItem NewIcon">{2}</a>',r,n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.AddNew"))),t.append(String.format('{0}Action(\'Edit\', {1});return false;" class="ContextMenuItem EditIcon">{2}</a>',r,n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.Edit"))),t.append(String.format('{0}Action(\'Delete\', {1});return false;" class="ContextMenuItem">{2}</a>',r,n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.Delete"))),t.append('<div class="ContextMenuBreak"></div>'),t.append(String.format('{0}Action(\'View\', {1});return false;" class="ContextMenuItem">{2}</a>',r,n,FastBusiness.AjaxControlExtender.GridControl.getResources(this._language,"Message.View"))),i.innerHTML=t.toString(),t.clear(),t=null,this._panel.appendChild(i),u=$get(this._lookupID+"_RowSelector"+n.toString()),u&&(dropDown=$create(FastBusiness.AjaxControlExtender.DropDownBehavior,{dropDownControl:i,id:this._lookupID+"_RowDropDown"+n.toString()},null,null,u),dropDown._dropPopupPopupBehavior.set_positioningMode(AjaxControlToolkit.PositioningMode.BottomRight),dropDown.set_highlightBorderColor("#EAF5F9"),dropDown.set_highlightBackgroundColor("#EAF5F9"),dropDown.set_dropArrowBackgroundColor("white"),Array.add(this._rowSelectors,{_panel:i,_dropDownBehavior:dropDown}))},_detachBehaviors:function(){this._detachContextBehaviors(),this.dragPanel&&(this.dragPanel.dispose(),this.dragPanel=null);var n=this.get_quickFindElement();n&&$clearHandlers(n),FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"_detachBehaviors")},_detachContextBehaviors:function(){if(this._viewSelectorPopupBehavior&&(this._viewSelectorOnShownHandler&&this._viewSelectorPopupBehavior.remove_shown(this._viewSelectorOnShownHandler),this._viewSelectorPopupBehavior.dispose(),this._viewSelectorPopupBehavior=null),this._rowSelectors){for(i=0;i<this._rowSelectors.length;i++)this._rowSelectors[i]._dropDownBehavior.get_element().style.backgroundColor="",this._rowSelectors[i]._dropDownBehavior.dispose(),this._rowSelectors[i]._dropDownBehavior=null,this._rowSelectors[i]._panel.parentNode.removeChild(this._rowSelectors[i]._panel),delete this._rowSelectors[i]._panel;this._rowSelectors=null}},_viewSelectorOnShown:function(){},_adjustSelector:function(){var n=this._viewSelectorPanel,e=n.style.display,i;n.style.display="block",n.style.width="115px";var t=$get("Options",n),o=t.offsetHeight>250,u=o?20:0;t.style.overflow="auto",i=t.scrollWidth,t.style.overflow="",n.offsetWidth<i&&(t.style.width=i+u+"px",n.style.width=i+u+"px");var f=$common.getBounds(this._viewSelectorPopupBehavior.get_element()),s=$common.getBounds(n),r={x:f.x+f.width-s.width,y:n.offsetTop},h=$common.getBounds(this.get_element());r.x<0&&(r.x=0),Sys.UI.DomElement.setLocation(n,r.x,n.offsetTop),n.style.display=e},_get_colSpan:function(){var n=FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"_get_colSpan");return this._multipleSelection?n+1:n},_createRowKey:function(n){return $func.trim(this._lookupResult[n][this._primaryKeyIndex].toString())},_renderHeaderText:function(n){var t=this,u=t._lookupID,i,r;if(t._multipleSelection){for(n.append('<tr class="HeaderRow">'),n.append(String.format('<th style="padding:2px 3px;width:19px;cursor:pointer;"><div class="Toggle" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').toggleSelectedRow();">&nbsp</div></th>',u)),i=0;i<t._fields.length;i++)r=t._fields[i],n.append(String.format('<th class="{2}"><div id="{0}_Header{1}" style="text-align:{3};padding:3px;cursor:pointer;{4}" class="HeaderSelector">',u,i,r.Name,r.Align,r.Hidden?"visibility:hidden;display:none;":"")),t._renderFieldHeaderText(n,r),n.append("</div></th>");n.append("</tr>")}else{FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(t,"_renderHeaderText",[n]);return}},_renderRows:function(n,t){var i=this,f,r,e,o,c,u,v;if(i._multipleSelection)for(f=i._lookupID,r=0;r<t.length;r++){for(e=t[r],o=!1,o=i._activeRow>0?i._activeRow==r+1:i._rowIsSelected(e),n.append(String.format('<tr id="{0}_Row{1}" class="{2}Row{3}" onmouseover="{4}addCssClass{5}" onmouseout="{4}removeCssClass{5}">',f,r,r%2==0?"":"Alternating",o?" Selected":"","Sys.UI.DomElement.","(this,'Highlight');")),i._primaryKeyIndex=i._getPrimaryKeyIndex(),c=Array.indexOf(i._selectedKeyList,i._createRowKey(r))!=-1,n.append(String.format('<td class="Cell" style="padding:2px 3px;width:19px;"><input type="checkbox" id="{0}_CheckBox{1}" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').toggleSelectedRow({1})"{2}"/></td>',f,r,c?' checked="checked"':null)),u=0;u<i._fields.length;u++){field=i._fields[u];var y=i.htmlEncode(i._valueToString(field,e[u])),l=field.Name,s=field.Align,a=field.Hidden,h=s?String.format("text-align:{0};",s):"",p=h?String.format(' style="{0}"',h):"";n.append(String.format('<td{0} class="Cell {1}">',p,l)),u==0&&(n.append(String.format('<div id="{0}_RowSelector{1}" style="padding:2px;cursor:pointer;">',f,r)),n.append(String.format('<a href="#" onclick="FastBusiness.AjaxControlExtender.AutoCompleteExtender.find(\'{0}\').changeLookupValue({1});return false">',f,r))),v=field.ClientScript?" "+i.templateEngine(field.ClientScript,{instance:this,data:t,row:e,field:field,index:r,column:u}):String.format('{0}class="Column_{1}"',s||a?String.format('style="{0}{1}" ',h,a?"visibility:hidden;display:none;":""):"",l),n.append(String.format("<div {0}>{1}</div>",v,y)),u==0&&(n.append("</a>"),n.append("</div>")),n.append("</td>")}n.append("</tr>")}else{FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(this,"_renderRows",[n,t]);return}},_changeReadOnly:function(){},_valueToString:function(n,t){return $func.valueToString(t,n,!0)},_getPrimaryKeyIndex:function(){for(var n=0;n<this._fields.length;n++)if(this._fields[n].Name==this._completionValueField)return n;return-1},_getPrimaryKeyValues:function(){var n=[],t;return this._rowSelected&&(t=this._activeRow-1,Array.add(n,this._lookupResult[t][this._getPrimaryKeyIndex()])),n},_appendRow:function(){for(var t=[],n=0;n<this._fields.length;n++)Array.add(t,null);Array.add(this._lookupResult,t),this._rowCount=this._lookupResult.length,this._activeRow=this._rowCount},_deleteRow:function(){Array.removeAt(this._lookupResult,this._activeRow-1),this._rowCount=this._lookupResult.length,this._render(this._lookupResult,""),this._activeRow>this._rowCount&&(this._activeRow=this._rowCount==0?-1:1)},_setItemValue:function(n,t,i){this._lookupResult[n-1][t-1]=i},toggleSelectedRow:function(n){for(var f=n!=null?n:0,e=n!=null?n:this._lookupResult.length-1,r,i,u,t=f;t<=e;t++)r=this._createRowKey(t),i=Array.indexOf(this._selectedKeyList,r),i==-1?Array.add(this._selectedKeyList,r):Array.removeAt(this._selectedKeyList,i),n||(u=$get(this._lookupID+"_CheckBox"+t),u&&(u.checked=i==-1))},markSelectedRow:function(n){for(var i,r,u,t=0;t<=this._lookupResult.length-1;t++)i=$get(this._lookupID+"_CheckBox"+t),n?(r=this._createRowKey(t),u=Array.indexOf(this._selectedKeyList,r),u==-1&&(Array.add(this._selectedKeyList,r),i&&(i.checked=n))):i&&(i.checked=n)},executeSelectedRow:function(n,t){switch(n){case"Mark":this.markSelectedRow(!0);break;case"Unmark":this._selectedKeyList=[],this.markSelectedRow(!1);break;case"Select":this.changeLookupValue(t)}},changeLookupValue:function(n){var t=this;if(t._multipleSelection){if(t._isBusy)return;var i=t.get_element(),u=i.value,r=t._selectedKeyList.join(", ");u!=r&&(i.value=r,$func.fireChanged(i)),t.hideLookup(),t._elementFocus||(i.focus(),$func.setCurPos(i,0)),t._selectedKeyList=[]}else FastBusiness.AjaxControlExtender.GridLookup.callBaseMethod(t,"changeLookupValue",[n]);if(t._elementFocus)try{t._elementFocus.disabled||(t._elementFocus.focus(),$func.setCurPos(t._elementFocus,0))}catch(f){}},get_multipleSelection:function(){return this._multipleSelection},set_multipleSelection:function(n){this._multipleSelection=n},get_allowNew:function(){return this._allowNew},set_allowNew:function(n){this._allowNew=n},get_baseUrl:function(){return this._baseUrl},set_baseUrl:function(n){this._baseUrl=n},get_dirController:function(){return this._dirController},set_dirController:function(n){this._dirController=n},get_dirMethod:function(){return this._dirMethod},set_dirMethod:function(n){this._dirMethod=n},get_dirService:function(){return this._dirService},set_dirService:function(n){this._dirService=n},get_dirID:function(){return this._lookupID},scatterMemvar:function(){$func.showWait(this._lookupID),this._render(this._lookupResult,"")},createDirExtender:function(){this._dirExtender||(this._dirExtender=$create(FastBusiness.AjaxControlExtender.DirExtender,{id:this._lookupID+"_dirExtender",viewMode:!1,parentType:"Lookup",language:this._language,controller:this.get_dirController(),servicePath:this.get_dirService(),serviceLookup:this._servicePath,baseUrl:this.get_baseUrl(),cookie:this._cookie},null,null,this._container),this._dirExtender.grid=this)},executeAction:function(n,t,i){if(n=="Delete"&&!i){this._inactive=!0,$message.show($func.getResources(this._language,FastBusiness.AjaxControlExtender.GridFunction.Resources,"Message.ConfirmDelete"),0,String.format("FastBusiness.AjaxControlExtender.AutoCompleteExtender.find('{0}').executeAction('Delete', {1}, true);",this._lookupID,t),String.format("FastBusiness.AjaxControlExtender.AutoCompleteExtender.find('{0}').executeAction('Close');",this._lookupID));return}if(n=="Close"){window.setTimeout(String.format("FastBusiness.AjaxControlExtender.AutoCompleteExtender.find('{0}')._inactive=false;",this._lookupID),1);return}n=="Delete"&&(this._inactive=!1),this._rowSelected=t>=0,this._activeRow=t+1,this.createDirExtender(),this._dirExtender.set_values(this._getPrimaryKeyValues()),this._dirExtender.executeAction(n)}},FastBusiness.AjaxControlExtender.GridLookup.inheritsFrom(FastBusiness.AjaxControlExtender.AutoCompleteExtender),FastBusiness.AjaxControlExtender.GridLookup.registerClass("FastBusiness.AjaxControlExtender.GridLookup",FastBusiness.AjaxControlExtender.AutoCompleteExtender),FastBusiness.AjaxControlExtender.GridControl=[],FastBusiness.AjaxControlExtender.GridControl.getResources=function(n,t){return $func.getResources(n,FastBusiness.AjaxControlExtender.GridControl.Resources,t)},FastBusiness.AjaxControlExtender.GridControl.Resources={Message:{AddNew:{v:"Tạo mới",e:"Add New"},Edit:{v:"Sửa",e:"Edit"},Delete:{v:"Xóa",e:"Delete"},View:{v:"Xem",e:"View"},Mark:{v:"Đánh dấu tất trên trang hiện thời",e:"Mark all on page"},Unmark:{v:"Bỏ các phần đánh dấu",e:"Unmark all"},Select:{v:"Chọn",e:"Select"},QuickFind:{v:"Tìm nhanh",e:"Quick Find"},QuickFindToolTip:{v:"Tìm nhanh",e:"Type to search the records and press Enter"}}},typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.DirFunction=function(){},FastBusiness.AjaxControlExtender.DirFunction.prototype={F11:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){var st=this,ht=!1;ut&&ut.length>0&&(ht=!0);ht?(ft?(s&&st.F20(n,c,l,i,r,u,v,f,a),t&&Array.add(t,[]),st.F28(n,t,o,s,c,l,v,y,p,w,b,k,d,g,tt,it,ut,0),s&&st.F21(n,c,"",a)):s&&st.F34(n,c,l,a),st.F27(n,t,o,s,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,ut),et?(s&&st.F20(n,c,l,i,r,u,v,f,a,!0),t&&Array.add(t,[]),rt?st.F28(n,t,o,s,c,l,v,y,p,w,b,rt.Columns,rt.Width,rt.ColumnCount,rt.Anchor,rt.Split,ut,-1):st.F28(n,t,o,s,c,l,v,y,p,w,b,k,d,g,tt,it,ut,-1),s&&st.F21(n,c,"",a,!0)):s&&st.F0(n,c,l)):(s&&st.F20(n,c,l,i,r,u,v,f,a),t&&Array.add(t,[]),st.F12(n,t,o,s,c,l,v,y,p,w,b,k,d,g),s&&st.F21(n,c,"",a));s&&st.F10(n,e,h,c,v,ot)},F27:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){var d;if(r){for(n.append(String.format('<div id="{0}_Tabs" class="ajax__tab_df" style="width:100%;"><div id="{0}_Tabs_header">',u)),t&&Array.add(t,[]),d=0;d<k.length;d++)this.F29(n,u,d,k[d].Header);n.append(String.format('</div><div id="{0}_Tabs_body" style="height:{1}px;">',u,p))}for(d=0;d<k.length;d++)t&&Array.add(t[t.length-1],[]),this.F32(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,w,b,k,d);r&&n.append("</div></div>")},F29:function(n,t,i,r){n.append(String.format('<span id="{0}_Tabs_Panel{1}_tab"><span class="ajax__tab_outer"><span class="ajax__tab_inner">',t,i+1));var u=String.format(' class="ajax__tab_tab" id="__tab_{0}_Tabs_Panel{1}" tabindex="-1" accesskey="{1}"',t,i+1),f=String.format("var t=$find('{0}')._tabContainer,i={1};i==t._activeTabIndex",t,i),e="t.raiseActiveTabChanged()";$func.isIE||$func.isIx?n.append(String.format('<span{0} tabindex="-1" onfocus="{1}?{2}:t.set_activeTabIndex(i);">{3}</span>',u,f,e,r)):n.append(String.format('<a{0} onclick="{1}&&{2};">{3}</a>',u,f,e,r)),n.append("</span></span></span>"),$func.assignAccessKey(t+"_dlgModalPopupBehavior",String.format("__tab_{0}_Tabs_Panel{1}",t,i+1))},F32:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){var d=b[k].Grid?0:8;r&&n.append(String.format('<div id="{0}_Tabs_Panel{1}" class="ajax__tab_panel" style="padding:{2}px;" {3}>',u,k+1,d,k==0?"":'style="visibility:hidden;"')),this.F28(n,t,i,r,u,f,o,s,h,c,l,a,v,y,p,w,b,b[k].Index),r&&n.append("</div>")},F28:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var d=l,ct=a,vt=v,st=y,ft=p,ut,et,kt,ni,g,rt,it,dt,k;b>0&&(ut=$func.findCategory(b,w),d=ut.Columns,ct=ut.Width,vt=ut.ColumnCount,st=ut.Anchor,ft=ut.Split);var ht=ft>0,ii=st<=ft||!ht,tt="",nt="",bt=0,gt=0,yt=0,ti=0,wt=[],pt=[];if(r&&ht){for(et=d.replace(/ /g,"").split(","),k=0;k<et.length;k++)kt=parseInt(et[k]),k<=ft-1?(bt+=kt,tt!=""&&(tt+=","),tt+=et[k],yt+=1):(gt+=kt,nt!=""&&(nt+=","),nt+=et[k],ti+=1);for(k=1;k<h.length;k++)if(ni=h[k].split(":"),g=ni[0],g.length<vt&&(g+=$func.replicate("-",vt-g.length)),rt=ni[1].split(","),o[parseInt(rt[0].split(".")[0])].CategoryIndex==b){var ri=$func.left(g,ft),ui=$func.right(g,g.length-ft),ot=ri.split("1").length-1;ot<0&&(ot=0);var fi=rt.length-ot,at="",lt="";for(it=0;it<rt.length;it++)it+1<=ot?(at!=""&&(at+=","),at+=rt[it]):(lt!=""&&(lt+=","),lt+=rt[it]);ot>0&&Array.add(wt,ri+":"+at),fi>0&&Array.add(pt,ui+":"+lt)}}if(r&&(ht?(n.append(String.format('<table id="{0}{1}_parentTable" style="border-collapse:collapse;{2}width:{3}px;" cellpadding="0" cellspacing="0"><tbody><th style="width:{4}px"></th><th style="width:{5}px"></th><tr style="vertical-align:top;"><td>',u,b,$func.isOpr?"":"table-layout:fixed;",ct,bt,gt)),this.F30(n,u,b,tt,bt,!ii),this.F14(n,u,tt)):(this.F30(n,u,b,d,ct),this.F14(n,u,d))),ht&&r){for(k=0;k<wt.length;k++)this.F25(n,t,i,r,u,f,e,o,s,wt[k],c,k,yt,b,0,tt,st);for(this.F31(n,u,b,d,ct),n.append("</td><td>"),this.F30(n,u,b,nt,gt,ii),this.F14(n,u,nt),k=0;k<pt.length;k++)this.F25(n,t,i,r,u,f,e,o,s,pt[k],c,k,ti,b,yt,nt,st-yt)}else for(dt=0,k=1;k<h.length;k++)o[parseInt(h[k].split(":")[1].split(",")[0].split(".")[0])].CategoryIndex==b&&(this.F25(n,t,i,r,u,f,e,o,s,h[k],c,dt,vt,b,0,d,st),dt+=1);r&&this.F31(n,u,b,d,ct),r&&ht&&n.append("</td></tr></tbody></table>")},F12:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){r&&(this.F30(n,u,f,l,a),this.F14(n,u,l));for(var y=1;y<h.length;y++)this.F25(n,t,i,r,u,f,e,o,s,h[y],c,y-1,v,0,0,l,0);r&&this.F31(n,u,f,l,a)},F20:function(n,a,t,q,p,d,e,r,s,u){var m=this;if(!u){var b="",f="display:inline-block;overflow:hidden;height:13px;border-width:0px;",o=22,c,l,h='<td nowrap><div id="{0}_ToolbarButton_',i='" {1} style="{2}width:{3}px;" class="ToolbarBackgroundImage {5}" onmouseover="Sys.UI.DomElement.addCssClass(this,\'{5}Over\');" onmouseout="Sys.UI.DomElement.removeCssClass(this,\'{5}Over\');" title="{6}"></div><div style="{2}width:{4}px;"></div></td>',j="onclick=\"$find('{0}').",k=';return false" ondblclick="event.cancelBubble=true;"';if(d){c=$func.getResources(e,r,d[1]).split("$")[0],g=d.length>2;if(!c)c=d[1];if(g)o=30;l=g?"":String.format(j+"executePrint({{commandName:'{1}',commandArgument:'0'}})"+k,a,d[0]);b=String.format(h+"Print"+i,a,l,f,o,1,g?"GroupToolbarPrint":"ToolbarPrint",c);if(q){b+=m.J01(a,f,e,"cloneRow(1)","Clone","Copy",h,i,j,k,0);o+=22}c=m.getResources(e,"Message.Notification");l=String.format(j+"showInfor()"+k,a);b+=String.format(h+"Notification"+i,a,l,f,22,189-o-(p?45:0),"ToolbarNotification",c);if(p){b+=m.J01(a,f,e,"navigation(-1)","Prev","Prev",h,i,j,k,4);b+=m.J01(a,f,e,"navigation(1)","Next","Next",h,i,j,k,0)}}n.append(String.format('<div class="UpdateDlgBorder"><div class="UpdateDlgFloor"><div id="{0}{1}_updateDlgTitle" class="UpdateDlgTitle" ondblclick="$find(\'{0}\').resizeDialog();return false;"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width:100%;"><div id="{0}{1}_updateDlgTitleText" unselectable="on" class="UpdateDlgTitleText">{2}</div></td>{3}</tr></tbody></table></div>',a,t,s,b))}n.append('<div class="UpdateDlgContainer" style="display:block;"><div style="margin:10px;display:none;"></div>');n.append('<div class="UpdateDlgFrame" style="overflow:hidden;white-space:normal;display:block;"><div class="UpdateTaskDialog">');n.append('<div class="UpdateDlgContent">')},J01:function(n,t,i,r,u,f,e,o,s,h,c){var l=this.getResources(i,"Message."+f),r=String.format(s+r+h,n);return String.format(e+u+o,n,r,t,22,c,"Toolbar"+u,l)},F21:function(n){n.append("</div></div></div></div>")},F34:function(n,t,i,r){n.append(String.format('<div class="UpdateDlgBorder"><div class="UpdateDlgFloor"><div id="{0}{1}_updateDlgTitle" class="UpdateDlgTitle"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width:100%;"><div id="{0}{1}_updateDlgTitleText" class="UpdateDlgTitleText">{2}</div></td></tr></tbody></table></div>',t,i,r)),n.append('<div class="TabDlgTop"></div>')},F0:function(n){n.append('<div class="TabDlgBottom"></div>')},F10:function(n,t,i,r,u,f){var y=String.format("onfocus=\"$find('{0}')._select(this);\" onblur=\"$find('{0}')._leave(this);\" onkeydown=\"$find('{0}')._keydown(this, event);\"",r),s="executeDialog",c="cancelDialog",o=[[s+"(0)","New"],[s+"(1)","Edit"],[s+"(2)","Ok",t?"Ok":"Save"],[c+"(0,1)","Cancel"],[c+"(1)","Close"]],e;for(n.append(String.format('<div class="UpdateDlgFooter"><table width="100%" cellpadding="0" cellspacing="0"><tr><td><div id="{0}_Wait"></div></td><td width="100%" align="right">',r)),e=0;e<o.length;e++){var l=this.getResources(u,"Message."+o[e][o[e].length-1]),a=l.split("</u>")[0].split("<u>"),h=(e==2||e==3)&&!f||e==4&&f?"":'style="display:none;"',v=String.format("{0}_updateDlg{1}",r,o[e][1]);a.length>1&&(h+=String.format('{0}key="{1}"',h?" ":"access",a[1])),n.append(String.format('<button type="button" id="{1}" {2} {3} onclick="$find(\'{0}\').{4};return false;">{5}</button>',r,v,h,y,o[e][0],l)),$func.assignAccessKey(r+"_dlgModalPopupBehavior",v)}n.append("</td></tr></table></div></div></div>")},F30:function(n,t,i,r,u,f){n.append(String.format('<table id="{0}{1}_formTable{2}" style="width:{3}px;{4}" class="FormTable" cellpadding="0" cellspacing="0"><tbody>',t,i,f?"split":"",u,$func.isOpr?"":"table-layout:fixed;"))},F31:function(n){n.append("</tbody></table>")},F23:function(n){n.append('<tr class="FormRow">')},F24:function(n){n.append("</tr>")},F14:function(n,t,i){var r='<th style="width:'+i.replace(/ /g,"").replace(/,/g,'px;"></th><th style="width:')+'px;"></th>';this.F23(n),n.append(r),this.F24(n)},F25:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var g=this,ft=[],k=-1,nt=$func.isOpr,ot,d,lt,b,ct,et,it,tt,rt;for(nt&&(ft=p.split(",")),ot=h.split(":"),d=ot[0],d.length<a&&(d+=$func.replicate("-",a-d.length)),lt=ot[1].split(","),r&&g.F23(n),b=0,ct=0;b<d.length;){if(et=d[b],et=="-")r&&(nt&&(k=parseInt(ft[b])),nt&&w==b+1&&(rt=String.format("{0}{1}_formCell_{2}.{3}",u,v,l+1,b+y+1),Array.add(c,[rt,k])),g.F17(n,u,v,null,l,b+y,"",1,k),g.F18(n,u,v,null,l,b+y,"",1,k));else if(et=="1"){for(it=1,tt=b,nt&&(k=parseInt(ft[b]));b<d.length-1&&d[b+1]=="0";)it+=1,b+=1,nt&&(k+=parseInt(ft[b]));var st=lt[ct].split("."),at=parseInt(st[0]),ht=o[at],ut=null;st.length==1&&(ut=g.F35(i,ht,s)),ut=$func.valueToString(ut,ht,!0),nt&&r&&w>0&&tt<=w-1&&tt+it>=w&&(rt=String.format("{0}{1}_formCell_{2}.{3}",u,v,l+1,tt+y+it),Array.add(c,[rt,k])),g.F3(n,t,i,r,u,f,st,e,ht,s,l,tt+y,it,ut,v,k),ct+=1}b+=1}r&&g.F24(n)},F35:function(n,t,i,r){var u=null;return n=="New"?(u=$render.clientDefaultValue(i,t),u!=null||t.DefaultValue==null||t.External||(u=t.DefaultValue)):u=i[t.Index],r&&t.type!="String"&&typeof u=="string"&&(u=$func.stringToValue(u,t)),u},F3:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){var w=this,b;e.length==1?(s.ItemStyle=="Grid"?w.F4(n,r,u,f,o,s,c,l,a,v,y,p,s.Align):s.Items&&s.Items.length>0?s.ItemStyle=="RadioButtonList"?w.F7(n,r,u,f,o,s,c,l,a,v,y,p,s.Align):w.F8(n,r,u,f,o,s,c,l,a,v,y,p,s.Align):s.Rows&&s.Rows>1?w.F9(n,r,u,f,o,s,c,l,a,v,y,p,s.Align):w.F5(n,r,u,f,o,s,c,l,a,v,y,p,s.Align),w.F15(s,t)):(b=e[1]=="0"?s.Label:s.FooterText,w.F6(n,i,r,u,f,o,s,h,c,l,a,b,y,p))},F15:function(n,t){var i,r;!t||n.Hidden||n.ReadOnly||n.Disabled||(i=t[t.length-1],i.length>0&&($func.isString(i[0])||(i=i[i.length-1])),r=n.Name,Array.add(i,n.Name))},F6:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=this;i&&(y.F17(n,r,a,e,s,h,"",c,v,null,!0),y.F1(n,v,e,null,null,!0),y.F19(n,e,l)),y.F2(n,v,e,null,t,i,o,r),i&&y.F18(n,r,a,e,s,h,"",c,v)},F5:function(n,t,i,r,u,f,e,o,s,h,c,l,a){t&&this.F17(n,i,c,f,e,o,"",s,l,f.Type!="Boolean"&&!f.AllowNulls&&!f.ReadOnly&&f.Visible&&f.FilterSource!="Optional"),t&&this.F1(n,l,f,!0,!0),this.F16(n,t,i,r,f,u,h,a),t&&this.F2(n,l,f,!0),t&&this.F18(n,i,c,f,e,o,"",s,l)},F9:function(n,t,i,r,u,f,e,o,s,h,c,l,a){t&&this.F17(n,i,c,f,e,o,"",s,l),t&&this.F1(n,l,f,!0),this.F33(n,t,i,r,f,u,h,a),t&&this.F2(n,l,f,!0),t&&this.F18(n,i,c,f,e,o,"",s,l)},F8:function(n,t,i,r,u,f,e,o,s,h,c,l,a){t&&this.F17(n,i,c,f,e,o,"",s,l),t&&this.F1(n,l,f,!0),this.F26(n,t,i,r,f,u,h,a),t&&this.F2(n,l,f,!0),t&&this.F18(n,i,c,f,e,o,"",s,l)},F7:function(n,t,i,r,u,f,e,o,s,h,c,l,a){t&&this.F17(n,i,c,f,e,o,"",s,l),t&&this.F1(n,l,f,!0),this.F22(n,t,i,r,f,u,h,a),t&&this.F2(n,l,f,!0),t&&this.F18(n,i,c,f,e,o,"",s,l)},F4:function(n,t,i,r,u,f,e,o,s,h,c,l,a){t&&(n.append(String.format('<td id="{0}{1}_formCell_{2}.{3}" nowrap style="overflow:hidden;width:{5};padding:0px!important;"{4} class="FormCellGrid"><div tabindex=-1 TabStop=false style="outline:none;">',i,c,e+1,o+(s?s:1),s?String.format(" colspan={0}",s):"",l==-1?"100%":l+"px")),this.F13(n,t,i,r,f,u,h,a),n.append("</div></td>"))},F17:function(n,t,i,r,u,f,e,o,s,h,c){var a=e?String.format("text-align:{0};",e):"",l=r&&r.FilterSource=="Plugin",v=l?"0":c&$func.isFF?"2px 4px 6px 4":"4";n.append(String.format('<td id="{0}{1}_formCell_{2}.{3}" nowrap style="overflow:hidden;width:{7};{4}padding:{5}px!important;"{6} class="FormCell{8}{9}">',t,i,u+1,f+(o?o:1),a,v,o?String.format(" colspan={0}",o):"",s==-1?"100%":(s>8?s-8:0)+"px",l?"Grid":"",h?" Required "+$func.replace(t,".","_"):""))},F18:function(n){n.append("</td>")},F1:function(n,t,i,r,u,f){var o=i&&i.FilterSource=="Plugin",e=i.Rows&&i.Rows>1;o?n.append('<div tabindex="-1" tabstop="false" style="outline:none;width:100%;overflow:hidden;">'):n.append(String.format('<div style="width:{0};{1}overflow:hidden;vertical-align:{2};" class="FormContainer{3} {4}">',t==-1?"100%":(t>10?t-10:0)+"px",f||$func.isIx&&u&&!i.Hidden&&Sys.Browser.version!=8?"max-height:13px;":"",e?"top":"middle",r?String.format(" {0}{1}",e?"FormContainerTextArea":"FormContainerInput",i.ReadOnly?"Disabled":""):"",r&this.isFieldRight(i)?" FormAlignRight":""))},F2:function(n,t,i,r,u,f,e,o){if(i._flag&&!r&&o){var h=i._flag.Column,s=this.F35(u,h,e,!0);f?n.append(String.format('<a id="{0}_Flag" tabindex="-1" tabstop="false" class="Flag{1}" onclick="$find(\'{0}\')._onFlag(this, null);return false"/></td></tr></tbody></table>',o,s?" Red":"")):$find(o)._onFlag(null,s)}(f||!o)&&n.append("</div>")},F19:function(n,t,i){t._flag?n.append(String.format('<table style="border-collapse:collapse;" cellpadding="0" cellspacing="0"><tbody><tr><td><span title="{0}" class="Cover" style="max-width:{1}px;">{0}</span></td><td>',i,t._flag.Width)):n.append(i)},F16:function(n,t,i,r,u,f,e,o){var h=u.Type,c,l,a;if(t){var s=h!="Boolean",v=u.FooterText,y="";if(v&&(c=v.split("</u>")[0].split("<u>"),c.length>1&&c[1].length==1&&(y=String.format('accesskey="{0}" ',c[1]),$func.assignAccessKey(i+"_dlgModalPopupBehavior",String.format("{0}{1}_form_{2}",i,r,u.Name)))),u.Hidden){n.append(String.format('<input id="{0}{1}_form_{2}" type="{3}" value="{4}" {5}{6}/>',i,r,u.Name,s?"hidden":"checkbox",s?h=="String"&&$func.isString(e)?$func.htmlAttributeEncode(e):e:"",s?"":(e?"checked":"")+' style="display:none;"',s&&u.MaxLength&&u.MaxLength>0?String.format(' maxlength="{0}"',u.MaxLength):""));return}l=$func.contextMenu(f),n.append(String.format('<input id="{0}{1}_form_{2}" {3} onfocus="$df.focus(this);" onblur="$df.blur(this);" onkeypress="$df.keypress(event, this, \'{2}\');" style="{4}{5}" {6} {7}{8} ondrop="return false" spellcheck="false" autocomplete="off" class="{9}" type="{10}" value="{11}" {12}{13}/>',i,r,u.Name,y+(u.ClientScript?this.clientScript(u.ClientScript):""),"",o?String.format("text-align:{0};",o):"",u.ReadOnly?s?'readonly="readonly"':'disabled="disabled"':"",u.Inactivate||u.ReadOnly?"tabindex=-1 TabStop=false":"",u.MaxLength&&u.MaxLength>0&&u.ItemStyle!="AutoComplete"?String.format(' maxlength="{0}"',u.MaxLength):"",String.format("FormInput{0} {1}{0}",u.ReadOnly?"Disabled":"",s?"FormTextInput":"FormCheckInput"),s?"text":"checkbox",s?h=="String"&&$func.isString(e)?$func.htmlAttributeEncode(e):e:"",s?"":e?"checked":"",l&&l.length?String.format(' oncontextmenu="{0}"',l):""))}else a=$get(String.format("{0}{1}_form_{2}",i,r,u.Name)),h=="Boolean"?a.checked=e:a.value=e},F33:function(n,t,i,r,u,f,e,o){var s,h;t?(s=$func.contextMenu(f),n.append(String.format('<textarea id="{0}{1}_form_{2}" {3} rows="{4}" cols="{5}" onfocus="$df.focus(this);" onblur="$df.blur(this);" onkeypress="$df.keypress(event, this, \'{2}\');" style="resize:none;{6}{7}" {8} {9} {10} ondrop="return false" spellcheck="false" autocomplete="off" class="{11}" {12}>{13}</textarea>',i,r,u.Name,u.ClientScript?this.clientScript(u.ClientScript):"",u.Rows,u.Columns&u.Columns>0?u.Columns:50,u.Hidden?"display:none;":"",o?String.format("text-align:{0};",o):"",u.ReadOnly?'readonly="readonly"':"",u.Inactivate||u.ReadOnly?"tabindex=-1 TabStop=false":"",u.MaxLength&&u.MaxLength>0?String.format('maxlength="{0}"',u.MaxLength):"",String.format("FormTextArea{0} {1}{0}",u.ReadOnly?"Disabled":"","FormTextInput"),s&&s.length?String.format('oncontextmenu="{0}"',s):"",$func.htmlEncode(e)))):(h=$get(String.format("{0}{1}_form_{2}",i,r,u.Name)),h.innerHTML=$func.htmlEncode(e),h.value=e)},F26:function(n,t,i,r,u,f,e){var l,c,s,h,o;if(t){for(n.append(String.format('<select id="{0}{1}_form_{2}" {3} size="{4}" onfocus="$df.focus(this);" onblur="$df.blur(this);" onkeypress="$df.keypress(event, this, \'{2}\');" {5} {6} {7} class="{8}" value="{9}">',i,r,u.Name,u.ClientScript?this.clientScript(u.ClientScript):"",u.ItemStyle=="ListBox"?u.Rows&&u.Rows>1?u.Rows:5:"1",u.Hidden?'style="display:none;"':"",u.ReadOnly?'readonly="readonly"':"",u.Inactivate||u.ReadOnly?"tabindex=-1 TabStop=false":"",String.format("Form{0}{1} {2}{1}",u.ItemStyle=="ListBox"?"ListBox":"ComboBox",u.ReadOnly?"Disabled":"","FormTextInput"),e)),e==null&&(e=""),e=e.toString(),s=0;s<u.Items.length;s++)h=u.Items[s],o=h[0],o==null&&(o=""),o=o.toString(),n.append(String.format('<option value="{0}"{1}>{2}</option>',o,o==e?" selected":"",$func.htmlEncode(h[1])));n.append("</select>")}else{for(l=$get(String.format("{0}{1}_form_{2}",i,r,u.Name)),c=0,s=0;s<u.Items.length;s++)if(h=u.Items[s],o=h[0],o==null&&(o=""),o==e){c=s;break}l.selectedIndex=c}},F22:function(n,t,i,r,u,f,e){var c,y,l,a,v,s,p,o,h;if(t){for(n.append('<table cellpadding="0" cellspacing="0" class="FormRadioButtonList">'),c=u.Columns&u.Columns>0?u.Columns:1,y=Math.floor(u.Items.length/c)+(u.Items.length%c>0?1:0),l=0;l<y;l++){for(n.append("<tr>"),a=0;a<c;a++)v=a*y+l,v<u.Items.length?(o=u.Items[v],h=o[0]==null?"":o[0].toString(),e==null&&(e=""),e=e.toString(),n.append(String.format('<td class="Button"><input type="radio" id="{0}{1}_form_{2}{3}" name="{0}{1}_form_{2}" {4} onfocus="$df.focus(this);" onblur="$df.blur(this);" onkeypress="$df.keypress(event, this, \'{2}\');" {5} {6} {7} value="{8}"{9}/></td><td class="Option"><label for="{0}{1}_form_{2}{3}">{10}</label></td>',i,r,u.Name,v,u.ClientScript?this.clientScript(u.ClientScript):"",u.Hidden?'style="display:none;"':"",u.ReadOnly?'readonly="readonly"':"",u.Inactivate||u.ReadOnly?"tabindex=-1 TabStop=false":"",h,h==e?" checked":"",$func.htmlEncode(o[1])))):n.append('<td class="Button">&nbsp;</td><td class="Option"></td>');n.append("</tr>")}n.append("</table>")}else for(s=0;s<u.Items.length;s++)p=$get(String.format("{0}{1}_form_{2}{3}",i,r,u.Name,s)),p&&(o=u.Items[s],h=o[0]==null?"":o[0].toString(),e==null&&(e=""),e=e.toString(),p.checked=h==e)},F13:function(n,t,i,r,u){t&&n.append(String.format('<div id="{0}{1}_form_{2}" tabindex=-1 TabStop=false style="width:100%;" class="GridTabPanel"></div>',i,r,u.Name))},isFieldRight:function(){return!1},clientScript:function(n){return n},focus:function(n){var t,i;n.live=!0,t=n.field,!t||t.Items&&t.Items.length>0||(i=!0,n._controlBehavior&&n._styleBehavior=="Numeric"&&n._controlBehavior._isOpen&&(i=!1),i&&(n._lastValue=this.getObjectValue(n)),t.ItemKeyFilter&&n._controlBehavior&&(t.ItemStyle=="AutoComplete"||t.ItemStyle=="Lookup")&&(t.ItemKeyFilter&&n._controlBehavior.set_completionKeyFilter(this.completionFilter(n.parentForm._fields,t.ItemKeyFilter,n.parentForm._id,n.parentForm._form)),t.ItemCheckFilter&&n._controlBehavior.set_completionCheckFilter(this.completionFilter(n.parentForm._fields,t.ItemCheckFilter,n.parentForm._id,n.parentForm._form)))),n.parentForm&&(n.parentForm._activeControl=n),($func.isOpr||$func.isFF)&&n.type=="checkbox"&&Sys.UI.DomElement.addCssClass(n,"ObjectSelected")},blur:function(n){n.live=null;var t=n.field;n._currentValue=this.getObjectValue(n),window.setTimeout(String.format("$df.detachContextMenu('{0}');",n.id),300),n._controlBehavior&&n._styleBehavior=="Numeric"&&(n._controlBehavior.hide(),n._currentValue!=n._lastValue&&(n._lastValue=n._currentValue,$func.fireChanged(n))),($func.isOpr||$func.isFF)&&n.type=="checkbox"&&Sys.UI.DomElement.removeCssClass(n,"ObjectSelected")},getObjectValue:function(n){var t=n.field;return t.Type=="Boolean"?n.checked:$func.stringToValue(n.value,t)},detachContextMenu:function(n){var t=$get(n);t&&$func.detachContextMenu(t)},keypress:function(n,t){n.keyCode==13&&t.parentForm&&t.parentForm._processKeyEvents(n,t)},addControlBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){var b,w;n.addControl||(this.attachControl(n,t,i,u,'WebResource.axd?d=6_B8r3tInx3NyTKhjMaWxfYt1PyyrV_vdAdFQeflHh0usPrBMaO7hi-LMmvHAwWSXve9C8HDLRf_UWfvKNCxbmgh8ZGlCsUvsOiRuN_6fVt_uZJceYdiMcKsfZmeRZRxrsXSWhawj7y6YNvqWoGhJXtA5JpbgoMRq1zv4IiesxE1&t=638255301260000000'),n.addControl=!0);b=null;u.ItemStyle=="AutoComplete"&&(w=u.ItemReference,w&&w.length>0&&(b=$get(String.format("{0}{1}_form_{2}",t,i,w))));this.attachControlBehavior(n,r,u,u.ItemController,b,t,i,f,e,o,s,h,c,l,a,v,y,p)},attachControl:function(n,t,i,r,u){r.ItemStyle=="AutoComplete"?this.attachAutoCompleteControl(n,t,i,u,r,r.Align):r.ItemStyle=="Lookup"?this.attachLookupControl(n,t,i,u,r,r.Align):r.Type=="DateTime"&&this.attachCalendarControl(n,t,i,u,r,r.Align)},attachAutoCompleteControl:function(n,t,i,r,u,f){this.attachImageControl(n,t,i,"CellImage CellImgLookup",r,u,f)},attachLookupControl:function(n,t,i,r,u,f){this.attachImageControl(n,t,i,"CellImage CellImgLookup",r,u,f)},attachCalendarControl:function(n,t,i,r,u,f){this.attachImageControl(n,t,i,"CellImage CellImgCalendar",r,u,f)},attachImageControl:function(n,t,i,r,u,f,e,o){var h,s,c;n.a=$common.createElementFromTemplate({nodeName:"a",properties:{style:{border:"none",color:"#0066A7",textDecoration:"none"}},cssClasses:["CellDivContainer"]}),h=n.img=$common.createElementFromTemplate({nodeName:"img",properties:{src:u,style:{border:"none",padding:"0px"}},cssClasses:[r]}),o?(n.a.TabStop=!0,n.a.tabIndex=0):(n.a.TabStop=!1,n.a.tabIndex=-1),h.tabIndex=-1,h.TabStop=!1,n.a.appendChild(h),s=n,f.HandleReference&&f.HandleReference.length>0&&(c=$get(String.format("{0}{1}_form_{2}",t,i,f.HandleReference)),c&&(s=c,e=s.style.textAlign,n.p=s)),this.resizeImage(n),e!="right"?s.parentNode.appendChild(n.a):s.parentNode.insertBefore(n.a,s)},resizeImage:function(n){var t=n,i;n.p&&(t=n.p),t._lastWidth?i=t._lastWidth:(i=$func.getObjectWidth(t.parentNode)-17,t._lastWidth=i),i>0&&(t.style.width=i+"px")},attachControlBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var k=this,d=i.DataFormatString;i.ItemStyle=="Grid"?k.attachGridBehavior(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b):i.ItemStyle=="AutoComplete"?k.attachAutoCompleteBehavior(n,t,i,r,u,f,e,a,v,w,b,y,p):i.ItemStyle=="Lookup"?k.attachLookupBehavior(n,t,i,r,f,e,a,v,w,b,y,p):i.ItemStyle=="Numeric"?k.attachNumericBehavior(n,f,e,i,d):i.Type=="DateTime"?k.attachCalendarBehavior(n,f,e,i,d,v):i.ItemStyle=="Mask"?k.attachMaskBehavior(n,f,e,i,d):$func.isTimeFormat(i.DataFormatString)&&k.attachTimeSpanBehavior(n,f,e,i,d)},attachGridBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var d,k,g;if(!n._controlBehavior){for(d=[],k=0;k<i.Items.length;k++)if(g=i.Items[k],g[0]=="ForeignKey"){var nt=g[1].split(":"),tt=nt[1].split(","),it=$func.trim(tt[0]),rt=$func.trim(tt[1]),ut={Name:rt,Opr:"=",Value:n.parentForm.getItemValue(it),Type:$func.trim(nt[0]),Ignore:!1};Array.add(d,ut)}n._controlBehavior=$create(FastBusiness.AjaxControlExtender.ReportExtender,{id:f+"_FormGrid"+i.Name,readOnly:i.ReadOnly,allowDelete:!1,allowEdit:!0,allowNew:!1,confirmDelete:!0,childObject:!0,memvars:n._memvars?n._memvars:[],variable:n._variable?n._variable:"",externalKey:d,anchor:!1,fixedHeight:i.Rows,gridTitle:i.HeaderText,initPageSize:0,baseUrl:p,controller:i.ItemController,viewId:i.ItemReference,initFirstRow:!i.AllowNulls,clone:o,autoExpansion:s,redundant:h,denySessionStorage:c,hashValue:l,cookie:a,footerAdjustment:!1,language:v,serviceLookup:y,servicePath:w,serviceMethod:b},null,null,n)}},attachAutoCompleteBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l,a){var p,y,v;if(!n._controlBehavior){if(p=!1,y=i.ItemNew,y&&y.length>0&&(p=!0),y=="Default"&&(y=i.ItemController),v=n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridLookup,{id:f+"_FormLookup"+i.Name,allowNew:p,baseUrl:a,dirController:y,controller:r,cookie:o,language:s,showOnForm:!0,currentPrefix:n.value,dirService:h,dirMethod:c,servicePath:l},null,null,n),v._grant(n.parentForm),n._styleBehavior="AutoComplete",v.set_label(u),v.set_button(n.a.childNodes[0]),i.Align=="right"&&(v.set_completionValueAlign("right"),v.set_padSize(i.MaxLength)),i.ItemNormalCase&&v.set_upperCase(!1),i.ItemKeyFilter&&v.set_completionKeyFilter(this.completionFilter(t,i.ItemKeyFilter,f,e)),i.ItemCheckFilter&&v.set_completionCheckFilter(this.completionFilter(t,i.ItemCheckFilter,f,e)),u)try{$func.setTextStatus(u.value)}catch(w){}n.p&&v.set_elementFocus(n.p),i.ItemRowCount>0&&v.set_initLabel(!0)}},attachLookupBehavior:function(n,t,i,r,u,f,e,o,s,h,c,l){var y,v,a;n._controlBehavior||(i.Align=="right"&&(n.value=this.trim(n.value)),y=!1,v=i.ItemNew,v&&v.length>0&&(y=!0),v=="Default"&&(v=i.ItemController),a=n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridLookup,{id:u+"_FormLookup"+i.Name,allowNew:y,baseUrl:l,dirController:v,controller:r,cookie:e,language:o,showOnForm:!0,multipleSelection:!0,currentPrefix:n.value,dirService:s,dirMethod:h,servicePath:c},null,null,n),a._grant(n.parentForm),n._styleBehavior="AutoComplete",a.set_button(n.a.childNodes[0]),i.Align=="right"&&(a.set_completionValueAlign("right"),a.set_padSize(i.MaxLength)),i.ItemNormalCase&&a.set_upperCase(!1),i.ItemKeyFilter&&a.set_completionKeyFilter(this.completionFilter(t,i.ItemKeyFilter,u,f)),i.ItemCheckFilter&&a.set_completionCheckFilter(this.completionFilter(t,i.ItemCheckFilter,u,f)))},attachNumericBehavior:function(n,t,i,r,u){n._controlBehavior||(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridNumeric,{id:t+"_FormNumeric"+r.Name,format:u,showOnForm:!0},null,null,n),n._styleBehavior="Numeric")},attachCalendarBehavior:function(n,t,i,r,u,f){!n._controlBehavior&&n.a&&(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridCalendar,{id:t+"_FormCalendar"+r.Name,language:f,showOnForm:!0},null,null,n),n._controlBehavior.set_button(n.a.childNodes[0]),n._styleBehavior="Calendar")},attachMaskBehavior:function(n,t,i,r,u){n._controlBehavior||(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.GridMask,{id:t+"_FormMask"+r.Name,format:u,showOnForm:!0},null,null,n),n._styleBehavior="Mask")},attachTimeSpanBehavior:function(n,t,i,r,u){n._controlBehavior||(n._controlBehavior=$create(FastBusiness.AjaxControlExtender.TimeSpan,{id:t+"_FormTimeSpan"+r.Name,format:u,showOnForm:!0},null,null,n),n._styleBehavior="TimeSpan")},completionFilter:function(n,t,i,r){for(var o=new Sys.StringBuilder,a,v=/([\s\S]*?)\{([\s\S]*?)\}/g,s=0,f=v.exec(t),u,y,h;f;){if(s=f.index+f[0].length,o.append(f[1]),u=f[2],u){u=u.replace("$%c",String.format("{0}_form_",i,r)).replace("$%r",r).replace("$%id",i);for(var p=/([\s\S]*?)\[([\s\S]*?)\]/g,c=new Sys.StringBuilder,l=0,e=p.exec(u);e;)l=e.index+e[0].length,c.append(e[1]),y=e[2],c.append(y),l<u.length&&o.append(u.substring(l)),a=c.toString(),e=p.exec(u);h=$get(a),h&&o.append(h.value.replace(/\x27/g,"''"))}f=v.exec(t)}return s<t.length&&o.append(t.substring(s)),o.toString()},getHeaderInfor:function(n){for(var i=0,r=n.split(","),t=0;t<r.length;t++)i+=parseInt($func.trim(r[t]));return[i,n.split(",").length]},getResources:function(l,r){var _v=String.format("l == 'v' ? FastBusiness.AjaxControlExtender.DirFunction.Resources.{0}.v : FastBusiness.AjaxControlExtender.DirFunction.Resources.{0}.e",r);return eval(_v)}};var $df=new FastBusiness.AjaxControlExtender.DirFunction;FastBusiness.AjaxControlExtender.DirExtender=function(n){FastBusiness.AjaxControlExtender.DirExtender.initializeBase(this,[n]),this._type=null,this._language=null,this._controller=null,this._viewId=null,this._servicePath=null,this._serviceLookup=null,this._baseUrl=null,this._checking=null,this._closing=null,this._title=null,this._action=null,this._fields=[],this._row=[],this._renderInfor=[],this._values=[],this._vars=[],this._form="",this._categories=[],this._viewMode=!1,this._searchMode=!1,this._formMode=!1,this._resizable=!1,this._tabs=!1,this._parentType="Dir",this._denyFocus=null,this._flowScript=null,this._clone=null,this._break=null,this._vacant={}},FastBusiness.AjaxControlExtender.DirExtender.prototype={initialize:function(){FastBusiness.AjaxControlExtender.DirExtender.callBaseMethod(this,"initialize"),this._formKeydownHandler=Function.createDelegate(this,this._formKeydown),this._formKeypressHandler=Function.createDelegate(this,this._formKeypress),this._keypressdown=Function.createDelegate(this,this._onKeyPressdown),this._keypressHandler=Function.createDelegate(this,this._onKeyPress),this._keypressup=Function.createDelegate(this,this._onKeyPressup),this._readOnlyKeyHandler=Function.createDelegate(this,this._onReadOnlyKeyHandler),this._groupOnShowingHandler=Function.createDelegate(this,this._groupOnShowing)},dispose:function(){this._script&&(this._script.parentNode&&this._script.parentNode.removeChild(this._script),this._script=null),this._css&&(this._css.parentNode&&this._css.parentNode.removeChild(this._css),this._css=null),this._container&&this._formKeydownHandler&&$removeHandler(this._container,"keydown",this._formKeydownHandler),this._container&&this._formKeypressHandler&&$removeHandler(this._container,"keypress",this._formKeypressHandler),this._formKeydownHandler=null,this._formKeypressHandler=null,this.removeCssClass(),this.closeDialog(),this._onKeyPressdown=null,this._keypressHandler=null,this._keypressup=null,this._readOnlyKeyHandler=null,this._groupOnShowingHandler=null,FastBusiness.AjaxControlExtender.DirExtender.callBaseMethod(this,"dispose")},get_language:function(){return this._language},set_language:function(n){this._language!=n&&(this._language=n)},get_controller:function(){return this._controller},set_controller:function(n){this._controller=n},get_viewId:function(){return this._viewId},set_viewId:function(n){this._viewId=n},get_viewMode:function(){return this._viewMode},set_viewMode:function(n){this._viewMode=n},get_searchMode:function(){return this._searchMode},set_searchMode:function(n){this._searchMode=n},get_formMode:function(){return this._formMode},set_formMode:function(n){this._formMode=n},get_parentType:function(){return this._parentType},set_parentType:function(n){this._parentType=n},get_servicePath:function(){return this._servicePath},set_servicePath:function(n){this._servicePath=n},get_serviceLookup:function(){return this._serviceLookup},set_serviceLookup:function(n){this._serviceLookup=n},get_baseUrl:function(){return this._baseUrl},set_baseUrl:function(n){this._baseUrl=n},get_values:function(){return this._values},set_values:function(n){this._values!=n&&(this._values=n)},get_vars:function(){return this._vars},set_vars:function(n){this._vars!=n&&(this._vars=n)},get_cookie:function(){return this._cookie},set_cookie:function(n){this._cookie=n},_initDir:function(){var t=this._formMode?this.entity:this.grid,n=this._searchMode?t._searchInfor:this.grid._dirInfor,i;this._title=n.TitleText,this._renderInfor=n.DirInfor.split(";"),this._searchMode?(t._searchHeader||(t._searchHeader=this._renderInfor[0]),this._header=t._searchHeader):(this.grid._dirHeader||(this.grid._dirHeader=this._renderInfor[0]),this._header=this.grid._dirHeader),this.grid._ground||this.grid.set_ground(n.Ground),this._ground=n.Ground,i=$df.getHeaderInfor(this._header),this._width=i[0],this._columns=i[1],this._fields=n.Fields,this._tabHeight=n.Height,this._anchor=n.Anchor,this._split=n.Split,this._categories=n.Categories,this._categories&&this._categories.length>0&&(this._tabs=!0),this._initFields(),this._initLayout()},_initFields:function(){var n=this,u,r,o,t;for(n._controlFields=[],n._gridFields=[],n._conceal=[],t=1;t<n._renderInfor.length;t++)for(u=n._renderInfor[t].split(":")[1].split(","),r=0;r<u.length;r++){var s=u[r].split("."),f=parseInt(s[0]),i=n._fields[f],e=i.CategoryIndex;r==0&&(n._renderTop||e!=0||(n._renderTop=!0),n._renderBottom||e!=-1||(n._renderBottom=!0)),(i.ItemStyle=="Grid"||i.FilterSource=="Plugin")&&(o=$func.findCategory(e,n._categories),o&&(o.Grid=!0)),s.length==1&&(Array.add(n._controlFields,f),i.ItemStyle=="Grid"&&Array.add(n._gridFields,f)),n._flag&&i.Name==n._flag.Reference&&(i._flag=n._flag)}if(n._fields.length!=n._controlFields.length)for(t=0;t<n._fields.length;t++)n._fields[t].FilterSource!="Vacant"||Array.contains(n._controlFields,t)||Array.add(n._conceal,t)},_initLayout:function(){var f,c,r,u,y,t,i,l,e,s,n,o;if(this._resizeWidthControls=[],this._resizeHeightControls=[],f="{0}{1}_formTable",c="{0}{1}_parentTable",this._anchor>0){if(r=this._anchor-1,u=parseInt(this._header.split(",")[r]),this._tabs){if(this._split>0){var a=0,v=0,e=this._header.replace(/ /g,"").split(",");for(t=0;t<e.length;t++)n=parseInt(e[t]),t<=this._split-1?a+=n:v+=n;this._anchor<=this._split?(n=a,o=0):(n=v,o=1)}this._renderTop&&(this._split>0?(Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),0),n,r,u,-1]),Array.add(this._resizeWidthControls,[String.format(c,this.get_id(),0),this._width,o,n,-2])):Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),0),this._width,r,u,-1])),this._renderBottom&&!this._ground&&(this._split>0?(Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),-1),n,r,u,-1]),Array.add(this._resizeWidthControls,[String.format(c,this.get_id(),-1),this._width,o,n,-2])):Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),-1),this._width,r,u,-1]))}else Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),this._form),this._width,r,u,-1]);this._resizable=!0}for(y=this._categories.length,this._ground&&(y+=1),t=0;t<y;t++){t==this._categories.length?(i=this._ground,l=-9):(i=this._categories[t],l=t),e=i.Columns.replace(/ /g,"").split(","),t==this._categories.length?this._ground.ColumnCount=e.length:this._categories[t].ColumnCount=e.length;var h=0,a=0,v=0;for(s=0;s<e.length;s++)n=parseInt(e[s]),h+=n,s<=i.Split-1?a+=n:v+=n;t==this._categories.length?this._ground.Width=h:this._categories[t].Width=h,i.Anchor>0&&(r=i.Anchor-1,u=parseInt(e[r]),i.Split>0?(i.Anchor<=i.Split?(n=a,o=0):(n=v,o=1),Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),i.Index),n,r,u,l]),Array.add(this._resizeWidthControls,[String.format(c,this.get_id(),i.Index),h,o,n,-2])):Array.add(this._resizeWidthControls,[String.format(f,this.get_id(),i.Index),h,r,u,l]),this._resizable=!0)}this._tabs&&this._resizable&&Array.add(this._resizeHeightControls,[String.format("{0}_Tabs_body",this.get_id()),this._tabHeight,-1])},_initContainer:function(){if(!this._container){var n=this._container=document.createElement("div"),t=this._container.a=document.createElement("a");document.body.appendChild(n),document.body.appendChild(t),n.className="UpdateDlgPanel",n.id=this.get_id()+"_updateDlgPanel",n.style.width=this._width+23+"px",Sys.UI.DomElement.setVisibilityMode(n,Sys.UI.VisibilityMode.hide),Sys.UI.DomElement.setVisibilityMode(n.a,Sys.UI.VisibilityMode.hide),$addHandler(this._container,"keydown",this._formKeydownHandler),$addHandler(this._container,"keypress",this._formKeypressHandler)}},_attachBehaviors:function(){var n=this,i,r,t,u;for(n._detachBehaviors(),r=0;r<n._fields.length;r++)if(i=n._fields[r],t=n.getItem(i.Name),t)if(t.field=i,t.parentForm=n,t._lastValue=$df.getObjectValue(t),i.ItemStyle=="Lookup")if($func.isIF)t.readOnly=!0;else try{t.AddReadOnlyKeyHandler||($addHandler(t,"keydown",n._readOnlyKeyHandler),$func.isOpr&&$addHandler(t,"keypress",n._readOnlyKeyHandler),t.AddReadOnlyKeyHandler=!0)}catch(f){}else if($func.isOpr&&i.ItemStyle!="Grid")try{t.AddKeyHandler||(n._addKeyHandler(t),t.AddKeyHandler=!0)}catch(f){}for(r=0;r<n._controlFields.length;r++)i=n._fields[n._controlFields[r]],n._isControlField(i)&&(t=n.getItem(i.Name),t&&(n._controlFocus||(n._controlFocus=t),n._searchMode&&(t._searchMode=!0),u=n.grid,$df.addControlBehavior(t,n.get_id(),n._form,n._fields,i,n._clone,u._autoExpansion,u.g$t,u._denySessionStorage,u._hashValue,n._cookie,n._language,n._serviceLookup,u._baseUrl,u.get_dirService(),n.grid.get_dirMethod())));n._attachToolbarBehaviors()},_detachBehaviors:function(){var n,t,i;if(this._detachToolbarBehaviors(),this._controlFocus=null,this._controlFields)for(n=0;n<this._controlFields.length;n++)t=this._fields[this._controlFields[n]],this._isControlField(t)&&(i=this.getItem(t.Name),i&&$func.detachControlBehavior(i))},_attachToolbarBehaviors:function(){var c=this,k=null,g=c.get_id(),j=-4,p=4,o=-1;if($func.isOpr||$func.isFF&&Sys.Browser.version>=3||!$func.isIE)j=0;if(c._trayButton){var d=c._trayButton;if(d.length>2){var b=d[0],l=d[2],n=$get(g+"_ToolbarButton_"+b);if(n){var e=d._panel=document.createElement("div");e.id=g+"_ToolbarGroupPanel"+b;Sys.UI.DomElement.setVisible(e,false);c.get_element().appendChild(e);e.className="MenuExtenderContextPanel MenuExtenderContextBarPanel";for(var h=new Sys.StringBuilder,i=0;i<l.length;i++){var a=l[i];if(a.Hidden)continue;if(b==k||b.length==0||a.CommandName=="-")h.append('<div class="ContextMenuExtenderBreak"></div>');else if(!a.MenuItems){var m=a.UrlImage?String.format("style=\"background-image:url('{0}');\"",a.UrlImage):"";if(a.Disabled||a.Interrupted)h.append(String.format('<a {3} class="MenuExtenderContextItemDisabled {1}"><div class="Title">{0}</div><div class="Description">{2}</div></a>',a.CommandName,b,"",m));else h.append(String.format('<a href="#" onclick="$find(\'{0}\').executePrint({{commandName:\'{4}\',commandArgument:\'{8}\',CommandIndex:{1}}});return false;" {7} class="MenuExtenderContextItem {4}"><div class="Title">{3}</div><div class="Description">{5}</div></a>',g,i,0,a.CommandName,b,"",d.Scope,m,a.Target))}else{o+=1;h.append(String.format('<a href="#" onclick="$find(\'{0}\').activateToolbarItem(\'{1}\',{2},\'{3}\');return false;" class="MenuExtenderGroupItem {4}"><div id="{1}_ItemGroup{2}" class="Title">{5}</div></a>',c.grid.get_id(),g,o,b,a.CssClass,a.CommandName,b))}}e.innerHTML=h.toString();var f=d._popupBehavior=$create(FastBusiness.AjaxControlExtender.PopupControlBehavior,{id:g+"_ToolbarGroupPopup"+b,PopupControlID:e.id,Position:AjaxControlToolkit.PopupControlPopupPosition.Bottom,OffsetY:p,OffsetX:j},k,k,n);f._popupBehavior.add_showing(c._groupOnShowingHandler);f.showPopup();var q=f._popupElement.offsetWidth;f._offsetX=(c._trayButton.length>2?30:22)-q-j;f.hidePopup()}}}},_detachToolbarBehaviors:function(){if(this._trayButton){var n=this._trayButton;n._popupBehavior&&(n._popupBehavior.dispose(),n._popupBehavior=null,n._panel.parentNode.removeChild(n._panel),n._panel=null)}},_groupOnShowing:function(){$find(this.grid.get_id()).disposeToolbarInstance()},_formKeydown:function(n){if(n.keyCode==Sys.UI.Key.esc){if(!this._inactive){var t=this.get_id(),i=this._findButton("Cancel");if(i&&i.tabIndex!=-1){$func.cancelEvent(n),this.grid._type!="Voucher"||this._action=="View"||this._searchMode?($func.isCs&&i.focus(),window.setTimeout(String.format("$find('{0}').cancelDialog();",t),1)):$message.show($df.getResources(this._language,"Message.ConfirmEscape"),0,String.format("$find('{0}').cancelDialog();",t),String.format("$get('{0}_updateDlgOk').focus();",t));return}}}else n.ctrlKey&&n.keyCode==83&&!this._inactive&&($func.cancelEvent(n),$func.isOpr||this._onSave())},_formKeypress:function(n){if(!$func.isIF&&n.ctrlKey&&n.keyCode==83&&!this._inactive){$func.cancelEvent(n);return}},_onKeyPressdown:function(n){if(n.ctrlKey&&n.keyCode==83&&($func.isCs||$func.cancelEvent(n),$func.isOpr)){this._onSave();return}this._getReadOnly()&&(this._isNavKey(n)||$func.cancelEvent(n))},_onKeyPress:function(n){this._getReadOnly()?this._isNavKey(n)||$func.cancelEvent(n):n.ctrlKey&&$func.keyCode(n)==83&&$func.cancelEvent(n)},_onKeyPressup:function(){},_onReadOnlyKeyHandler:function(n){n.ctrlKey&&n.keyCode==83||this._isNavKey(n)||$func.cancelEvent(n)},_onFlag:function(n,t){var i,r,u;if(n||(n=$get(String.format("{0}_Flag",this._id))),i="Red",t==null){if(this._action=="View")return;t=!Sys.UI.DomElement.containsCssClass(n,i)}t?Sys.UI.DomElement.addCssClass(n,i):Sys.UI.DomElement.removeCssClass(n,i),r=this._flag.Column.Type,u=r=="Boolean"?t:r=="String"?t?"1":"":t?1:0,this.setItemValue(this._flag.Field,u,null,!0)},_isNavKey:function(n){return $func.keyCode(n)==13&&this._activeControl&&this._activeControl.type=="textarea"?!1:$func.isNavKey(n)||$func.keyCode(n)==13||$func.keyCode(n)==27},_getReadOnly:function(){return this._action=="View"?!0:this._activeControl&&this._activeControl._viewMode?!0:!1},_setReadOnly:function(n,t){if($func.isIF?n.readOnly=t:n._viewMode=t?!0:null,t&&(n.AddKeyHandler||(this._addKeyHandler(n),n.AddKeyHandler=!0)),n.img){$common.setVisible(n.img,!t);var i=n;n.p&&(i=n.p),t?i.style.width="100%":$df.resizeImage(n)}},_onSave:function(){if(this._action!="View"&&!this._searchMode){var n=this._findButton("Ok");n&&n.tabIndex!=-1&&$common.getVisible(n)&&!n.disabled&&(n.focus(),this.executeDialog(2))}},_isControlField:function(n){return n.ItemStyle=="Grid"?!0:!n.Hidden&&!n.ReadOnly&&!(n.Items&&n.Items.length>0)&&n.Type!="Boolean"?!0:!1},_invoke:function(n,t,i){var r=this,s,e,h;if(r._servicePath){var f=r._formMode?r.entity:r.grid,u=n,o=r._replication;u==0&&(s=String.format("Form_{0}_{1}_{2}",r._controller,r._language,r._searchMode?"1":"0"),!r.grid._denySessionStorage&&sessionStorage.getItem(s)?u=r._clone?8:9:r._clone&&(u=7),o&&(u+=10));e=null;f._hashValue&&(e=f._hashValue);h={type:u,parentType:r._parentType,firstView:r._firstView?!0:!1,searchMode:r._searchMode,viewPage:r._searchMode?f._searchInfor?!0:!1:r.grid._dirInfor?!0:!1,authorized:r.grid.get_dirAccess(),action:r._action,actionID:e,values:r._values,vars:r._vars,memvars:n==1?r._memvars:[],language:r._language,controller:r._controller,viewId:r._viewId,gridController:r.grid.get_dirController(),gridViewId:r.grid._viewId,cookie:r.get_cookie()};(n!=0||o)&&n!=2&&n!=-5?(n==0||n==-6||n==-2||n==-1||n>2)&&($func.showWait(r.get_id()),r._busy=!0,$func.enableButtons(!r._busy)):($func.showWait(r.grid.get_dirID()),r.grid._busy(!0));Sys.Net.WebServiceProxy.invoke(r.get_servicePath(),"GetDirViewPage",!1,h,t,i,n)}},_onMethodComplete:function(n,t){var i=this,s=i.get_id(),f=i.grid,r,h,o,c,e,u;if((t!=0||i._replication)&&t!=2&&t!=-5||(f._busy(!1),$func.hideWait(f.get_dirID())),(t==0||t==1||t==-6||t==-2||t==-1||t>2)&&(i._busy=!1,$func.hideWait(s),$func.enableButtons(!i._busy)),t==0){if(h=String.format("Form_{0}_{1}_{2}",i._controller,i._language,i._searchMode?"1":"0"),o=sessionStorage.getItem(h),!f._denySessionStorage&&o)r=Sys.Serialization.JavaScriptSerializer.deserialize(o),n.ViewPage=r.ViewPage,n.Scripts=r.Scripts,n.Css=r.Css;else{r={};r.ViewPage=n.ViewPage;r.Scripts=n.Scripts;r.Css=n.Css;o=Sys.Serialization.JavaScriptSerializer.serialize(r);try{sessionStorage.setItem(h,o)}catch(l){}}try{i._type=n.ViewPage.Type}catch(l){}n.ViewPage&&n.ViewPage.Initialize&&i.excuteScript(n.ViewPage.Initialize);i._type=="Report"&&(f._gridPageSize=f._resources.Pager.PageSizes[3]);n.Scripts&&i.addExternalScripts($func.resolveClientText(n.Scripts,i._baseUrl));n.Css&&i.addExternalCascadingStyleSheets($func.resolveClientText(n.Css,i._baseUrl));n.ViewPage&&(!i._fieldCookie&&n.ViewPage.Name&&n.ViewPage.Fields&&(c=n.ViewPage.Name,e=$func.findField(c,n.ViewPage.Fields),e.External&&e.Hidden&&e.ReadOnly&&e.AllowContain&&(i._fieldCookie={Index:e.Index,Name:c})),i._imitation=n.ViewPage.Replication,i._navigation=n.ViewPage.Navigation,n.ViewPage.Cache&&(i._cache=(n.ViewPage.Cache>>>0).toString(2)),i._certain=n.ViewPage.Check,n.ViewPage.Flag&&(i._flag=n.ViewPage.Flag,i._flag.Column=$func.findField(i._flag.Field,n.ViewPage.Fields)));f._openScript&&i.excuteScript(f._openScript);i._showForm(n,t)}else if(t==-1)i._showForm(n,t);else if(t==-2)n.Row.length>0?i.viewInfor(n.Row[0]):$message.show($df.getResources(i._language,"Message.RecordHasBeenChanged"));else if(t==-5||t==-15){if(n.Bugs){u=n.Bugs.Message;u=="$NotAuthorized"&&(u=$df.getResources(i._language,"Message.NotAccess"));$message.show(u,String.format(t==-5?"$find('{0}').gridFocus();":"$get('{0}_updateDlgClose').focus();",s));t==-15&&(i._replication=null);return}i._clone=!0;i._copying=n.ClientScript;i._action="New";i._firstView=!1;i.show()}else if(t==-6)i._showForm(n,t);else if(t==1)i.spreadMemvar(n,t);else if(t==2){if(n.Bugs){u=n.Bugs.Message;u=="$NotAuthorized"&&(u=$df.getResources(i._language,"Message.NotAccess"));$message.show(u,String.format("$find('{0}').gridFocus();",s));return}i._deleteRow(n,t)}else t>2&&n.ClientScript&&i.excuteScript(n.ClientScript)},_onMethodFailed:function(c,b){var a=this;if(b==0||b==2||b==-5){a.grid._busy(false);$func.hideWait(a.grid.get_dirID())}else{a._busy=false;$func.hideWait(a.get_id());$func.enableButtons(!a._busy)}if(a._replication)a._replication=null;$message.showError(c)},_showForm:function(n,t){var i=this,h=i.get_id(),c=i._language,r=i.grid,f=i._replication,u=t==0&&!f,p=String.format("$get('{0}_updateDlgClose').focus();",h),w=String.format("$find('{0}').gridFocus();",h),l=t==0?w:p,e,o,a,v,s,y;if(i._searchMode?i._formMode?i.entity._searchInfor=n.ViewPage:r.set_searchInfor(n.ViewPage):!r._dirInfor&&u&&(r.set_dirInfor(n.ViewPage),r.set_dirAccess(n.Authorized)),u&&(n.Initialize&&i.excuteScript(n.Initialize),i._initDir(),n.Checking&&(i._checking=n.Checking),n.Closing&&(i._closing=n.Closing)),n.Row&&n.Row.length>0)i._row=n.Row,i._blank=!1;else{if(i._row=[],i._action=="Edit"||t==-6){$message.show($df.getResources(c,"Message.RecordHasBeenChanged"),l);return}i._blank=!0}if(n.Bugs){e=n.Bugs.Message;e=="$NotAuthorized"&&(e=$df.getResources(c,"Message.NotAccess"));t==-1&&(i._action="View");$message.show(e,l);return}if(o=f?!1:t==0,a=t==-6,u&&(n.Created&&(i.onCreated=n.Created),n.Showing&&(i.onShowing=n.Showing)),i._showDialog(o,a),n.ClientScript&&(o&&(i._searchMode?i._formMode?i.entity._searchScript=n.ClientScript:r.set_searchScript(n.ClientScript):r.set_dirScript(n.ClientScript)),i.excuteScript(n.ClientScript)),t==-6){if(v=r._getItem(i._navigateRow,r._activeColumn),r._enter(v),i._controlFocus)try{i._controlFocus.focus();$func.setCurPos(i._controlFocus,0)}catch(b){}n.Navigating&&i.excuteScript(n.Navigating)}(t==0||t==-1||t==-6)&&(t==0&&(r._dirExternalRow=n.ExternalRow),s=t==-1||f,y=new FastBusiness.AjaxControlExtender.EventArgs(i,{Context:u?"Loading":s?"Scattering":"Navigating",Result:n.ExternalRow}),i.raiseResponseComplete(y),i.raiseFormEvent(u?"Load":s?"Scatter":"Navigator"));i._clone&&(i._copying&&i.excuteScript(i._copying),i._clone=null);f&&(i._replication=null)},_attachTabContainer:function(){var n=this,r,i,t,u;if(n._detachTabContainer(),r=0,n._categories&&n._categories.length>0){for(i=n.get_id(),n._tabContainer=$create(AjaxControlToolkit.TabContainer,{activeTabIndex:0},null,null,$get(String.format("{0}_Tabs",i))),n._tabContainer.parentForm=n,t=0;t<n._categories.length;t++)u=$get(String.format("{0}_Tabs_Panel{1}",i,t+1)),n._categories[t]._tabPanel=$create(AjaxControlToolkit.TabPanel,{headerTab:$get(String.format("__tab_{0}_Tabs_Panel{1}",i,t+1)),ownerID:String.format("{0}_Tabs",i)},null,null,u),r!=t&&(u.style.display="none");n._tabContainer.set_activeTabIndex(r),n._stretch&&n._stretch=="Auto"&&(n._activeTabChanged=Function.createDelegate(n,n._onTabChanged),n._tabContainer.add_activeTabChanged(n._activeTabChanged),n._tabContainer._loaded=!0)}},_detachTabContainer:function(){var n=this,t;if(n._categories&&n._categories.length>0){if(n._activeTabChanged){try{n._tabContainer.remove_activeTabChanged(n._activeTabChanged)}catch(i){}n._activeTabChanged=null}for(t=0;t<n._categories.length;t++)n._categories[t]._tabPanel&&(n._categories[t]._tabPanel.dispose(),n._categories[t]._tabPanel=null);n._tabContainer&&(n._tabContainer.dispose(),n._tabContainer=null)}},_onTabChanged:function(){this.focusWhenTabChanged(null)},_changeReadOnly:function(n){var f,e,o,i,u,r,t;if(n){for(this._readOnlyImageFields=[],this._readOnlyControls?Array.clear(this._readOnlyControls):this._readOnlyControls=[],r=0;r<this._fields.length;r++)if(i=this._fields[r],!i.ReadOnly||!i.External||i.AllowContain)if(i.ItemStyle=="RadioButtonList")for(f=0;f<i.Items.length;f++)t=this.getItem(i.Name,f),t&&(t.disabled||(this._changeObjectReadOnly(t,i,n,!1),Array.add(this._readOnlyControls,{Name:t.id,Type:2})));else t=this.getItem(i.Name),t&&(i.Type=="Boolean"||i.ItemStyle!="Grid"&&i.Items&&i.Items.length>0?t.disabled||(this._changeObjectReadOnly(t,i,n,!1),Array.add(this._readOnlyControls,{Name:i.Name,Type:0})):t.readOnly&&t._viewMode?t.img&&($common.setVisible(t.img,!n),u=t,t.p&&(u=t.p),u.style.width="100%",Array.add(this._readOnlyImageFields,{Name:i.Name,Type:1})):(this._changeObjectReadOnly(t,i,n,!0),Array.add(this._readOnlyControls,{Name:i.Name,Type:1})))}else{for(r=0;r<this._readOnlyControls.length;r++)e=this._readOnlyControls[r].Name,o=this._readOnlyControls[r].Type,o==2?(t=$get(e),t.disabled=n):(t=this.getItem(e),i=$func.findField(e,this._fields),i.Disabled||(i.ItemStyle=="Lookup"||t.viewOnly?($common.setVisible(t.img,!n),u=t,t.p&&(u=t.p),$df.resizeImage(t)):this._changeObjectReadOnly(t,i,n,o)));if(Array.clear(this._readOnlyControls),this._readOnlyImageFields){for(r=0;r<this._readOnlyImageFields.length;r++)t=this.getItem(this._readOnlyImageFields[r].Name),$common.setVisible(t.img,!0),$df.resizeImage(t);Array.clear(this._readOnlyImageFields)}}},_changeObjectReadOnly:function(n,t,i,r){if(r==1){if(t.ItemStyle!="Grid"){if(n.img){$common.setVisible(n.img,!i);var u=n;n.p&&(u=n.p),i?u.style.width="100%":$df.resizeImage(n)}$func.isIF?n.readOnly=i:i&&(n.AddKeyHandler||(this._addKeyHandler(n),n.AddKeyHandler=!0))}n._controlBehavior&&n._controlBehavior._changeReadOnly(i)}else n.disabled=i},_onResize:function(){this._resizeHorizon(this._resizableControlBehavior._deltaX),this._resizeVertical(this._resizableControlBehavior._deltaY),this._dlgModalPopupBehavior._fixupDropShadowBehavior()},_resizeWidth:function(n,t,i){n&&$func.setElementWidth(n,t+i)},_resizeHeight:function(n,t,i){n&&$func.setElementHeight(n,t+i)},_resizeColumn:function(n,t,i,r){if(n){var u=n.childNodes[0].childNodes[0].childNodes[i];$func.setElementWidth(u,r+t)}},_setHorizonObjects:function(n){var t,u;if($func.isOpr)for(t=0;t<this._resizeObjects.length;t++){var f=this._resizeObjects[t][0],r=this._resizeObjects[t][1],i=$get(f);this._resizeWidth(i,r,n),u=$func.getCurrentStyle(i,"paddingLeft")+$func.getCurrentStyle(i,"paddingRight"),this._resizeWidth(i.childNodes[0],r-u,n),this._resizeObjects[t][1]=r+n}},_resizeHorizon:function(n){var f,i,e,t;if(n!=0)for(this._setHorizonObjects(n),f=!1,i=0;i<this._resizeWidthControls.length;i++){var c=this._resizeWidthControls[i][0],o=this._resizeWidthControls[i][1],r=this._resizeWidthControls[i][2],s=this._resizeWidthControls[i][3],u=this._resizeWidthControls[i][4],h=$get(c);this._resizeColumn(h,n,r,s),$func.isOpr||this._resizeWidth(h,o,n),this._resizeWidthControls[i][1]=o+n,this._resizeWidthControls[i][3]=s+n,u>=0&&(t=this._categories[u].Columns.split(","),t[r]=String(parseInt(t[r])+n),this._categories[u].Columns=t.join(",")),u==-9?(t=this._ground.Columns.split(","),t[r]=String(parseInt(t[r])+n),this._ground.Columns=t.join(",")):f||u!=-1||(this._searchMode?(e=this._formMode?this.entity:this.grid,t=e._searchHeader.split(","),t[r]=String(parseInt(t[r])+n),e._searchHeader=t.join(",")):(t=this.grid._dirHeader.split(","),t[r]=String(parseInt(t[r])+n),this.grid._dirHeader=t.join(",")),f=!0)}},_resizeVertical:function(n){var f,t,i,r;if(n!=0){for(f=this._formMode?this.entity:this.grid,t=0;t<this._resizeHeightControls.length;t++){var e=this._resizeHeightControls[t][0],u=this._resizeHeightControls[t][1],o=this._resizeHeightControls[t][2],s=$get(e);this._resizeHeight(s,u,n),this._resizeHeightControls[t][1]=u+n,o==-1&&(this._searchMode?f._searchInfor.Height=u+n:this.grid._dirInfor.Height=u+n)}for(t=0;t<this._gridFields.length;t++)i=this._fields[this._gridFields[t]],i.ItemRowCount>0&&(r=this.getItem(i.Name)._controlBehavior,r._adjustResize(),i.Rows=i.Rows+n,r.set_fixedHeight(i.Rows),r._resizeVertical())}},_showTrayButton:function(n){var t=this;t._trayButton&&(t._switchTrayButton("Print",n),t._switchTrayButton("Notification",n),t._imitation&&t._switchTrayButton("Clone",n),t._navigation&&(t._switchTrayButton("Prev",n),t._switchTrayButton("Next",n)))},_switchTrayButton:function(n,t){var i=$get(this.get_id()+"_ToolbarButton_"+n);i&&($common.setVisible(i,t),i.style.display=t?"inline-block":"none")},_findTrayButton:function(n){for(var t,r,i,u=0;u<n._toolbar.length;u++)if(t=n._toolbar[u],t[0]=="Print"){for(r=[],i=0;i<t.length;i++)Array.add(r,t[i]);return r}return null},_showDialog:function(h,q){var a=this,i=a._replication,e=a.grid,l=null,j=null,t=$func.getUrlParameter("p");if(t){var I=sessionStorage.getItem(t);if(I){j=Sys.Serialization.JavaScriptSerializer.deserialize(I);if(j){a._session=j;a._session.Key=t;e._container.innerHTML=e._resources.WaitHtml;e._waiting=true;l=true}}}h&&a._initContainer();var n=a.get_id(),u=a._language,r,M=new Sys.StringBuilder,G=null,m=true;if(h){if(a._searchMode)r=a._title;else if(a._action=="New")r=String.format($df.getResources(u,"Message.NewComment"),a._title);else r=String.format($df.getResources(u,a._firstView?"Message.ViewComment":"Message.EditComment"),a._title);a._resizeObjects=[]}else{if((a._action!="New"||i)&&a._fieldCookie&&!q)if(a.getItemValue(a._fieldCookie.Name)==a._row[a._fieldCookie.Index])m=false;for(var d=0;d<a._gridFields.length;d++){var c=a.getItem(a._fields[a._gridFields[d]].Name);if(c)if(c._controlBehavior){var f=c._controlBehavior;if(m)f._rowCount=0;else if(f._activeCell){var v=f._activeCell,H="SelectCellContainer";$func.hideImageActiveCell(v);Sys.UI.DomElement.removeCssClass(v.parentNode,H);Sys.UI.DomElement.removeCssClass(v.parentNode.parentNode,H);f._clear(f._activeCell,true)}}}}var g=a._formMode?a.entity:e;if(a._searchMode){if(g._searchControls)a._tabControls=g._searchControls}else if(g._tabControls)a._tabControls=g._tabControls;if(!a._tabControls)G=a._tabControls=[];if(a._searchMode)a._trayButton=null;else if(e._type=="Voucher"){if(!a._trayButton)a._trayButton=a._findTrayButton(e)}else a._trayButton=null;var T=false,y=false,z=false;if(a._imitation){var S=a._imitation-1,A=("00"+(S>>>0).toString(2)).slice(-3);T=A.substring(0,1)=="1";y=A.substring(1,2)=="1";z=A.substring(2,3)=="1"}if(m||!a._certain||i&&y){var D=a._clone||q?"Edit":a._action;if(a._clone&&a._fieldCookie)a._row[a._fieldCookie.Index]="";$df.F11(M,G,a._imitation,a._navigation,a._trayButton,e._resources,a._searchMode,D,h,a._firstView,a.get_id(),"",r,u,a._fields,a._row,a._renderInfor,a._resizeObjects,a._header,a._width,a._columns,a._tabHeight,a._anchor,a._split,a._ground,a._categories,a._renderTop,a._renderBottom,a._break);for(var d=0;d<a._conceal.length;d++){var b=a._fields[a._conceal[d]],R=$df.F35(D,b,a._row,true);a.setItemValue(b.Name,R,null,true)}}if(a._searchMode){if(!g._searchControls)g._searchControls=a._tabControls}else if(!g._tabControls)g._tabControls=a._tabControls;var U=new FastBusiness.AjaxControlExtender.EventArgs(this,{Context:"Rendering",Result:[h,q,m]});a.raiseResponseComplete(U);if(h){a._container.innerHTML=M.toString();a._showTrayButton(false);if(a.onCreated)h&&a.excuteScript(a.onCreated);a._attachBehaviors();a._attachTabContainer();if(l&&a._tabContainer)a._tabContainer.get_element().style.display="none";var p=a._dlgModalPopupBehavior=$create(FastBusiness.AjaxControlExtender.FloatingModalPopupBehavior,{id:n+"_dlgModalPopupBehavior",titleId:String.format("{0}{1}_updateDlgTitle",n,a._form),PopupControlID:n+"_updateDlgPanel",DropShadow:true,BackgroundCssClass:"ModalBackground"},null,null,a._container.a);if(a.onShowing)h&&a.excuteScript(a.onShowing);if(l)p._popupElement.style.visibility="hidden";p.show();if(l)p._backgroundElement.style.display="none";else{var K=p._dropShadowBehavior;K.set_Width(3);K._shadowDiv.style.backgroundColor="#3171C6";if(a._resizable){var P=$get(n+"_updateDlgPanel"),s=$common.getBounds(P),x,w;if(a._searchMode){if(!g._searchMinimumWidth){g._searchMinimumWidth=s.width-2;g._searchMinimumHeight=s.height-2}x=g._searchMinimumWidth;w=g._searchMinimumHeight}else{if(!e._dirMinimumWidth){e._dirMinimumWidth=s.width-2;e._dirMinimumHeight=s.height-2}x=e._dirMinimumWidth;w=e._dirMinimumHeight}a._resizableControlBehavior=$create(FastBusiness.AjaxControlExtender.ResizableControlBehavior,{id:n+"_resizableControlBehavior",HandleCssClass:"Grip",MinimumHeight:w,MinimumWidth:x},null,null,P);a._resizeHandler=Function.createDelegate(a,a._onResize);a._resizableControlBehavior.add_resizing(a._resizeHandler)}a._setHorizonObjects(0)}if(a._firstView)a.switchViewMode(true);else a.addCssClass();for(var d=0;d<a._controlFields.length;d++){var b=a._fields[a._controlFields[d]];if(b.Disabled){var c=a.getItem(b.Name);c.disabled=true;if(c.img){$common.setVisible(c.img,false);var C=c;if(c.p)C=c.p;C.style.width="100%"}}if(a._searchMode){var o=b.AliasName;if(o!=""&&o!=b.Name&&o.length>0){var k=null,E=$func.getCookie(o);if(E)k=$func.stringToValue(E,b,true);if(!k)if(b.DefaultValue.length>0)try{k=eval(b.DefaultValue)}catch(W){}if(k)try{a.setItemValue(b.Name,k)}catch(W){}}}}a._searchMode&&a._cache&&a._cache.substring(1,2)=="1"&&a.restoreMemvar();a._setNextFocus();if(!a._denyFocus)try{a._controlFocus.focus();$func.setCurPos(a._controlFocus,0)}catch(W){}}else{for(var d=0;d<a._controlFields.length;d++){var b=a._fields[a._controlFields[d]];if(b.ItemStyle=="Grid"||b.ItemStyle=="AutoComplete"){var c=a.getItem(b.Name);if(c&&b.ItemStyle=="Grid")if(c._controlBehavior){var f=c._controlBehavior;if(e._hashValue)f._hashValue=e._hashValue;f._clone=i;if(i)f._replication=true;if(m||i&&z){for(var F=[],B=0;B<b.Items.length;B++){var L=b.Items[B];if(L[0]=="ForeignKey"){var N=L[1].split(":"),O=N[1].split(","),V=$func.trim(O[0]),C=$func.trim(O[1]),Q={Name:C,Opr:"=",Value:a.getItemValue(V),Type:$func.trim(N[0]),Ignore:false};Array.add(F,Q)}}f.set_externalKey(F);f._loadPage(-1);if(!T)z=false}else if(i){f.raiseGridEvent("Copying");f._clone=null;f._replication=null}}if(c&&b.ItemStyle=="AutoComplete")if(c._controlBehavior&&c._controlBehavior._label)c.title=c._controlBehavior._label.value}}!q&&a.switchViewMode(false)}if(l){if(j.Memvar)for(var d=0;d<j.Memvar.length;d++){var J=j.Memvar[d];a.setItemValue(J.Name,J.Value)}a._run(2)}},_run:function(n){var t=this;t._wait()?window.setTimeout(String.format("$find('{0}')._run({1});",t._id,n),100):(t._session.Script&&t.excuteScript(t._session.Script),sessionStorage.removeItem(t._session.Key),t._session=null,t.executeDialog(n))},_wait:function(){for(var n=this,t=0;t<n._gridFields.length;t++)if(n.getItem(n._fields[n._gridFields[t]].Name)._controlBehavior._isBusy)return!0;return!1},_select:function(n){n.live=!0,$func.isOpr&&(n.style.outline="none"),$func.isFF&&Sys.UI.DomElement.addCssClass(n,"ButtonSelected")},_leave:function(n){n.live=!1,$func.isOpr&&(n.style.outline=""),$func.isFF&&Sys.UI.DomElement.removeCssClass(n,"ButtonSelected")},_keydown:function(n,t){var i,r=t.keyCode;(r==37||r==39)&&($func.cancelEvent(t),i=this._findFirstVisibleButton(n,r==37?"Prev":"Next"),i&&this._focusButton(i))},_focusItem:function(n){window.setTimeout(String.format("try {0}var o=$get('{1}');o.focus();o.select();{2} catch (ex) {0}{2}","{",n.id,"}"),50)},_focusButton:function(n){var t=1;$func.isSr&&(t=50),window.setTimeout(String.format("try {0}$get('{1}').focus();{2} catch (ex) {0}{2}","{",n.id,"}"),t)},_processKeyEvents:function(n,t,i){var v=t.type,f=t.field,e,r,s,c,l,u,h,a,y,o;if(v!="textarea"&&(v!="checkbox"||!$func.isOpr)&&(e=f.ItemStyle,e!="Numeric"||!t._controlBehavior||!t._controlBehavior._isOpen)){if(!i&&e=="AutoComplete"&&this._action!="View"&&!(t.readOnly||t._viewMode||t._idle)&&t._controlBehavior&&(r=t._controlBehavior,!r._isOpen&&(!this._searchMode||!f.AllowNulls||f.OnDemand)))if($func.trim(t.value)==""){if(!f.AllowNulls){r._currentPrefix="",r._showEvent();return}}else if(s=f.ItemReference,c=!0,s&&s.length>0&&(l=$func.getItemInput(this.get_id(),this._form,s),l&&(l.checked||(c=!1))),t.value!=r._saveTextValue||!c){r._currentPrefix=r._padSize?$func.padLeft(t.value,r._padSize):t.value,r._checkEvent();return}if(u=this._getNextFocus(t),h=1,u){if(a=String.format("try {0}var o=$get('{1}');o.focus();o.select();{2} catch (ex) {0}{2}","{",u.id,"}"),($func.isOpr||u.type=="button")&&e!="Grid")try{$func.setCurPos(t,0)}catch(p){}if(u.type=="button")this._focusButton(u);else if(e=="Grid")$func.isSr&&(h=50),window.setTimeout(a,h);else if(y=u.field,y.ItemStyle=="Grid"){if(o=u._controlBehavior,o._rowCount>0)try{$func.gridFocus(o.get_id(),o._fields,1,o._firstColumnFocus())}catch(p){}}else window.setTimeout(a,h)}}},_getNextFocus:function(n){var t,i;return n?n._nextFocus?(t=n._nextFocus[n._nextFocus.length==1?0:this._tabContainer._activeTabIndex],!t)?this._getFirstVisibleButton():(i=t.field,i.ItemStyle=="Grid")?t._controlBehavior._rowCount?t:this._getNextFocus(t):i.Inactivate||i.Hidden?this._getNextFocus(t):t.disabled?this._getNextFocus(t):$common.getVisible(t)?t:this._getNextFocus(t):this._getFirstVisibleButton():this._getFirstVisibleButton()},_findFirstVisibleButton:function(n,t){for(var u=["New","Edit","Ok","Cancel","Close"],e=u.length,f,r,i=0;i<u.length;i++)if(r=this._findButton(u[i]),r.id==n.id){f=i;break}if(t=="Next"){for(i=f+1;i<e;i++)if(r=this._findButton(u[i]),$common.getVisible(r))return r}else for(i=f-1;i>=0;i--)if(r=this._findButton(u[i]),$common.getVisible(r))return r;return null},_getFirstVisibleButton:function(){for(var i=["New","Edit","Ok","Cancel","Close"],n,t=0;t<i.length;t++)if(n=this._findButton(i[t]),$common.getVisible(n))return n;return null},_findButton:function(n){return $get(String.format("{0}_updateDlg"+n,this.get_id()))},_setButtonText:function(n,t){var r=$func.isArray(t)?t[this._language=="v"?0:1]:t,i=this._findButton(n),u=r.split("</u>")[0].split("<u>");i.innerHTML=r,u.length>1?i.accessKey=u[1]:i.removeAttribute("accesskey")},_setNextFocus:function(){for(var i=this._tabControls,e=i.length,o,r,f,s,h,t,c,l,n,u=0;u<e;u++)if(r=i[u],f=r.length,f>0)if($func.isArray(r[0]))for(t=0;t<f;t++)for(c=r[t],l=c.length,n=0;n<l;n++)this.getItem(c[n])._nextFocus=n<l-1?[this.getItem(c[n+1])]:u==e-1?null:i[2].length>0?[this.getItem(i[2][0])]:null;else for(t=0;t<f;t++)if(o=this.getItem(r[t]),t<f-1)o._nextFocus=[this.getItem(r[t+1])];else if(u==e-1)o._nextFocus=null;else{for(s=i[u+1],h=[],n=0;n<s.length;n++)s[n].length>0?Array.add(h,this.getItem(s[n][0])):Array.add(h,e==2?null:i[2].length>0?this.getItem(i[2][0]):null);o._nextFocus=h}},_deleteRow:function(n){if(n.Bugs){$message.show(n.Bugs.Message,String.format("$find('{0}').gridFocus();",this.get_id()));return}this.grid._deleteRow()},_addKeyHandler:function(n){$addHandler(n,"keydown",this._keypressdown),$func.isOpr&&($addHandler(n,"keypress",this._keypressHandler),$addHandler(n,"keyup",this._keypressup))},_removeKeyHandler:function(n,t){t||(this._keypressup&&$removeHandler(n,"keyup",this._keypressup),this._keypressHandler&&$removeHandler(n,"keypress",this._keypressHandler),this._onKeyPressdown&&$removeHandler(n,"keydown",this._onKeyPressdown))},_removeKeyHandlers:function(){var n;if(!$func.isIF&&this._readOnlyControls){for(n=0;n<this._readOnlyControls.length;n++){var i=this._readOnlyControls[n].Name,r=this._readOnlyControls[n].Type,t=this.getItem(i);t&&r==1&&this._removeKeyHandler(t,!0)}Array.clear(this._readOnlyControls)}},addExternalScripts:function(n){var t,i,r;this._script||(t=this._script=document.createElement("script"),i=document.getElementsByTagName("head")[0],$func.isIE?t.text=n:(r=document.createTextNode(n),t.appendChild(r)),i.appendChild(t))},excuteScript:function(text){eval($func.resolveClientText(text,this._baseUrl))},addCssClass:function(){var t,n,i,r;this._style||(t=String.format(".{0}{{background-position:left top}}",$func.replace(this._id,".","_")),n=this._style=document.createElement("style"),n.type="text/css",n.rel="stylesheet",i=document.getElementsByTagName("head")[0],$func.isIE?n.styleSheet.cssText=t:(r=document.createTextNode(t),n.appendChild(r)),i.appendChild(n))},removeCssClass:function(){this._style&&(this._style.parentNode&&this._style.parentNode.removeChild(this._style),this._style=null)},addExternalCascadingStyleSheets:function(n){var t,i,r;this._css||(t=this._css=document.createElement("style"),t.type="text/css",t.rel="stylesheet",i=document.getElementsByTagName("head")[0],$func.isIE?t.styleSheet.cssText=n:(r=document.createTextNode(n),t.appendChild(r)),i.appendChild(t))},request:function(n,t,i,r){var u=this,v=u._formMode?u.entity:u.grid,a,c,o,f,s,l,e,h;if(u._servicePath){if(r)if(a=r.value,a.replace(/ +$/,'')!=r._lastValue.replace(/ +$/,''))r._lastValue=r.value;else return;if(t||f){for(c=[],o=0;o<i.length;o++)f=i[o],$func.isArray(f)?s={Name:f[0],Type:f[1],Value:f[1]=="Infinite"?$func.compress(f[2]):f[2]}:(l=u.getItem(f),e=$func.findField(f,u._fields),s={Name:f,Type:e?e.Type:"String",Value:l?$func.getItemValue(l,e):null},e.ItemStyle&&!e.ItemNormalCase&&(s.Ansi=!0)),Array.add(c,s);h={actionID:n,values:c,controller:u._controller,searchMode:u._searchMode,language:u._language,element:$func._grant(r,1)},$func.showWait(u.get_id()),u._busy=!0,$func.enableButtons(!u._busy),Sys.Net.WebServiceProxy.invoke(u.get_servicePath(),"GetDirResponse",!1,h,Function.createDelegate(u,u._onResponseComplete),Function.createDelegate(u,u._onResponseFailed),t)}else u.gatherMemvar(!0),h={type:1,parentType:u._parentType,firstView:u._firstView?!0:!1,searchMode:u._searchMode,viewPage:u._searchMode?v._searchInfor?!0:!1:u.grid._dirInfor?!0:!1,authorized:"1111",action:u._action,actionID:n,values:u._values,vars:u._vars,memvars:u._memvars,language:u._language,controller:u._controller,viewId:u._viewId,gridController:u.grid.get_dirController(),gridViewId:u.grid._viewId,cookie:u.get_cookie()},$func.showWait(u.get_id()),u._busy=!0,$func.enableButtons(!u._busy),Sys.Net.WebServiceProxy.invoke(u.get_servicePath(),"GetDirViewPage",!1,h,Function.createDelegate(u,u._onMethodComplete),Function.createDelegate(u,u._onMethodFailed),3)}},add_onResponseComplete:function(n){this.get_events().addHandler("onResponseComplete",n)},remove_onResponseComplete:function(n){this.get_events().removeHandler("onResponseComplete",n)},raiseResponseComplete:function(n){var t=this.get_events().getHandler("onResponseComplete");t&&t(this,n)},_onResponseComplete:function(n,t){var i,r,u;if(this._busy=!1,$func.hideWait(this.get_id()),$func.enableButtons(!this._busy),n){if(n.Bugs){i=n.Bugs.Message,i=="$NotAuthorized"&&(i=$df.getResources(this._language,"Message.NotAccess")),n.Bugs.FieldName?$message.show(i,String.format("$find('{0}').focus('{1}');",this.get_id(),n.Bugs.FieldName)):$message.show(i,String.format("$get('{0}_updateDlgCancel').focus();",this.get_id())),n.ClientScript&&this.excuteScript(n.ClientScript);return}n.ClientScript&&this.excuteScript(n.ClientScript),r=null,n.Row&&(r=n.Row),u=new FastBusiness.AjaxControlExtender.EventArgs(this,{Context:t,Result:r}),this.raiseResponseComplete(u)}},_onResponseFailed:function(n){this._busy=!1,$func.hideWait(this.get_id()),$func.enableButtons(!this._busy),$message.showError(n)},show:function(){var n,t,i,r;if(this._searchMode){n=this._formMode?this.entity:this.grid,n._searchInfor?(this._row=[],this._initDir(),this._showDialog(!0),n._searchScript&&this.excuteScript(n._searchScript)):this._invoke(0,Function.createDelegate(this,this._onMethodComplete),Function.createDelegate(this,this._onMethodFailed));return}if(this.grid._dirInfor&&this._values.length==0&&this._action=="New"){if(this._row=[],this._initDir(),t=!0,i=this.grid._dirAccess,($func.mid(i,1,1)=="0"||$func.mid(i,2,1)=="0")&&(t=!1),!t||this.grid._denyNew){this.showDenyMessage();return}this._showDialog(!0),this.grid._dirScript&&this.excuteScript(this.grid._dirScript),this._loaded=!0,r=new FastBusiness.AjaxControlExtender.EventArgs(this,{Context:"Loading",Result:this.grid._dirExternalRow}),this.raiseResponseComplete(r)}else this._loaded=!1,this._invoke(0,Function.createDelegate(this,this._onMethodComplete),Function.createDelegate(this,this._onMethodFailed))},getItem:function(n,t){return n=$func.dataFieldName(n,this._language),$func.getItemInput(this.get_id(),this._form,n,t)},getItemValue:function(n,t,i,r){n=$func.dataFieldName(n,this._language);var f=$func.findField(n,this._fields),u=null;return i||(u=this.getItem(n,t)),u?f.Type=="Boolean"?u.checked:$func.stringToValue(u.value,f,r):n in this._vacant?this._vacant[n]:null},setItemValue:function(n,t,i,r){var f=$func.findField(n,this._fields),u=null;r||(u=this.getItem(n,i)),u?f.Type=="Boolean"?u.checked=t:u.value=u._controlBehavior&&f.ItemStyle=="Numeric"?$func.valueToFormatString(t,u._controlBehavior._format,f,i):$func.valueToString(f.Type=="DateTime"&&t&&t.z?t.z:t,f,!0):this._vacant[n]=t},setItemValues:function(n,t){for(var r=n.split(","),u,i=0;i<r.length;i++)u=$func.dataFieldName($func.trim(r[i]),this._language),this.setItemValue(u,t[i])},setItemControlBehavior:function(n,t,i,r,u){var f,e;r&&$func.trim(t)==""||(i||(i=""),f=this.getItem(n),f&&(f.value=t,f._controlBehavior&&(f.title=i,f._controlBehavior._label&&(f._controlBehavior._label.value=i,e=!0,u!=null&&(e=u),f._controlBehavior._label.checked=e,f._controlBehavior._setLabelChecked(f,e)))))},setReferenceKeyFilter:function(n){var t=this.getItem(n);t._controlBehavior.set_completionKeyFilter($df.completionFilter(this._fields,t.field.ItemKeyFilter,this._id,this._form)),t._controlBehavior.set_completionCheckFilter($df.completionFilter(this._fields,t.field.ItemCheckFilter,this._id,this._form)),t._controlBehavior._setLabelText(!0)},focusWhenTabChanged:function(n){var t=this,f=null,e=t._tabContainer._activeTabIndex,o,s,h,r,c,i,l,u;if(t._stretch)if(o=t._tabControls[1],s=t._stretch,s=="Auto")f=o[e][0];else for(h=s.split(","),r=0;r<h.length;r++)c=parseInt(h[r]),Array.insert(n,c,o[c][0]);if((!n||!(e>=n.length))&&(i=f?f:n[e],i)){if($func.isArray(i)){l=t.getItem(i[0])._controlBehavior,l._rowCount>0||i.length==1?l._focusWhenTabChanged():t.focus(i[1]);return}u=t.getItem(i),u._controlBehavior&&u.field.ItemStyle=="Grid"?u._controlBehavior._focusWhenTabChanged():t.focus(i)}},focus:function(n){var t=this.getItem(n),i,r;if(t)if(this._tabContainer){if(i=$func.findField(n,this._fields),i)if(i.CategoryIndex>0){r=$func.findCategoryIndex(i.CategoryIndex,this._categories),this._tabContainer.set_activeTabIndex(r);try{t.focus()}catch(u){}}else try{t.focus()}catch(u){}}else try{t.focus()}catch(u){}},live:function(n,t){if(t){var i=$get(n);if(i&&i.live&&(i._lastValue=$df.getObjectValue(i),$func.setCurPos(i,0),!$func.isOpr))try{i.select()}catch(r){}}else window.setTimeout(String.format("$find('{0}').live('{1}', true);",this.get_id(),n.id),1)},resizeDialog:function(){var t=this,r,f;if(t._resizable&&!t._wait()){var u=t._resizableControlBehavior,e=t._dlgModalPopupBehavior,i=t.grid,n;i._resizeControls||(i._resizeControls=[]),r=$func.findMemvarIndex(t._controller,i._resizeControls),r==-1?(n={Name:t._controller,Size:u.get_Size(),Mode:!1},Array.add(i._resizeControls,n),r=i._resizeControls.length-1):(n=i._resizeControls[r],n.Mode||(n.Size=u.get_Size())),n.Mode?u.set_Size(n.Size):(f=$common.getClientBounds(),u.set_Size({width:f.width-22,height:f.height-22})),e._layout(),e._layout(),n.Mode=!n.Mode,i._resizeControls[r]=n}},executeDialog:function(n){if(n==0){if(this.grid._denyNew){this.showDenyMessage(!0);return}this.set_values(this.grid._getPrimaryKeyValues()),this._action="New",this._clone=null,this.scatterMemvar()}else if(n==1){if(this.grid._denyEdit){this.showDenyMessage(!0);return}this.set_values(this.grid._getPrimaryKeyValues()),this._action="Edit",this._clone=null,this.scatterMemvar()}else n==2&&this.executeCommand()},executeCommand:function(){this._busy||(this._busy=!0,this._preparing=!0,$func.showWait(this.get_id()),window.setTimeout(String.format("$find('{0}').save();",this.get_id()),500))},executePrint:function(n){$func.hidePopups();var t=this.grid;t.raiseGridEvent("Print",n.commandArgument)&&t.executePrint(n)},showInfor:function(){$func.hidePopups(),this.set_values(this.grid._getPrimaryKeyValues()),this._invoke(-2,Function.createDelegate(this,this._onMethodComplete),Function.createDelegate(this,this._onMethodFailed))},viewInfor:function(n){var t="dd/MM/yyyy HH:mm:ss",i=n[0]?n[0].localeFormat(t):"",r=n[0]?n[1].localeFormat(t):"",u=String.format($df.getResources(this._language,"Message.Logs"),'<table style="border-collapse:collapse;" cellpadding="0" cellspacing="0"><tbody><tr><td style="padding:0px;"><div>','</div></td><td style="padding:0px;"><div style="height:16px;width:20px;" class="Logs"><div></td></tr></tbody></table><div>','<span style="color:#4682B4;">',n[2]?n[2]:"","</span>",i,n[3]?n[3]:"",r,"</div>");$message.show(u)},navigation:function(n){var t=this,i;t._isBusy||(i=t.grid,i._activeRow)&&((t._navigateRow=i._activeRow+n,t._navigateRow<1||t._navigateRow>i._rowCount)||t._wait()||t.raiseFormEvent("Explore")&&(t.set_values(i._getPrimaryKeyValues(t._navigateRow)),t._invoke(-6,Function.createDelegate(t,t._onMethodComplete),Function.createDelegate(t,t._onMethodFailed))))},save:function(){var n=this,i=n.get_id(),e=null,o=n._language,s,u,t,r,f,h;if(n._preparing=e,n._streamMessage&&(eval(n._streamMessage),n._streamMessage=e),!n.raiseFormEvent("Save")){n._busy=!1;return}for(u=0;u<n._controlFields.length;u++)if(t=n._fields[n._controlFields[u]],n._isControlField(t)&&t.ItemStyle!="Grid"&&(r=n.getItem(t.Name),r&&(s=r.value,!$func.validateFormFieldValue(i,n._form,t,s,n._searchMode)))){n._busy=!1,$func.hideWait(i),$message.show(String.format($df.getResources(o,"Message.RequiredField"),t.Label),String.format("$find('{0}').focus('{1}');",i,t.Name));return}for(u=0;u<n._gridFields.length;u++)if(t=n._fields[n._gridFields[u]],!t.ReadOnly&&!t.Hidden){if(r=n.getItem(t.Name),!t.AllowNulls&&r._controlBehavior._rowCount<1){n._busy=!1,$func.hideWait(i),$message.show(String.format($df.getResources(o,"Message.RequiredTab"),t.Label),String.format("$find('{0}').focus('{1}');",i,t.Name));return}if(r._controlBehavior.validate(),r._controlBehavior._error){n._busy=!1,$func.hideWait(i),n.focus(t.Name),f=r._controlBehavior._errorMessage,f||(f=String.format($df.getResources(o,"Message.RequiredField"),r._controlBehavior._errorLabel)),r._controlBehavior._errorObject?$message.show(f,String.format("$find('{0}')._errorObject.focus();$find('{0}')._adjustPosition();",r._controlBehavior.get_id())):$message.show(f);return}}if(n._checking){if(n._checked=!0,n.excuteScript(n._checking),!n._checked){n._busy=!1,$func.hideWait(i);return}if(!n.raiseFormEvent("Check")){n._busy=!1,$func.hideWait(i);return}}if(!n.raiseFormEvent("Gather")){n._busy=!1,$func.hideWait(i);return}if(n.gatherMemvar(),!n._modified){n._busy=!1,$func.hideWait(i),n._viewMode?n.switchViewMode(!0):n.cancelDialog();return}if(n._checked=!0,h=new FastBusiness.AjaxControlExtender.EventArgs(n,{Context:"Checking",Result:n._memvars}),n.raiseResponseComplete(h),!n._checked){n._busy=!1,$func.hideWait(i);return}if(n._flowScript){n.excuteScript(n._flowScript),n._flowScript=e,n._busy=!1,$func.hideWait(i),n.completion(!0);return}if(n.grid._formScript){n._busy=!1,$func.hideWait(i),n.completion(),n.grid.excuteScript(n.grid._formScript),n.grid._formScript=e;return}n._busy=!0,$func.enableButtons(!n._busy),n._invoke(1,Function.createDelegate(n,n._onMethodComplete),Function.createDelegate(n,n._onMethodFailed))},validFields:function(n){for(var u,i=n.split(","),t=0;t<i.length;t++){var f=$func.trim(i[t]),r=$func.findField(f,this._fields),e=this.getItem(f);if(e&&(u=e.value,!$func.validateFormFieldValue(this.get_id(),this._form,r,u,this._searchMode)))return $message.show(String.format($df.getResources(this._language,"Message.RequiredField"),r.Label),String.format("$find('{0}').focus('{1}');",this.get_id(),r.Name)),!1}return!0},setReadOnlyFields:function(n){for(var i=n.split(","),t=0;t<i.length;t++){var u=$func.trim(i[t]),f=$func.findField(u,this._fields),r=this.getItem(u);r&&(r._viewMode=!0,this._changeObjectReadOnly(r,f,!0,f.Type!="Boolean"))}},switchButtonMode:function(n,t){var r="key",i=this._findButton(n);t?i.hasAttribute(r)&&(i.accessKey=i.getAttribute(r)):i.accessKey&&(i.hasAttribute(r)||i.setAttribute(r,i.accessKey),i.removeAttribute("accesskey")),$common.setVisible(i,t)},switchViewMode:function(n){n&&(this._action="View"),this._showTrayButton(n),$func.isFF?$get(String.format("{0}{1}_updateDlgTitleText",this.get_id(),this._form)).textContent=String.format($df.getResources(this._language,String.format("Message.{0}Comment",this._action)),this._title):$get(String.format("{0}{1}_updateDlgTitleText",this.get_id(),this._form)).innerText=String.format($df.getResources(this._language,String.format("Message.{0}Comment",this._action)),this._title),this.switchButtonMode("New",n),this.switchButtonMode("Edit",n),this.switchButtonMode("Ok",!n),this.switchButtonMode("Cancel",!n),this.switchButtonMode("Close",n),this._changeReadOnly(n),n?(this._firstView?this._firstView=!1:this._findButton("New").focus(),this.removeCssClass()):(this._controlFocus.focus(),$func.setCurPos(this._controlFocus,0),this.addCssClass()),this.raiseFormEvent("Shown")},completion:function(n){for(var i,t,u,r=0;r<this._controlFields.length;r++)if(i=this._fields[this._controlFields[r]],t=i.AliasName,t!=""&&t!=i.Name&&t.length>0){u=this.getItem(i.Name).value;try{$func.setCookie(t,u)}catch(f){}}this._detachTabContainer(),this.closeDialog(),n||(this.grid.set_memvars(this._memvars),this.grid.set_filterMemvars(this._memvars))},spreadMemvar:function(n){var i=this,r=i.grid,v=i.get_id(),a,y,h,c,e,o,u,s,l;if(n.Bugs){var w=!1,f=n.Bugs.Message,p="$Firm",b=p.length;if(f=="$NotAuthorized"&&(f=$df.getResources(i._language,"Message.NotAccess")),f&&$func.left(f,b)==p&&(w=!0,f=$func.right(f,f.length-b)),a=n.Bugs.FieldName?String.format("$find('{0}').focus('{1}');",v,n.Bugs.FieldName):String.format("$get('{0}_updateDlgCancel').focus();",v),n.ClientScript&&n.ClientScript.length>0){y=String.format("$find('{0}').excuteScript('{1}');",v,n.ClientScript),w?$message.show(f,0,y,a):$message.show(f,y);return}$message.show(f,a);return}if(i._searchMode){if(i.completion(),n.ClientScript&&i.excuteScript(n.ClientScript),r._processMode){r._container.innerHTML=i._alterTitle?i._alterTitle:String.format('<div class="ProcessCompleted"><span class="Information">&nbsp;</span>{0}</div>',$df.getResources(i._language,"Message.ProcessCompleted"));return}r._allFields.length==0?(r._container.innerHTML=r._resources.WaitHtml,r._loadPage(0)):r._formScript?(r.excuteScript(r._formScript),r._formScript=null):(r.set_gridPageIndex(-2),r._loadPage(1));return}if(h=r._activeRow,i._action=="New"&&(r._appendRow(),h=r._rowCount),n.InternalValues&&n.InternalValues.length>0)for(e=0;e<n.InternalValues.length;e++)u=n.InternalValues[e],i.setItemValue(u.Name,u.NewValue),c=$func.findMemvarIndex(u.Name,i._memvars),c>=0&&(i._memvars[c].NewValue=u.NewValue);for(e=0;e<r._fields.length;e++)o=r._fields[e],u=$func.findMemvar(o.Name,i._memvars),!u&&i._extensions&&i._extensions.length>0&&(u=$func.findMemvar(o.Name,i._extensions)),!u&&n.FieldValues&&n.FieldValues.length>0&&(u=$func.findMemvar(o.Name,n.FieldValues)),u?$func.compareFieldValue(o,u.OldValue,u.NewValue)||(s=u.NewValue,o.Type=="DateTime"&&s&&i._statics&&(l=$func.findMemvar(o.Name,i._statics),l&&(s=l.Value)),r._setItemValue(h,e+1,s,!0)):o.Name in i._vacant&&r._setItemValue(h,e+1,i._vacant[o.Name],!0);r.scatterMemvar(),i._viewMode?i.switchViewMode(!0):(i._detachTabContainer(),i.closeDialog()),i._action=="Edit"&&i.gridFocus(),n.ClientScript&&i.excuteScript(n.ClientScript)},scatterMemvar:function(){this._values.length==0&&this._action=="New"?(this._row=[],this._showDialog(!1)):this._invoke(-1,Function.createDelegate(this,this._onMethodComplete),Function.createDelegate(this,this._onMethodFailed))},gatherMemvar:function(n){var i=this,s=null,c,l,p,o,u,t,w,f,a,k,r;for(i._modified=i._action=="New"?!0:!1,i._memvars=[],i._statics=[],i._extensions=[],u=0;u<i._fields.length;u++){var t=i._fields[u],e=t.Name,h=i.getItem(e);if(t.Items.length>0&&t.ItemStyle=="RadioButtonList")for(c=0;c<t.Items.length;c++)if(l=i.getItem(e,c),l&&l.checked){h=l;break}(h||t.IsPrimaryKey||!t.ReadOnly)&&t.ItemStyle!="Grid"&&(p=t.External&&t.ReadOnly&&!t.AllowContain,o=i._action=="New"?s:i._row[t.Index],t.Type=="DateTime"&&(o=$func.offsetDate(o?new Date(o.setHours(0,0,0,0)):o),h&&Array.add(i._statics,{Name:e,Value:i.getItemValue(e,s,s,!0)})),r={Name:e,OldValue:o,NewValue:h?$func.getItemValue(h,t):i.getItemValue(e,s,!0)},p?Array.add(i._extensions,r):(i._action!="Edit"||i._modified||t.FilterSource=="Ignore"||(i._modified=!$func.compareFieldValue(t,r.OldValue,r.NewValue)),(t.FilterSource=="Infinite"||t.External&&t.AllowContain&&t.FilterSource=="Encoding")&&(r.OldValue=s,r.NewValue=$func.compress(r.NewValue),r.Compressed=!0),Array.add(i._memvars,r)))}if(!n)for(u=0;u<i._gridFields.length;u++)if(t=i._fields[i._gridFields[u]],!t.ReadOnly&&!t.Hidden){w=i.getItem(t.Name);f=w._controlBehavior;f.gatherMemvar();a=0;(f._modified||t.AllowContain)&&(a=1,i._modified=!0);var v=Sys.Serialization.JavaScriptSerializer.serialize(t.FilterSource=="Tidy"&&!f._modified?[]:f._sift()),y=f._autoExpansion,b=y&&y>1&&f._rowCount>y?9:0;b||(v=$func.compress(v));k=[{Value:[v],Status:b}];r={Name:t.Name,OldValue:0,NewValue:a,Modified:!0,Items:k};Array.add(i._memvars,r)}},restoreMemvar:function(){var t=this,f,e,s,u;if(t._memvars)for(f=t._memvars,e=0;e<f.length;e++){var i=f[e],o=i.Name,r=i.NewValue,n=$func.findField(o,t._fields),h=!1;!n||n.FilterSource!="Cache"&&(n.ItemStyle=="Grid"||n.Hidden||n.ReadOnly||n.Disabled||n.FilterSource=="Stable"||!r&&n.Type!="Boolean")||$func.compareFieldValue(n,r,t.getItemValue(o))||(h=!0,t._flag&&t._flag.Field==o?t._onFlag(null,r):(n.Type=="DateTime"&&r&&t._statics&&(s=$func.findMemvar(n.Name,t._statics),s&&(r=s.Value)),t.setItemValue(o,r))),h&&n.ItemStyle=="AutoComplete"&&(u=n.ItemReference,u&&(i=$func.findMemvar(u,t._extensions),i||(i=$func.findMemvar(u,f)),i&&i.NewValue&&t.setItemValue(u,i.NewValue)))}},cloneRow:function(n){var t=this,r=-5,i;if(n){if(i=t.grid,i._denyNew){t.showDenyMessage(n);return}if(!t.raiseFormEvent("Copy"))return;t.set_values(i._getPrimaryKeyValues());r=-15}t._replication=n;t._invoke(r,Function.createDelegate(t,t._onMethodComplete),Function.createDelegate(t,t._onMethodFailed))},removeRow:function(){this._invoke(2,Function.createDelegate(this,this._onMethodComplete),Function.createDelegate(this,this._onMethodFailed))},gridFocus:function(){var n=this.grid;n._parentGrid&&(n=n._parentGrid),n._activeCell&&n._activeCell.focus()},cancelDialog:function(n,t){var i=this,r;if(t&&i.grid&&i.grid._confirmEscape&&i.grid._type=="Voucher"&&i._action!="View"&&!i._searchMode){r=i._id;$message.show($df.getResources(i._language,"Message.ConfirmEscape"),0,String.format("$find('{0}').cancelDialog(0);",r),String.format("$get('{0}_updateDlgOk').focus();",r));return}i.raiseFormEvent("Close")&&(i._busy||(i._removeKeyHandlers(),i._detachTabContainer(),i.closeDialog(),i.gridFocus()))},closeDialog:function(){this._closing&&this.excuteScript(this._closing),this._detachBehaviors(),this._resizableControlBehavior&&(this._resizeHandler&&(this._resizableControlBehavior.remove_resizing(this._resizeHandler),this._resizeHandler=null),this._resizableControlBehavior.dispose(),this._resizableControlBehavior=null),this._dlgModalPopupBehavior&&(this._container.innerHTML="",this._dlgModalPopupBehavior.hide(),this._dlgModalPopupBehavior.dispose(),this._dlgModalPopupBehavior=null),this._container&&(this._container.a&&(this._container.a.parentNode.removeChild(this._container.a),this._container.a=null),this._container.parentNode.removeChild(this._container),this._container=null)},executeExpression:function(n){for(var t=0;t<n.length;t++)this.assignExpression(n[t])},assignExpression:function(n){var t=n.split(":="),r=$func.trim(t[0]).replace("[","").replace("]",""),i=this.calcExpression($func.trim(t[1]));i!=null&&this.setItemValue(r,i)},calcExpression:function(n){var e=this,u=null,o={Expression:n,Variables:u},i,f,t,r;for($func.initExpression(o),i=n,f=0;f<o.Variables.length;f++){var h=o.Variables[f],s=h.Name,c=e.getItem(s);if(c||s in e._vacant)t=e.getItemValue(s),String.isInstanceOfType(t)?t="'"+t.toString().replace("'","\\'")+"'":(t==u||Date.isInstanceOfType(t))&&(t=t?"(new Date("+Date.parse(t)+"))":"null"),i=i.replace(h.Expression,t);else{i=u;break}}if(i)try{return r=eval(i),$func.isNumber(r)&&(r=parseFloat(r.toFixed(7))),r}catch(l){}return u},add_commandEvent:function(n){this.get_events().addHandler("commandEvent",n)},remove_commandEvent:function(n){this.get_events().removeHandler("commandEvent",n)},raisecommandEvent:function(n){var t=this.get_events().getHandler("commandEvent");t&&t(this,n)},raiseFormEvent:function(n){var t=new FastBusiness.AjaxControlExtender.EventArgs(this,{cancelEvent:!1,Action:n});return this.raisecommandEvent(t),!t.type.cancelEvent},showDenyMessage:function(n){var t=this.grid._denyMessage?this.grid._denyMessage:$df.getResources(this._language,"Message.NotAccess");n?$message.show(t,String.format("$get('{0}_updateDlgClose').focus();",this.get_id())):$message.show(t,String.format("$find('{0}').gridFocus();",this.get_id()))},executeAction:function(n){this._action=n;switch(n){case"New":if(this.grid._denyNew){this.showDenyMessage();break}this._clone=null,this._firstView=!1,this.show();break;case"Edit":if(this.grid._denyEdit){this.showDenyMessage();break}this._firstView=!1,this.show();break;case"Delete":if(this.grid._denyDelete){this.showDenyMessage();break}this.removeRow();break;case"Clone":if(this.grid._denyNew){this.showDenyMessage();break}this.cloneRow();break;case"Search":this._action="New",this._firstView=!1,this.show();break;case"View":this._firstView=!0,this._action="Edit",this.show()}}},FastBusiness.AjaxControlExtender.DirExtender.registerClass("FastBusiness.AjaxControlExtender.DirExtender",Sys.UI.Behavior),FastBusiness.AjaxControlExtender.DirFunction.Resources={Message:{NewComment:{v:"Thêm {0}",e:"Add {0}"},EditComment:{v:"Sửa {0}",e:"Edit {0}"},ViewComment:{v:"Xem {0}",e:"View {0}"},ConfirmDelete:{v:'Hệ thống sẽ <span class="TaskDialogContentHighlight">xóa bản ghi đang được chọn</span>, bạn có chắc chắn xóa không?',e:'Are you sure you want to <span class="TaskDialogContentHighlight">delete this record?</span>'},ConfirmEscape:{v:'Hệ thống sẽ <span class="TaskDialogContentHighlight">không lưu dữ liệu</span>, bạn có chắc chắn thoát không?',e:'Are you sure you want to <span class="TaskDialogContentHighlight">close this window?</span>'},New:{v:"<u>M</u>ới",e:"<u>N</u>ew"},Edit:{v:"<u>S</u>ửa",e:"<u>E</u>dit"},Save:{v:"<u>L</u>ưu",e:"<u>S</u>ave"},Ok:{v:"<u>N</u>hận",e:"<u>O</u>k"},Cancel:{v:"<u>H</u>ủy",e:"<u>C</u>ancel"},Close:{v:"Đón<u>g</u>",e:"C<u>l</u>ose"},Copy:{v:"Chép dữ liệu",e:"Copy"},Prev:{v:"Trước",e:"Previous"},Next:{v:"Tiếp",e:"Next"},Notification:{v:"Thông tin người cập nhật",e:"Information"},Logs:{v:"{0}Thông tin người cập nhật{1}Được tạo bởi {2}{3}{4} vào thời gian: {2}{5}{4}. Cập nhật lần cuối bởi {6} vào thời gian: {7}.{8}",e:"{0}Information{1}Owned by {2}{3}{4} on {2}{5}{4}. Last modified by {6} on {7}.{8}"},RecordHasBeenChanged:{v:"Bản ghi đã được sửa hoặc xóa bởi người sử dụng khác.",e:"The record has been changed or deleted by another user."},NotAuthorized:{v:'<div class="NotAuthorized">Chưa có <span class="Highlight">quyền truy cập</span> hoặc <span class="Highlight">truy cập bị từ chối</span>. Liên hệ với người quản trị hệ thống nếu bạn có thể được truy cập vào trang này.</div>',e:'<div class="NotAuthorized">You are <span class="Highlight">not authorized</span> or you <span class="Highlight">do not have permission</span> to execute this action. Contact the System administrator if you believe you should be able to view this page.</div>'},NotAccess:{v:'Chưa có <span class="Highlight">quyền thực hiện chức năng này</span> hoặc <span class="Highlight">truy cập bị từ chối</span>. Liên hệ với người quản trị hệ thống nếu bạn có thể được truy cập vào chức năng này.',e:'You are <span class="Highlight">not authorized</span> or you <span class="Highlight">do not have permission</span> to execute this action. Contact the System administrator if you believe you should be able to execute this action.'},RequiredField:{v:'Trường <span class="Highlight">{0}</span> chưa nhập hoặc giá trị nhập không hợp lệ.',e:'Field <span class="Highlight">{0}</span> must not be blank or has invalid value.'},RequiredTab:{v:'Thông tin <span class="Highlight">{0}</span> chưa nhập hoặc có giá trị không hợp lệ.',e:'Tab <span class="Highlight">{0}</span> must not be blank or has invalid value.'},ProcessCompleted:{v:"Chương trình đã thực hiện xong.",e:"The process completed successfully."}}},typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.Currency=function(n){FastBusiness.AjaxControlExtender.Currency.initializeBase(this,[n]),this._currency=n,this._currencyDate=null,this._referenceDate=null,this._exchangeRate=null,this._form=null,this._baseCurrency=null,this._currencyFields=null,this._referenceFields=null,this._executeExpression=null,this._foreignFields=[],this._baseFields=[],this._flush=null,this._gridFields=[],this._totalFields=[]},FastBusiness.AjaxControlExtender.Currency.prototype={initialize:function(){FastBusiness.AjaxControlExtender.Currency.callBaseMethod(this,"initialize"),this._exchangeRate._saveTabIndex=this._exchangeRate.tabIndex,this._renderHandle=Function.createDelegate(this,this.onGridRender),this._changeCurrencyHandle=Function.createDelegate(this,this.onChangeCurrency),this._changeExchangeRateHandle=Function.createDelegate(this,this.onChangeExchangeRate),this._changeDateHandle=Function.createDelegate(this,this.onChangeDate),this._closeHandle=Function.createDelegate(this,this.onClose),this._currency._controlBehavior.add_close(this._closeHandle),$addHandler(this._currency,"change",this._changeCurrencyHandle),$addHandler(this._exchangeRate,"change",this._changeExchangeRateHandle),$addHandler(this._currencyDate,"change",this._changeDateHandle)},dispose:function(){if(this._foreignFields=null,this._baseFields=null,this._renderHandle){for(var n=0;n<this._gridFields.length;n++)this._gridFields[n][0].remove_onRender(this._renderHandle);this._renderHandle=null}this._gridFields=null,this._totalFields=null,this._changeDateHandle&&($removeHandler(this._currencyDate,"change",this._changeDateHandle),this._changeDateHandle=null),this._changeExchangeRateHandle&&($removeHandler(this._exchangeRate,"change",this._changeExchangeRateHandle),this._changeExchangeRateHandle=null),this._changeCurrencyHandle&&($removeHandler(this._currency,"change",this._changeCurrencyHandle),this._changeCurrencyHandle=null),this._closeHandle&&(this._currency._controlBehavior.remove_close(this._closeHandle),this._closeHandle=null),FastBusiness.AjaxControlExtender.Currency.callBaseMethod(this,"dispose")},onChangeCurrency:function(){var n=this._currency.value,t;this._lastCurrency!=n&&(this.setFormLayout(2),this.setGridLayout(),t=new FastBusiness.AjaxControlExtender.EventArgs(this,n),this.raiseCurrencyChange(t),this._currencyChanged=!0)},onClose:function(){if(this._currencyChanged){this._currencyChanged=!1;return}var i=this._currency.value,r=new FastBusiness.AjaxControlExtender.EventArgs(this,i);this.raiseOnVoid(r)},onChangeExchangeRate:function(){this.onExchangeRateChanged()},onExchangeRateResponse:function(n,t){this._exchangeRate._controlBehavior._get_number()!=t&&(this._exchangeRate._controlBehavior._set_number(t),this._exchangeRate._lastValue=t,this.onExchangeRateChanged()),(n==0||this._exchangeRate.live)&&$func.setCurPos(this._exchangeRate,0)},onExchangeRateChanged:function(){this.setGridExchangeRateWhenChanged(),this.calcTotalFields(),this.calcReferenceFields(),this._executeExpression&&this._form.executeExpression(this._executeExpression)},setGridExchangeRateWhenChanged:function(){for(var n=0;n<this._gridFields.length;n++)this.onGridChangeExchangeRate(this._gridFields[n][0])},onGridChangeExchangeRate:function(n){var t,i,r;if(n._rowCount!=0){var h=n._fields,u=this._gridFields[n.currencyIndex][1],e=this._exchangeRate._controlBehavior._get_number();for(t=0;t<u.length;t++){var o=n._getColumnOrder(u[t][0]),f=n._getColumnOrder(u[t][1]),s=$func.scaleLength(n._getColumnFormat(f));for(i=0;i<n._rowCount;i++)r=n._getItemValue(i+1,o)*e,r&&(r=parseFloat(r.toFixed(7))),n._setItemValue(i+1,f,$func.round(r,s))}}},onChangeDate:function(){var n=this._form.getItemValue(this._currencyDate.field.Name,null,null,!0),t=new FastBusiness.AjaxControlExtender.EventArgs(this,n);this.raiseDateChange(t),n&&this._referenceDate&&this._referenceDate._controlBehavior.set_selectedDate(n)},calcTotalFields:function(){for(var r=this._form,o,u,t,e,n=0;n<this._totalFields.length;n++)for(o=this._totalFields[n][0],u=this._totalFields[n][1],t=0;t<u.length;t++){var i=u[t],f=i[0],h=i[1],s=null;i.length==3&&(s=i[2]),e=o.sum(h,s),f in r._vacant?r._vacant[f]=e:r.getItem(f)._controlBehavior._set_number(e)}},calcReferenceFields:function(){var n=this._form,i,h;if(this._referenceFields){var c=this._exchangeRate._controlBehavior._get_number(),o=this._referenceFields.split(":"),s=o[0].split(","),l=o[1].split(",");for(i=0;i<s.length;i++){var r=$func.trim(s[i]),u=$func.trim(l[i]),t=r in n._vacant?n._vacant[r]:n.getItem(r)._controlBehavior._get_number()*c,f,e="";r in n._vacant?e=$func.findField(r,n._fields).DataFormatString:(f=n.getItem(u)._controlBehavior,e=f._format),h=$func.scaleLength(e),t&&(t=parseFloat(t.toFixed(7))),t=$func.round(t,h),u in n._vacant?n._vacant[u]=t:f._set_number(t)}}},get_currencyDate:function(){return this._currencyDate},set_currencyDate:function(n){this._currencyDate=n},get_referenceDate:function(){return this._referenceDate},set_referenceDate:function(n){this._referenceDate=n},get_exchangeRate:function(){return this._exchangeRate},set_exchangeRate:function(n){this._exchangeRate=n},get_form:function(){return this._form},set_form:function(n){this._form=n},get_baseCurrency:function(){return this._baseCurrency},set_baseCurrency:function(n){this._baseCurrency=n},get_currencyFields:function(){return this._currencyFields},set_currencyFields:function(n){this._currencyFields=n},get_referenceFields:function(){return this._referenceFields},set_referenceFields:function(n){this._referenceFields=n},get_executeExpression:function(){return this._executeExpression},set_executeExpression:function(n){this._executeExpression=n},get_flush:function(){return this._flush},set_flush:function(n){this._flush=n},add_onCurrencyChange:function(n){this.get_events().addHandler("onCurrencyChange",n)},remove_onCurrencyChange:function(n){this.get_events().removeHandler("onCurrencyChange",n)},raiseCurrencyChange:function(n){var t=this.get_events().getHandler("onCurrencyChange");t&&t(this,n)},add_onVoid:function(n){this.get_events().addHandler("onVoid",n)},remove_onVoid:function(n){this.get_events().removeHandler("onVoid",n)},raiseOnVoid:function(n){var t=this.get_events().getHandler("onVoid");t&&t(this,n)},add_onDateChange:function(n){this.get_events().addHandler("onDateChange",n)},remove_onDateChange:function(n){this.get_events().removeHandler("onDateChange",n)},raiseDateChange:function(n){var t=this.get_events().getHandler("onDateChange");t&&t(this,n)},addCurrencyHandler:function(n,t,i){this.add_onCurrencyChange(n),this.add_onDateChange(t),this.add_onVoid(i)},removeCurrencyHandler:function(n,t,i){try{this.remove_onVoid(i),this.remove_onDateChange(t),this.remove_onCurrencyChange(n)}catch(r){}},addGridFields:function(n,t){for(var r=t.split(":"),u=r[0].split(","),s=r[1].split(","),f=[],e,o,i=0;i<u.length;i++)e=$func.trim(u[i]),o=$func.trim(s[i]),Array.add(f,[e,o]);n.add_onRender(this._renderHandle),Array.add(this._gridFields,[n,f]),n.currencyIndex=this._gridFields.length-1},addTotalFields:function(n,t){Array.add(this._totalFields,[n,t])},init:function(){var n=this,t=n._form,i;if(n._currency.readOnly=n._currency.viewOnly=!0,Sys.UI.DomElement.removeCssClass(n._currency.parentNode.parentNode,"Required"),n._currency._controlBehavior.set_elementFocus(n._exchangeRate),n._currencyFields){var f=n._currencyFields.split(":"),e=f[0].split(","),l=f[1].split(",");for(i=0;i<e.length;i++){var r=$func.trim(e[i]),u=$func.trim(l[i]),o=r in t._vacant,s=u in t._vacant,h=o?r:t.getItem(r),c=s?u:t.getItem(u);i!=0||n._foreignCurrencyFormatString||(n._foreignCurrencyFormatString=o?$func.findField(r,t._fields).DataFormatString:h._controlBehavior._format,n._baseCurrencyFormatString=s?$func.findField(u,t._fields).DataFormatString:c._controlBehavior._format),Array.add(n._foreignFields,h),Array.add(n._baseFields,c)}}},setCurrentDate:function(n){var i,t;n&&(i=this._form.getItemValue(n.field.Name),i||(t=n._controlBehavior,t.set_selectedDate(t.get_todaysDate())))},setFormLayout:function(n){var t=this,f=t._currency,r=t._exchangeRate,i,s,h,e,u,c,o;if((n==0||n==1)&&($func.trim(f.value)==""&&(t._form.grid._dvCurrency?(f.value=t._form.grid._dvCurrency,r._controlBehavior._set_number(t._form.grid._dvExchangeRate)):(f.value=t._baseCurrency,r._controlBehavior._set_number(1))),t.setCurrentDate(t._currencyDate),t.setCurrentDate(t._referenceDate)),i=f.value==t._baseCurrency,n!=0||i){if(s=i?t._baseCurrencyFormatString:t._foreignCurrencyFormatString,h=$func.scaleLength(s),t._foreignFields)for(e=0;e<t._foreignFields.length;e++)u=t._foreignFields[e],c=t._baseFields[e],$func.isString(u)?t._form._vacant[u]=$func.round(t._form._vacant[u],h):(o=u._controlBehavior,o.set_format(s),o._set_number($func.round(o._get_number(),h))),$func.isString(c)||u.field.FilterSource=="Invariability"||$common.setVisible(c.parentNode,!i);r.tabIndex=i?-1:r._saveTabIndex,r.TabStop=!i,r.disabled=i,t._lastCurrency=f.value}},onRender:function(){var f=this._currency.value,e,t,n,u;if(this._lastCurrency!=f)for(e=f==this._baseCurrency,t=0;t<this._gridFields.length;t++){var i=this._gridFields[t][0],o=i._fields,r=this._gridFields[i.currencyIndex][1];for(n=0;n<r.length;n++)u=o[i._getColumnOrder(r[n][0])-1],u.DataFormatString=e?o[i._getColumnOrder(r[n][1])-1].DataFormatString:u._saveDataFormatString}},setGridLayout:function(){for(var t,n=0;n<this._gridFields.length;n++)t=this._gridFields[n][0],this._flush&&t._suspendLayout(),this.loadGridLayout(t);if(this._flush)for(n=0;n<this._gridFields.length;n++)this._gridFields[n][0]._resumeLayout()},onGridRender:function(n,t){this.loadGridLayout(t.grid)},loadGridLayout:function(n){for(var f=n._fields,e=this._currency.value==this._baseCurrency,o=this._gridFields[n.currencyIndex][1],u,r,t,s,h,i=0;i<o.length;i++)u=n._getColumnOrder(o[i][0]),r=n._getColumnOrder(o[i][1]),n._fields[r-1].FilterSource!="Invariability"&&n._setColumnVisible(r,!e),t=f[u-1],t._saveDataFormatString||(t._saveDataFormatString=t.DataFormatString,t._saveHeaderText=t.HeaderText),s=e?f[r-1].DataFormatString:t._saveDataFormatString,h=e?f[r-1].HeaderText:t._saveHeaderText,n._setColumnFormat(u,s),n._setHeaderItemText(u,h)}},FastBusiness.AjaxControlExtender.Currency.registerClass("FastBusiness.AjaxControlExtender.Currency",Sys.UI.Behavior),typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();
Type.registerNamespace("FastBusiness.AjaxControlExtender"),FastBusiness.AjaxControlExtender.VoucherNumber=function(n){var t=this;FastBusiness.AjaxControlExtender.VoucherNumber.initializeBase(t,[n]),t._voucherNumber=n,t._book=null,t._form=null},FastBusiness.AjaxControlExtender.VoucherNumber.prototype={initialize:function(){var n=this;FastBusiness.AjaxControlExtender.VoucherNumber.callBaseMethod(n,"initialize"),n._changeVoucherNumberHandle=Function.createDelegate(n,n.onChangeVoucherNumber),$addHandler(n._book,"change",n._changeVoucherNumberHandle)},dispose:function(){var n=this;n._changeVoucherNumberHandle&&($removeHandler(n._book,"change",n._changeVoucherNumberHandle),n._changeVoucherNumberHandle=null),FastBusiness.AjaxControlExtender.VoucherNumber.callBaseMethod(n,"dispose")},onChangeVoucherNumber:function(){var t=this._book.value,n=new FastBusiness.AjaxControlExtender.EventArgs(this,t);this.raiseVoucherNumberChange(n)},add_onVoucherNumberChange:function(n){this.get_events().addHandler("onVoucherNumberChange",n)},remove_onVoucherNumberChange:function(n){this.get_events().removeHandler("onVoucherNumberChange",n)},raiseVoucherNumberChange:function(n){var t=this.get_events().getHandler("onVoucherNumberChange");t&&t(this,n)},get_book:function(){return this._book},set_book:function(n){this._book=n},get_form:function(){return this._form},set_form:function(n){this._form=n},hideBook:function(){var n=this;$common.setVisible(n._book.img,!1),n._voucherNumber.style.width="100%",n._book.Img=n._book.img,n._book.img=null},init:function(){},setVoucherNumber:function(n,t,i,r,u){(this._form._action=="New"||n==2)&&(this._voucherNumber.value=i&&i.length>0?$func.increaseNumber(i,r,u):$func.increaseNumber(t))},setFormLayout:function(){var n=this,t=$func.trim(n._voucherNumber.value);n._voucherNumber.value=t,n._form._row.length>0&&(n._form._row[n._voucherNumber.field.Index]=t)}},FastBusiness.AjaxControlExtender.VoucherNumber.registerClass("FastBusiness.AjaxControlExtender.VoucherNumber",Sys.UI.Behavior),typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();